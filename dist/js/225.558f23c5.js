"use strict";(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[225],{19852:function(t,s,a){a.d(s,{Z:function(){return c}});var i=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"app-loading"},[a("div",{staticClass:"box"},[a("hash-loader",{staticClass:"custom-class",attrs:{color:"#eb1851",loading:!0,size:40,sizeUnit:"px"}}),a("h5",{staticClass:"app-name"},[t._v(t._s(t.text))])],1)])},e=[],o={name:"app-user-logging-in",props:{text:String}},n=o,r=a(1001),l=(0,r.Z)(n,i,e,!1,null,"73613f3f",null),c=l.exports},99986:function(t,s,a){a.d(s,{Z:function(){return c}});var i=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[t._t("default")],2)},e=[],o={name:"LayoutMain",components:{}},n=o,r=a(1001),l=(0,r.Z)(n,i,e,!1,null,null,null),c=l.exports},34225:function(t,s,a){a.r(s),a.d(s,{default:function(){return w}});var i=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"page-body",attrs:{id:"page-account"}},[a("appNavi",{attrs:{isBack:!1,pageName:"My Account"}}),a("div",{staticClass:"page-container page-display"},[a("div",{staticClass:"form"},[a("div",{staticClass:"page-section-button"},[a("h2",{staticClass:"page-section-label"},[t._v("Profile Photo")]),0==t.isEdit.photo?a("v-ons-toolbar-button",{staticClass:"popover-button",on:{click:function(s){return t.BTN_EDIT("photo")}}},[a("i",{staticClass:"las la-edit"}),a("span",[t._v("Edit")])]):t._e()],1),a("div",{staticClass:"form-item-container profile-box"},[a("div",{staticClass:"profile-photo"},[1==t.isEdit.photo?a("div",{staticClass:"btn-pic-change"},[t._m(0)]):t._e(),a("input",{ref:"file",staticStyle:{display:"none"},attrs:{type:"file",id:"pic-upload-btn"},on:{change:function(s){return t.UPLOAD_PIC()}}}),t.user.profile_picture?a("img",{attrs:{src:t.user.profile_picture}}):t._e(),t.user.profile_picture?t._e():a("img",{attrs:{src:"/img/default_profile_picture.png"}})])]),1==t.isEdit.photo?a("div",{staticClass:"form-button-container"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"grey",on:{click:function(s){return t.BTN_CANCEL()}}},[a("label",[t._v("Cancel")])])])]):t._e()]),"ceo"!=this.user.role?a("div",{staticClass:"form",staticStyle:{"grid-row":"span 2"}},[a("div",{staticClass:"page-section-button"},[a("h2",{staticClass:"page-section-label"},[t._v("Personal Informations")]),0==t.isEdit.info?a("v-ons-toolbar-button",{staticClass:"popover-button",on:{click:function(s){return t.BTN_EDIT("info")}}},[a("i",{staticClass:"las la-edit"}),a("span",[t._v("Edit")])]):t._e()],1),a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Name:")]),0==t.isEdit.info?a("p",{staticClass:"info"},[t._v(" "+t._s(t.user.firstname)+" "+t._s(t.user.lastname)+" ")]):t._e(),1==t.isEdit.info?a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.firstname,expression:"formData.firstname"}],staticStyle:{"border-radius":"6px 0 0 6px","grid-column":"span 1"},attrs:{placeholder:"Firstname"},domProps:{value:t.formData.firstname},on:{input:function(s){s.target.composing||t.$set(t.formData,"firstname",s.target.value)}}}):t._e(),1==t.isEdit.info?a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.lastname,expression:"formData.lastname"}],staticStyle:{"border-radius":"0 6px 6px 0","border-width":"1px 1px 1px 0","grid-column":"span 1"},attrs:{placeholder:"Lastname"},domProps:{value:t.formData.lastname},on:{input:function(s){s.target.composing||t.$set(t.formData,"lastname",s.target.value)}}}):t._e()]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Position:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.user.position)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Department:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.user.department)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Employee No:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.user.employee_no)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Email:")]),0==t.isEdit.info?a("p",{staticClass:"info"},[t._v(" "+t._s(t.user.email)+" ")]):t._e(),1==t.isEdit.info?a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.email,expression:"formData.email"}],attrs:{placeholder:"Email"},domProps:{value:t.formData.email},on:{input:function(s){s.target.composing||t.$set(t.formData,"email",s.target.value)}}}):t._e()]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Phone No:")]),0==t.isEdit.info?a("p",{staticClass:"info"},[t._v(" "+t._s(t.user.phone_no)+" ")]):t._e(),1==t.isEdit.info?a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.phone_no,expression:"formData.phone_no"}],attrs:{placeholder:"Phone No"},domProps:{value:t.formData.phone_no},on:{input:function(s){s.target.composing||t.$set(t.formData,"phone_no",s.target.value)}}}):t._e()])]),1==t.isEdit.info?a("div",{staticClass:"form-button-container"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(s){return t.SAVE_EDIT_INFO()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(s){return t.BTN_CANCEL()}}},[a("label",[t._v("Cancel")])])])]):t._e()]):t._e(),a("div",{staticClass:"form"},[a("div",{staticClass:"page-section-button"},[a("h2",{staticClass:"page-section-label"},[t._v("Account Setting")]),0==t.isEdit.account?a("v-ons-toolbar-button",{staticClass:"popover-button",on:{click:function(s){return t.BTN_EDIT("account")}}},[a("i",{staticClass:"las la-edit"}),a("span",[t._v("Edit")])]):t._e()],1),a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Username:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.user.username)+" ")])]),1==t.isEdit.account?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Old Password:")]),1==t.isEdit.account?a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.oldPassword,expression:"formData.oldPassword"}],attrs:{placeholder:"Old Password",type:"password"},domProps:{value:t.formData.oldPassword},on:{input:function(s){s.target.composing||t.$set(t.formData,"oldPassword",s.target.value)}}}):t._e()]):t._e(),0==t.isEdit.account?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Password:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.invisiblePassword)+" ")])]):t._e(),1==t.isEdit.account?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("New Password:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.newPassword,expression:"formData.newPassword"}],attrs:{placeholder:"New Password",type:"password"},domProps:{value:t.formData.newPassword},on:{input:function(s){s.target.composing||t.$set(t.formData,"newPassword",s.target.value)}}})]):t._e(),t.formData.newPassword&&1==this.isEdit.account?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Confirm Password:")]),1==t.isEdit.account?a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.confirmPassword,expression:"formData.confirmPassword"}],attrs:{placeholder:"Confirm Password",type:"password"},domProps:{value:t.formData.confirmPassword},on:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.SAVE_EDIT_ACCOUNT()},input:function(s){s.target.composing||t.$set(t.formData,"confirmPassword",s.target.value)}}}):t._e()]):t._e()]),1==t.isEdit.account?a("div",{staticClass:"form-button-container"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(s){return t.SAVE_EDIT_ACCOUNT()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(s){return t.BTN_CANCEL()}}},[a("label",[t._v("Cancel")])])])]):t._e()])]),1==t.isLoading?a("PageLoading",{attrs:{text:"Loading"}}):t._e()],1)},e=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("label",{attrs:{for:"pic-upload-btn"}},[a("i",{staticClass:"las la-edit"})])}],o=a(89584),n=a(45549),r=a(17133),l=a.n(r),c=a(39477),u=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"page-container"},[a("div",{attrs:{id:"navigation-panel"}},[a("div",{staticClass:"left-col"},[1==t.isBack?a("v-ons-toolbar-button",{staticClass:"btn",on:{click:function(s){return t.goTo("/")}}},[a("i",{staticClass:"las la-angle-left"}),a("span",[t._v("Back")])]):t._e(),a("h1",{staticClass:"page-name-label"},[t._v(t._s(t.pageName))])],1),a("div",{staticClass:"right-col"})])])},d=[],p={name:"navigation-bar",props:{backUrl:String,pageName:String,isBack:Boolean},methods:{goTo(t){this.$ons.notification.confirm("You are exiting '"+this.$store.state.currentInApp.name+"'.").then((s=>{if(1==s){this.$store.commit("CLEAR_CURRENT_INAPP");var a=this.$route.path;a!=t&&this.$router.push({path:t,replace:!0})}}))}}},f=p,m=a(1001),h=(0,m.Z)(f,u,d,!1,null,"58506c69",null),v=h.exports,_=a(99986),g=a(19852),C={name:"AccountView",components:{appNavi:v,PageLoading:g.Z},data(){return{user:"",formData:"",invisiblePassword:"********",isEdit:{info:!1,account:!1,photo:!1},jobPositionList:["Data Engineer","Programmer","General Engineer","Manager","Staff"],picUpload:"",isLoading:!1}},created(){this.$emit("update:layout",_.Z),this.$store.commit("UPDATE_CURRENT_INAPP",{name:"My Account",icon:""}),1==this.$store.state.status.server&&this.FETCH_USER_INFO()},mounted(){},methods:{FETCH_USER_INFO(){this.isLoading=!0,setTimeout((()=>{var t=JSON.parse(localStorage.getItem("user")).id_user;(0,c.Z)({method:"post",url:"/user/get-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_user:t}}).then((t=>{if(200==t.status){var s=t.data.user;this.user=s,null==s.profile_picture?this.user.profile_picture=null:this.user.profile_picture=this.baseURL+this.user.profile_picture,console.log("==> Fetch User Info : Account View <==")}})).catch((t=>{console.log(t)})).finally((()=>{this.isLoading=!1}))}),500)},UPLOAD_PIC(){if(console.log("  ==> UPLOAD PIC"),this.picUpload=this.$refs.file.files[0],this.picUpload&&"image/jpeg"==this.picUpload.type||"image/png"==this.picUpload.type)if(this.picUpload.size<2e7)(0,c.Z)({method:"post",url:"/user/upload-pic",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_user:this.user.id_user,file:this.picUpload}}).then((t=>{console.log("  ==> UPLOAD DONE"),200==t.status&&(this.isEdit.photo=!1,this.$router.go())})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{}));else{this.$ons.notification.alert("File size too large. (20 MB max)");const t=document.getElementById("pic-upload-btn");t.val=""}else{this.$ons.notification.alert("Incorrect filetype. <br/> Only JPEG/PNG file can be uploaded.");const t=document.getElementById("pic-upload-btn");t.val=""}},BTN_EDIT(t){1==this.isEdit.info||1==this.isEdit.account||1==this.isEdit.photo?this.$ons.notification.confirm("Unsaved changes will be lost.").then((s=>{1==s&&(this.isEdit.info=!1,this.isEdit.account=!1,this.formData=(0,o.Z)(this.user),"info"==t?this.isEdit.info=!0:"account"==t&&(this.isEdit.account=!0))})):(this.formData=(0,o.Z)(this.user),"info"==t?this.isEdit.info=!0:"account"==t?this.isEdit.account=!0:"photo"==t&&(this.isEdit.photo=!0))},BTN_CANCEL(){this.$ons.notification.confirm("Unsaved changes will be lost.").then((t=>{1==t&&(this.formData={},this.isEdit.info=!1,this.isEdit.account=!1,this.isEdit.photo=!1)}))},SAVE_EDIT_INFO(){this.$ons.notification.confirm("Confirm Save").then((t=>{if(1==t){const t=this.formData;(0,c.Z)({method:"put",url:"/user/update-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&t.data&&this.$ons.notification.alert("Update user information successful").then((t=>{0==t&&(this.isEdit.user=!1,this.isEdit.info=!1,this.FETCH_USER_INFO())}))})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{}))}}))},SAVE_EDIT_ACCOUNT(){this.formData.oldPassword?this.formData.newPassword?this.formData.confirmPassword?this.formData.newPassword==this.formData.confirmPassword?(0,n.sha256)(this.formData.oldPassword)==this.user.password?this.$ons.notification.confirm("Confirm Save").then((t=>{if(1==t){const t={id_user:this.formData.id_user,password:(0,n.sha256)(this.formData.confirmPassword)};(0,c.Z)({method:"put",url:"/user/change-password",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&t.data&&this.$ons.notification.alert("Account password changed").then((t=>{0==t&&(this.isEdit.account=!1,this.FETCH_USER_INFO())}))})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{}))}})):this.$ons.notification.alert("Old password is incorrect."):this.$ons.notification.alert("Confirm password mismatch."):this.$ons.notification.alert('"Confirm Password" field cannot be empty.'):this.$ons.notification.alert('"Password" field cannot be empty.'):this.$ons.notification.alert('"Old Password" field cannot be empty.')}},computed:{userBirthday(){var t=this.user.birthday;return l()(t).format("LL")},baseURL(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}}},E=C,b=(0,m.Z)(E,i,e,!1,null,"9743ed00",null),w=b.exports},89584:function(t,s,a){a.d(s,{Z:function(){return i}});var i=e;function e(t){let s=t;var a={}.toString.call(t).slice(8,-1);if("Set"==a)return new Set([...t].map((t=>e(t))));if("Map"==a)return new Map([...t].map((t=>[e(t[0]),e(t[1])])));if("Date"==a)return new Date(t.getTime());if("RegExp"==a)return RegExp(t.source,o(t));if("Array"==a||"Object"==a)for(var i in s=Array.isArray(t)?[]:{},t)s[i]=e(t[i]);return s}function o(t){if("string"==typeof t.source.flags)return t.source.flags;var s=[];return t.global&&s.push("g"),t.ignoreCase&&s.push("i"),t.multiline&&s.push("m"),t.sticky&&s.push("y"),t.unicode&&s.push("u"),s.join("")}}}]);
//# sourceMappingURL=225.558f23c5.js.map