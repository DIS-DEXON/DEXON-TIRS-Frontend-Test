"use strict";(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[876],{96125:function(t,e,s){s.d(e,{Z:function(){return c}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"approval-box"},[s("div",{staticClass:"message-box"},[1==this.status?s("p",{staticClass:"message-title blue"},[t._v("UNAPPROVED")]):t._e(),2==this.status?s("p",{staticClass:"message-title orange"},[t._v("PENDING")]):t._e(),3==this.status?s("p",{staticClass:"message-title green"},[t._v("APPROVED")]):t._e(),4==this.status?s("p",{staticClass:"message-title red"},[t._v("REJECTED")]):t._e(),5==this.status?s("p",{staticClass:"message-title red"},[t._v("REQUEST EDIT")]):t._e(),s("p",{staticClass:"message-text"},[t._v(t._s(t.statusText))])]),1==t.status&&"staff"==this.$store.state.user.role?s("div",{staticClass:"button-set"},[s("v-ons-toolbar-button",{staticClass:"blue",on:{click:function(e){return t.$emit("btnRequestApprove")}}},[s("i",{staticClass:"las la-reply"}),s("span",[t._v("Send Approve Request")])])],1):t._e(),2==t.status&&"manager"==this.$store.state.user.role?s("div",{staticClass:"button-set"},[s("div",{staticClass:"double-button-set"},[s("v-ons-toolbar-button",{staticClass:"green",on:{click:function(e){return t.$emit("btnApprove")}}},[s("i",{staticClass:"las la-check"}),s("span",[t._v("Approve")])]),s("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.$emit("btnReject")}}},[s("i",{staticClass:"las la-times"}),s("span",[t._v("Reject")])])],1),s("v-ons-toolbar-button",{staticClass:"blue",on:{click:function(e){return t.$emit("btnRequestEdit")}}},[s("i",{staticClass:"las la-reply-all"}),s("span",[t._v("Request Edit")])])],1):t._e(),5==t.status&&"staff"==this.$store.state.user.role?s("div",{staticClass:"button-set"},[5==t.status?s("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.$emit("btnResendApprove")}}},[s("i",{staticClass:"las la-reply-all"}),s("span",[t._v(" Resend Approve Request")])]):t._e()],1):t._e()])},i=[],o={name:"app-approval-status",props:{status:Number},created(){},computed:{statusText(){var t=this.$store.state.user.role;return"staff"==t?1==this.status?"This record has not been sent to a section manager for an approval.":2==this.status?"This record has been sent to a section manager for an approval.":3==this.status?"This record is approved by a section manager. It cannot be edited or deleted.":4==this.status?"This record is rejected by a section manager.":5==this.status?"This record is requested review and edit by a section manager.":"N/A":"manager"==t?1==this.status?"This record has not been sent to a section manager for a review.":2==this.status?"This record is waiting for an approval feedback from a section manager.":3==this.status?"This record is approved.":4==this.status?"This record is rejected.":5==this.status?"This record has been request for editing. It is waiting for a new approval request.":"N/A":"N/A"}}},n=o,r=s(1001),l=(0,r.Z)(n,a,i,!1,null,"99393d82",null),c=l.exports},42876:function(t,e,s){s.r(e),s.d(e,{default:function(){return S}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pm-page"},[s("div",{staticClass:"pm-toolbar"},[s("toolbar",{attrs:{pageSubName:"Record No. "+t.info.record_no,isBack:!0,isEdit:t.sign_status,isDelete:!0,isPrint:!1,isDownload:!0},on:{isDeleteBtn:function(e){return t.DELETE_PROJECT()},isEditBtn:function(e){return t.TOGGLE_POPUP()},isDownloadBtn:function(e){return t.DOWNLOAD_PDF()},refreshInfo:function(e){return t.FETCH_INFO()}}})],1),s("div",{staticClass:"pm-page-container"},[s("div",{staticClass:"page-content"},[this.info.created_by==this.$store.state.user.id_user||"manager"==this.$store.state.user.role?s("approvalBox",{staticClass:"approval-box-fullpage",attrs:{status:this.info.approve_status},on:{btnRequestApprove:function(e){return t.APPROVE_BTN("req_approve")},btnApprove:function(e){return t.APPROVE_BTN("approve")},btnReject:function(e){return t.APPROVE_BTN("reject")},btnRequestEdit:function(e){return t.APPROVE_BTN("req_edit")},btnResendApprove:function(e){return t.APPROVE_BTN("req_approve")}}}):t._e(),s("div",{staticClass:"page-info form"},[s("p",{staticClass:"page-section-label"},[t._v("Record Detail")]),s("div",{staticClass:"form-item-container"},[s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Record No:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.info.record_no)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Travel Date:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.travel_date)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Created By:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.info.created_by_name)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Total Mile:")]),t.total_mile>0?s("p",{staticClass:"info"},[t._v(t._s(t.total_mile)+" Km")]):t._e(),!t.total_mile||t.total_mile<=0?s("p",{staticClass:"info"},[t._v("-")]):t._e()]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Created Date:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.created_date)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Approval Status:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.info.status_desc)+" ")])]),s("div",{staticClass:"input-set",staticStyle:{"grid-column":"span 3"}},[s("p",{staticClass:"label"},[t._v("Note:")]),s("p",{staticClass:"info",staticStyle:{height:"60px","text-align":"left"}},[t._v(" "+t._s(t.info.note)+" ")])])]),s("div",{},[s("DxDataGrid",{attrs:{id:"contact-client-list","data-source":t.TravelDetailList,selection:{mode:"single"},"hover-state-enabled":!0,"allow-column-reordering":!1,"show-borders":!0,"show-row-lines":!1,"row-alternation-enabled":!0},scopedSlots:t._u([{key:"option-btn-set",fn:function(e){var a=e.data;return[s("div",{staticClass:"table-btn-group"},[s("div",{staticClass:"table-btn",on:{click:function(e){return t.TOGGLE_POPUP("edit",a)}}},[s("i",{staticClass:"las la-pen green"})]),s("div",{staticClass:"table-btn",on:{click:function(e){return t.DELETE_ITEM(a)}}},[s("i",{staticClass:"las la-trash red"})])])]}},{key:"tableName",fn:function(){return[s("p",{staticClass:"page-intable-section-label"},[t._v("Visiting Record")])]},proxy:!0},{key:"addVisitRecord",fn:function(){return[s("v-ons-toolbar-button",{on:{click:function(e){return t.TOGGLE_POPUP()}}},[s("i",{staticClass:"las la-plus"}),s("span",[t._v("Add")])])]},proxy:!0}])},[s("DxColumn",{attrs:{"data-field":"visit_record_no",caption:"Visit Record No.","sort-order":"asc"}}),s("DxColumn",{attrs:{"data-field":"client_name",caption:"Client Name"}}),s("DxColumn",{attrs:{"data-field":"travel_from",caption:"From"}}),s("DxColumn",{attrs:{"data-field":"travel_to",caption:"To"}}),s("DxColumn",{attrs:{"data-field":"distance",caption:"Distance",alignment:"left"}}),s("DxColumn",{attrs:{width:80,caption:"","cell-template":"option-btn-set"}}),s("DxToolbar",[s("DxItem",{attrs:{location:"before",template:"tableName"}}),s("DxItem",{attrs:{location:"after",template:"addVisitRecord"}})],1),s("DxScrolling",{attrs:{mode:"standard"}}),s("DxSearchPanel",{attrs:{visible:!0}}),s("DxPaging",{attrs:{"page-size":10,"page-index":0}}),s("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}})],1)],1)])],1)]),s("popupAdd",{attrs:{travelDate:this.info.date}}),1==t.isEdit?s("popupEdit",{attrs:{editInfo:t.info},on:{closePopup:function(e){return t.TOGGLE_POPUP()},FETCH_INFO:function(e){return t.FETCH_INFO()}}}):t._e(),1==t.isSign?s("popupSign",{attrs:{title:t.popupTitle,signer:t.currentSigner,info:this.info},on:{closePopup:function(e){return t.TOGGLE_POPUP_SIGN()},FETCH_INFO:function(e){return t.FETCH_INFO()}}}):t._e(),1==t.isLoading?s("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fbcb04"}}):t._e()],1)},i=[],o=s(48626),n=s(85981),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"popup-wrapper"},[s("div",{staticClass:"popup-card"},[s("div",{staticClass:"popup-header"},[s("label",[t._v("Select Visit Record")]),s("span",{staticStyle:{"font-size":"14px","padding-right":"20px"}},[t._v(t._s(t.formData.record_no)+" ")])]),s("div",{staticClass:"popup-content form"},[s("div",{staticClass:"form-item-container"},[s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Travel Date:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.travel_date)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Visit Record:")]),s("DxSelectBox",{staticStyle:{border:"0","font-size":"14px"},attrs:{items:t.formSelect.jobType,placeholder:"Select Visit Record"},model:{value:t.formData.job_type,callback:function(e){t.$set(t.formData,"job_type",e)},expression:"formData.job_type"}})],1)])]),s("div",{staticClass:"popup-footer"},[s("div",{staticClass:"button-set"},[s("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[s("label",[t._v("Save")])]),s("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[s("label",[t._v("Cancel")])])])])])])},l=[],c=s(39477),d=s(56935),u=s.n(d),p=s(17133),_=s.n(p),f={name:"popup-add-travel-detail",components:{DxSelectBox:u()},props:{travelDate:String},data(){return{formData:{id_user:"",record_no:"",bill_date:"",price:"",doc_seq:"",file:""},formSelect:{visit_record_list:[{id_visit:0,visit_record_no:"AI-CVR-22-09-01",client_name:"PTTEP LNG",distance:24}]}}},created(){let t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user},computed:{travel_date(){return this.travelDate?_()(this.travelDate).format("LL"):null}},methods:{SAVE(){this.formData.bill_date?this.formData.price?this.$ons.notification.confirm("Confirm save?").then((t=>{if(1==t){const t=this.formData;(0,c.Z)({method:"post",url:"/fuel-bill/fuel-bill-add",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&(this.$ons.notification.alert("Bill Record Add successful"),this.$emit("btn-cancel-add"),this.$emit("refreshList"))})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{}))}})):this.$ons.notification.alert('"Price" field cannot be empty'):this.$ons.notification.alert('"Bill Date" field cannot be empty')},CANCEL(){let t=this.formData;this.formData!=t?this.$ons.notification.confirm("Your unsaved changes will be lost").then((t=>{1==t&&this.$emit("btn-cancel-add")})):this.$emit("btn-cancel-add")}}},v=f,h=s(1001),m=(0,h.Z)(v,r,l,!1,null,"1ccbbc50",null),b=m.exports,C=s(98942),g=s(49075),T=s(96125),D={name:"ViewTravelInfo",components:{DxDataGrid:o.DxDataGrid,DxSearchPanel:o.DxSearchPanel,DxPaging:o.DxPaging,DxPager:o.DxPager,DxScrolling:o.DxScrolling,DxColumn:o.DxColumn,DxToolbar:o.DxToolbar,DxItem:o.DxItem,toolbar:n.Z,popupAdd:b,popupEdit:C.Z,contentLoading:g.Z,approvalBox:T.Z},created(){1==this.$store.state.status.server&&this.FETCH_INFO()},data(){return{isLoading:!1,isAdd:!1,isEdit:!1,isSign:!1,sign_status:!0,info:"",popupTitle:"",TravelDetailList:[{id_travel_detail:0,id_travel:2,id_visit:1,visit_record_no:"AI-CVR-09-22-01",travel_from:"DEXON Main Office",travel_to:"PTTLNG",distance:24,client_name:"PTTLNG",treval_note:"nothing to note krub"},{id_travel_detail:1,id_travel:2,id_visit:2,visit_record_no:"AI-CVR-09-22-02",travel_from:"PTTLNG",travel_to:"PTTEP S1",distance:76,client_name:"PTTEP S1",treval_note:""},{id_travel_detail:2,id_travel:2,id_visit:3,visit_record_no:"AI-CVR-09-22-03",travel_from:"PTTEP S1",travel_to:"DEXON Main Office",distance:96,client_name:"-",treval_note:""}]}},methods:{TOGGLE_POPUP_SIGN(t){1==this.isSign&&(this.isSign=!1),"dexon"==t?(this.popupTitle="Dexon Signature",this.currentSigner="dexon",this.isSign=!0):"client"==t&&(this.popupTitle="Client Signature",this.currentSigner="client",this.isSign=!0)},FETCH_INFO(){this.isLoading=!0,setTimeout((()=>{const t=this.$route.params;t&&(0,c.Z)({method:"post",url:"/travel-record/travel-record-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{console.log(t),200==t.status&&t.data[0]?this.info=t.data[0]:this.$ons.notification.alert("No record found!")})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{this.isLoading=!1}))}),500)},FETCH_INFO_LIST(){this.isLoading=!0,setTimeout((()=>{const t=this.$route.params;t&&(0,c.Z)({method:"post",url:"/travel-record/travel-record-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{console.log(t),200==t.status&&t.data[0]?this.info=t.data[0]:this.$ons.notification.alert("No record found!")})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{this.isLoading=!1}))}),500)},DELETE_PROJECT(){const t=this.$route.params;this.$ons.notification.confirm("Confirm delete?").then((e=>{1==e&&(0,c.Z)({method:"put",url:"/visit-record/visit-record-delete",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&(this.$ons.notification.alert("Visit Record delete successful"),this.$router.go(-1))})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{}))}))},TOGGLE_POPUP(t){"add"==t?this.isAdd=!this.isAdd:"edit"==t&&(this.isEdit=!this.isEdit)},APPROVE_BTN(t){var e=JSON.parse(localStorage.getItem("user")),s="N/A",a={id_fuel_bill:this.currentViewRow.id_fuel_bill,approve_status:0,id_user:e.id_user};"req_approve"==t?(a.approve_status=2,s="Confirm Send Approve Request?"):"approve"==t?(a.approve_status=3,s="Confirm Send Approve Feedback?"):"reject"==t?(a.approve_status=4,s="Confirm Send Reject Feedback?"):"req_edit"==t&&(a.approve_status=5,s="Confirm Send Request Edit Feedback?"),this.$ons.notification.confirm(s).then((t=>{1==t&&(0,c.Z)({method:"put",url:"/fuel-bill/fuel-bill-status",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:a}).then((t=>{console.log(t),200==t.status&&(this.$ons.notification.alert("Approval Status Sent"),this.FETCH_LIST())})).catch((t=>{console.log(t)})).finally((()=>{}))}))}},computed:{travel_date(){return this.info.date?_()(this.info.date).format("LL"):null},created_date(){return this.info.created_time?_()(this.info.created_time).format("LLL"):null},total_mile(){const t=this.TravelDetailList.reduce(((t,e)=>t+e.distance),0);return t}}},E=D,P=(0,h.Z)(E,a,i,!1,null,"d44785f0",null),S=P.exports}}]);
//# sourceMappingURL=876.271f2241.js.map