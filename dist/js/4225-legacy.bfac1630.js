(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[4225],{19852:function(t,a,s){"use strict";s.d(a,{Z:function(){return l}});var i=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"app-loading"},[s("div",{staticClass:"box"},[s("hash-loader",{staticClass:"custom-class",attrs:{color:"#eb1851",loading:!0,size:40,sizeUnit:"px"}}),s("h5",{staticClass:"app-name"},[t._v(t._s(t.text))])],1)])},e=[],o={name:"app-user-logging-in",props:{text:String}},n=o,r=s(1001),c=(0,r.Z)(n,i,e,!1,null,"73613f3f",null),l=c.exports},99986:function(t,a,s){"use strict";s.d(a,{Z:function(){return l}});var i=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[t._t("default")],2)},e=[],o={name:"LayoutMain",components:{}},n=o,r=s(1001),c=(0,r.Z)(n,i,e,!1,null,null,null),l=c.exports},34225:function(t,a,s){"use strict";s.r(a),s.d(a,{default:function(){return w}});var i=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"page-body",attrs:{id:"page-account"}},[s("appNavi",{attrs:{isBack:!1,pageName:"My Account"}}),s("div",{staticClass:"page-container page-display"},[s("div",{staticClass:"form"},[s("div",{staticClass:"page-section-button"},[s("h2",{staticClass:"page-section-label"},[t._v("Profile Photo")]),0==t.isEdit.photo?s("v-ons-toolbar-button",{staticClass:"popover-button",on:{click:function(a){return t.BTN_EDIT("photo")}}},[s("i",{staticClass:"las la-edit"}),s("span",[t._v("Edit")])]):t._e()],1),s("div",{staticClass:"form-item-container profile-box"},[s("div",{staticClass:"profile-photo"},[1==t.isEdit.photo?s("div",{staticClass:"btn-pic-change"},[t._m(0)]):t._e(),s("input",{ref:"file",staticStyle:{display:"none"},attrs:{type:"file",id:"pic-upload-btn"},on:{change:function(a){return t.UPLOAD_PIC()}}}),t.user.profile_picture?s("img",{attrs:{src:t.user.profile_picture}}):t._e(),t.user.profile_picture?t._e():s("img",{attrs:{src:"/img/default_profile_picture.png"}})])]),1==t.isEdit.photo?s("div",{staticClass:"form-button-container"},[s("div",{staticClass:"button-set"},[s("button",{staticClass:"grey",on:{click:function(a){return t.BTN_CANCEL()}}},[s("label",[t._v("Cancel")])])])]):t._e()]),"ceo"!=this.user.role?s("div",{staticClass:"form",staticStyle:{"grid-row":"span 2"}},[s("div",{staticClass:"page-section-button"},[s("h2",{staticClass:"page-section-label"},[t._v("Personal Informations")]),0==t.isEdit.info?s("v-ons-toolbar-button",{staticClass:"popover-button",on:{click:function(a){return t.BTN_EDIT("info")}}},[s("i",{staticClass:"las la-edit"}),s("span",[t._v("Edit")])]):t._e()],1),s("div",{staticClass:"form-item-container"},[s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Name:")]),0==t.isEdit.info?s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.firstname)+" "+t._s(t.user.lastname)+" ")]):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.firstname,expression:"formData.firstname"}],staticStyle:{"border-radius":"6px 0 0 6px","grid-column":"span 1"},attrs:{placeholder:"Firstname"},domProps:{value:t.formData.firstname},on:{input:function(a){a.target.composing||t.$set(t.formData,"firstname",a.target.value)}}}):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.lastname,expression:"formData.lastname"}],staticStyle:{"border-radius":"0 6px 6px 0","border-width":"1px 1px 1px 0","grid-column":"span 1"},attrs:{placeholder:"Lastname"},domProps:{value:t.formData.lastname},on:{input:function(a){a.target.composing||t.$set(t.formData,"lastname",a.target.value)}}}):t._e()]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Position:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.position)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Department:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.department)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Employee No:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.employee_no)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Email:")]),0==t.isEdit.info?s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.email)+" ")]):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.email,expression:"formData.email"}],attrs:{placeholder:"Email"},domProps:{value:t.formData.email},on:{input:function(a){a.target.composing||t.$set(t.formData,"email",a.target.value)}}}):t._e()]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Phone No:")]),0==t.isEdit.info?s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.phone_no)+" ")]):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.phone_no,expression:"formData.phone_no"}],attrs:{placeholder:"Phone No"},domProps:{value:t.formData.phone_no},on:{input:function(a){a.target.composing||t.$set(t.formData,"phone_no",a.target.value)}}}):t._e()])]),1==t.isEdit.info?s("div",{staticClass:"form-button-container"},[s("div",{staticClass:"button-set"},[s("button",{staticClass:"blue",on:{click:function(a){return t.SAVE_EDIT_INFO()}}},[s("label",[t._v("Save")])]),s("button",{staticClass:"grey",on:{click:function(a){return t.BTN_CANCEL()}}},[s("label",[t._v("Cancel")])])])]):t._e()]):t._e(),s("div",{staticClass:"form"},[s("div",{staticClass:"page-section-button"},[s("h2",{staticClass:"page-section-label"},[t._v("Account Setting")]),0==t.isEdit.account?s("v-ons-toolbar-button",{staticClass:"popover-button",on:{click:function(a){return t.BTN_EDIT("account")}}},[s("i",{staticClass:"las la-edit"}),s("span",[t._v("Edit")])]):t._e()],1),s("div",{staticClass:"form-item-container"},[s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Username:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.username)+" ")])]),1==t.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Old Password:")]),1==t.isEdit.account?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.oldPassword,expression:"formData.oldPassword"}],attrs:{placeholder:"Old Password",type:"password"},domProps:{value:t.formData.oldPassword},on:{input:function(a){a.target.composing||t.$set(t.formData,"oldPassword",a.target.value)}}}):t._e()]):t._e(),0==t.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Password:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.invisiblePassword)+" ")])]):t._e(),1==t.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("New Password:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.newPassword,expression:"formData.newPassword"}],attrs:{placeholder:"New Password",type:"password"},domProps:{value:t.formData.newPassword},on:{input:function(a){a.target.composing||t.$set(t.formData,"newPassword",a.target.value)}}})]):t._e(),t.formData.newPassword&&1==this.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Confirm Password:")]),1==t.isEdit.account?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.confirmPassword,expression:"formData.confirmPassword"}],attrs:{placeholder:"Confirm Password",type:"password"},domProps:{value:t.formData.confirmPassword},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.SAVE_EDIT_ACCOUNT()},input:function(a){a.target.composing||t.$set(t.formData,"confirmPassword",a.target.value)}}}):t._e()]):t._e()]),1==t.isEdit.account?s("div",{staticClass:"form-button-container"},[s("div",{staticClass:"button-set"},[s("button",{staticClass:"blue",on:{click:function(a){return t.SAVE_EDIT_ACCOUNT()}}},[s("label",[t._v("Save")])]),s("button",{staticClass:"grey",on:{click:function(a){return t.BTN_CANCEL()}}},[s("label",[t._v("Cancel")])])])]):t._e()])]),1==t.isLoading?s("PageLoading",{attrs:{text:"Loading"}}):t._e()],1)},e=[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("label",{attrs:{for:"pic-upload-btn"}},[s("i",{staticClass:"las la-edit"})])}],o=(s(41539),s(89584)),n=s(45549),r=s(17133),c=s.n(r),l=s(39477),u=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"page-container"},[s("div",{attrs:{id:"navigation-panel"}},[s("div",{staticClass:"left-col"},[1==t.isBack?s("v-ons-toolbar-button",{staticClass:"btn",on:{click:function(a){return t.goTo("/")}}},[s("i",{staticClass:"las la-angle-left"}),s("span",[t._v("Back")])]):t._e(),s("h1",{staticClass:"page-name-label"},[t._v(t._s(t.pageName))])],1),s("div",{staticClass:"right-col"})])])},d=[],p=(s(68309),{name:"navigation-bar",props:{backUrl:String,pageName:String,isBack:Boolean},methods:{goTo:function(t){var a=this;this.$ons.notification.confirm("You are exiting '"+this.$store.state.currentInApp.name+"'.").then((function(s){if(1==s){a.$store.commit("CLEAR_CURRENT_INAPP");var i=a.$route.path;i!=t&&a.$router.push({path:t,replace:!0})}}))}}}),f=p,m=s(1001),v=(0,m.Z)(f,u,d,!1,null,"58506c69",null),h=v.exports,_=s(99986),g=s(19852),C={name:"AccountView",components:{appNavi:h,PageLoading:g.Z},data:function(){return{user:"",formData:"",invisiblePassword:"********",isEdit:{info:!1,account:!1,photo:!1},jobPositionList:["Data Engineer","Programmer","General Engineer","Manager","Staff"],picUpload:"",isLoading:!1}},created:function(){this.$emit("update:layout",_.Z),this.$store.commit("UPDATE_CURRENT_INAPP",{name:"My Account",icon:""}),1==this.$store.state.status.server&&this.FETCH_USER_INFO()},mounted:function(){},methods:{FETCH_USER_INFO:function(){var t=this;this.isLoading=!0,setTimeout((function(){var a=JSON.parse(localStorage.getItem("user")).id_user;(0,l.Z)({method:"post",url:"/user/get-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_user:a}}).then((function(a){if(200==a.status){var s=a.data.user;t.user=s,null==s.profile_picture?t.user.profile_picture=null:t.user.profile_picture=t.baseURL+t.user.profile_picture,console.log("==> Fetch User Info : Account View <==")}})).catch((function(t){console.log(t)})).finally((function(){t.isLoading=!1}))}),500)},UPLOAD_PIC:function(){var t=this;if(console.log("  ==> UPLOAD PIC"),this.picUpload=this.$refs.file.files[0],this.picUpload&&"image/jpeg"==this.picUpload.type||"image/png"==this.picUpload.type)if(this.picUpload.size<2e7)(0,l.Z)({method:"post",url:"/user/upload-pic",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_user:this.user.id_user,file:this.picUpload}}).then((function(a){console.log("  ==> UPLOAD DONE"),200==a.status&&(t.isEdit.photo=!1,t.$router.go())})).catch((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)})).finally((function(){}));else{this.$ons.notification.alert("File size too large. (20 MB max)");var a=document.getElementById("pic-upload-btn");a.val=""}else{this.$ons.notification.alert("Incorrect filetype. <br/> Only JPEG/PNG file can be uploaded.");var s=document.getElementById("pic-upload-btn");s.val=""}},BTN_EDIT:function(t){var a=this;1==this.isEdit.info||1==this.isEdit.account||1==this.isEdit.photo?this.$ons.notification.confirm("Unsaved changes will be lost.").then((function(s){1==s&&(a.isEdit.info=!1,a.isEdit.account=!1,a.formData=(0,o.Z)(a.user),"info"==t?a.isEdit.info=!0:"account"==t&&(a.isEdit.account=!0))})):(this.formData=(0,o.Z)(this.user),"info"==t?this.isEdit.info=!0:"account"==t?this.isEdit.account=!0:"photo"==t&&(this.isEdit.photo=!0))},BTN_CANCEL:function(){var t=this;this.$ons.notification.confirm("Unsaved changes will be lost.").then((function(a){1==a&&(t.formData={},t.isEdit.info=!1,t.isEdit.account=!1,t.isEdit.photo=!1)}))},SAVE_EDIT_INFO:function(){var t=this;this.$ons.notification.confirm("Confirm Save").then((function(a){if(1==a){var s=t.formData;(0,l.Z)({method:"put",url:"/user/update-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:s}).then((function(a){200==a.status&&a.data&&t.$ons.notification.alert("Update user information successful").then((function(a){0==a&&(t.isEdit.user=!1,t.isEdit.info=!1,t.FETCH_USER_INFO())}))})).catch((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)})).finally((function(){}))}}))},SAVE_EDIT_ACCOUNT:function(){var t=this;this.formData.oldPassword?this.formData.newPassword?this.formData.confirmPassword?this.formData.newPassword==this.formData.confirmPassword?(0,n.sha256)(this.formData.oldPassword)==this.user.password?this.$ons.notification.confirm("Confirm Save").then((function(a){if(1==a){var s={id_user:t.formData.id_user,password:(0,n.sha256)(t.formData.confirmPassword)};(0,l.Z)({method:"put",url:"/user/change-password",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:s}).then((function(a){200==a.status&&a.data&&t.$ons.notification.alert("Account password changed").then((function(a){0==a&&(t.isEdit.account=!1,t.FETCH_USER_INFO())}))})).catch((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)})).finally((function(){}))}})):this.$ons.notification.alert("Old password is incorrect."):this.$ons.notification.alert("Confirm password mismatch."):this.$ons.notification.alert('"Confirm Password" field cannot be empty.'):this.$ons.notification.alert('"Password" field cannot be empty.'):this.$ons.notification.alert('"Old Password" field cannot be empty.')}},computed:{userBirthday:function(){var t=this.user.birthday;return c()(t).format("LL")},baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}}},E=C,b=(0,m.Z)(E,i,e,!1,null,"9743ed00",null),w=b.exports},92087:function(t,a,s){var i=s(19781),e=s(3070),o=s(67066),n=s(47293),r=RegExp.prototype,c=i&&n((function(){return"sy"!==Object.getOwnPropertyDescriptor(r,"flags").get.call({dotAll:!0,sticky:!0})}));c&&e.f(r,"flags",{configurable:!0,get:o})},68932:function(t,a,s){"use strict";s.d(a,{Z:function(){return c}});var i=s(23748);function e(t){if(Array.isArray(t))return(0,i.Z)(t)}s(82526),s(41817),s(41539),s(32165),s(78783),s(33948),s(91038);function o(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var n=s(48936);s(21703);function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return e(t)||o(t)||(0,n.Z)(t)||r()}},89584:function(t,a,s){"use strict";s.d(a,{Z:function(){return e}});var i=s(68932),e=(s(47042),s(41539),s(70189),s(78783),s(33948),s(21249),s(51532),s(24603),s(28450),s(74916),s(88386),s(39714),s(92087),s(69600),o);function o(t){var a=t,s={}.toString.call(t).slice(8,-1);if("Set"==s)return new Set((0,i.Z)(t).map((function(t){return o(t)})));if("Map"==s)return new Map((0,i.Z)(t).map((function(t){return[o(t[0]),o(t[1])]})));if("Date"==s)return new Date(t.getTime());if("RegExp"==s)return RegExp(t.source,n(t));if("Array"==s||"Object"==s)for(var e in a=Array.isArray(t)?[]:{},t)a[e]=o(t[e]);return a}function n(t){if("string"==typeof t.source.flags)return t.source.flags;var a=[];return t.global&&a.push("g"),t.ignoreCase&&a.push("i"),t.multiline&&a.push("m"),t.sticky&&a.push("y"),t.unicode&&a.push("u"),a.join("")}}}]);
//# sourceMappingURL=4225-legacy.bfac1630.js.map