"use strict";(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[8766],{72421:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"image-preview-wrapper"},[a("div",{staticClass:"preview-popup"},[a("v-ons-toolbar-button",{staticClass:"btn-close",on:{click:function(e){return t.CLOSE_PREVIEW()}}},[a("i",{staticClass:"las la-times"})]),a("v-ons-toolbar-button",{staticClass:"btn-close download"},[a("a",{attrs:{target:"_blank",href:t.baseURL+t.imageURL,download:""}},[a("i",{staticClass:"las la-download"})])]),a("img",{attrs:{src:t.baseURL+t.imageURL}})],1)])},s=[],o=(a(74916),a(23123),{name:"image-preview",props:{imageURL:String},computed:{baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{DOWNLOAD_IMG:function(t){var e=document.createElement("a");e.href=t,e.download=t.split("/").pop(),document.body.appendChild(e),e.click(),document.body.removeChild(e)},CLOSE_PREVIEW:function(){this.$emit("close-preview")}}}),n=o,r=a(1001),l=(0,r.Z)(n,i,s,!1,null,"1c402f72",null),c=l.exports},31323:function(t,e,a){a.d(e,{Z:function(){return f}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[t._m(0),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[t._m(1),a("p",{staticClass:"info"},[t._v(" "+t._s(t.formData.record_no)+" ")])]),a("div",{staticClass:"input-set"},[t._m(2),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"Bill Date"},model:{value:t.formData.bill_date,callback:function(e){t.$set(t.formData,"bill_date",e)},expression:"formData.bill_date"}})],1),a("div",{staticClass:"input-set"},[t._m(3),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.price,expression:"formData.price"}],attrs:{type:"text",placeholder:"Price"},domProps:{value:t.formData.price},on:{input:function(e){e.target.composing||t.$set(t.formData,"price",e.target.value)}}})])]),a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[t._m(4),a("div",{staticClass:"picture-upload-box"},[t._m(5),a("div",{staticClass:"upload-box"},[a("div",{staticClass:"upload-btn-wrapper"},[a("input",{ref:"file_img",staticStyle:{display:"none"},attrs:{type:"file",id:"preview_input_img"},on:{change:function(e){return t.PREVIEW_IMG_UPLOAD()}}}),a("v-ons-toolbar-button",[a("label",{attrs:{for:"preview_input_img"}},[a("i",{staticClass:"las la-image"}),t._v("Select File")])]),a("v-ons-toolbar-button",{staticClass:"btn-delete",on:{click:function(e){return t.PREVIEW_IMG_DELETE()}}},[a("i",{staticClass:"las la-trash"})])],1)])])])])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-header"},[a("label",[t._v("Edit Record")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Record No:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Bill Date:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Price:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Receipt Image:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"preview-box"},[a("img",{attrs:{id:"preview_img",src:"",alt:""}})])}],o=(a(41539),a(78783),a(33948),a(60285),a(41637),a(39477)),n=a(89584),r=a(48176),l=a.n(r),c={name:"popup-edit-gasbill",components:{DxDateBox:l()},props:{editInfo:Object},data:function(){return{formData:{},formSelect:{now:new Date}}},computed:{baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},created:function(){this.formData=(0,n.Z)(this.editInfo);var t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user,this.formData.doc_seq=parseInt(this.formData.doc_seq)},mounted:function(){null!=this.formData.receipt_img&&(document.getElementById("preview_img").src=this.baseURL+this.formData.receipt_img)},methods:{PREVIEW_IMG_UPLOAD:function(){this.formData.file=this.$refs.file_img.files[0];var t=this.formData.file;t&&("image/png"==t.type||"image/jpeg"==t.type?t.size<2e7?document.getElementById("preview_img").src=window.URL.createObjectURL(t):(this.$ons.notification.alert("File size too large. (20 MB max)"),this.PREVIEW_IMG_FORM_CLEAR()):(this.$ons.notification.alert("Incorrect filetype. <br/> Only PNG/JPG/JPEG file can be uploaded."),this.PREVIEW_IMG_FORM_CLEAR()))},PREVIEW_IMG_DELETE:function(){this.formData.file=null,this.formData.receipt_img=null,document.getElementById("preview_img").src=""},PREVIEW_IMG_FORM_CLEAR:function(){var t=document.getElementById("preview_input_img");t.val="",this.formData.file=null},SAVE:function(){var t=this;this.formData.bill_date?this.formData.price?this.$ons.notification.confirm("Confirm save?").then((function(e){if(1==e){var a=t.formData;(0,o.Z)({method:"put",url:"/fuel-bill/fuel-bill-edit",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:a}).then((function(e){200==e.status&&(t.$ons.notification.alert("Bill Record Edit successful"),t.$emit("btn-cancel-edit"),t.$emit("refreshList"))})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){}))}})):this.$ons.notification.alert('"Price" field cannot be empty'):this.$ons.notification.alert('"Bill Date" field cannot be empty')},CANCEL:function(){var t=this,e=this.formData;this.formData!=e?this.$ons.notification.confirm("Your unsaved changes will be lost").then((function(e){1==e&&t.$emit("btn-cancel-edit")})):this.$emit("btn-cancel-edit")}}},d=c,u=a(1001),p=(0,u.Z)(d,i,s,!1,null,"787961ae",null),f=p.exports},78766:function(t,e,a){a.r(e),a.d(e,{default:function(){return P}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pm-page"},[a("div",{staticClass:"pm-toolbar"},[a("toolbar",{attrs:{pageName:"Travel Record",isNewBtn:!0,newBtnLabel:"New Travel Record"},on:{refreshInfo:function(e){return t.FETCH_LIST()},newBtnFn:function(e){return t.TOGGLE_POPUP("add")}}})],1),a("div",{staticClass:"pm-page-container"},[a("div",{staticClass:"page-content page-list"},[a("DxDataGrid",{attrs:{id:"contact-client-list","data-source":t.TravelList,selection:{mode:"single"},"hover-state-enabled":!0,"allow-column-reordering":!1,"show-borders":!0,"show-row-lines":!1,"row-alternation-enabled":!0},on:{exporting:t.EXPORT_DATA},scopedSlots:t._u([{key:"approval-status",fn:function(e){var i=e.data;return[a("div",{staticClass:"approval-incolumn"},[1==i.data.approve_status?a("div",{staticClass:"blue"},[a("span",[t._v(t._s(i.data.status_desc))])]):t._e(),2==i.data.approve_status?a("div",{staticClass:"orange"},[a("i",{staticClass:"las la-clock"}),a("span",[t._v(t._s(i.data.status_desc))])]):t._e(),3==i.data.approve_status?a("div",{staticClass:"green"},[a("i",{staticClass:"las la-check-double"}),a("span",[t._v(t._s(i.data.status_desc))])]):t._e(),4==i.data.approve_status?a("div",{staticClass:"red"},[a("i",{staticClass:"las la-times"}),a("span",[t._v(t._s(i.data.status_desc))])]):t._e(),5==i.data.approve_status?a("div",{staticClass:"red"},[a("i",{staticClass:"las la-pen"}),a("span",[t._v(t._s(i.data.status_desc))])]):t._e()])]}},{key:"option-btn-set",fn:function(e){var i=e.data;return[a("div",{staticClass:"table-btn-group"},[a("div",{staticClass:"table-btn",on:{click:function(e){return t.VIEW_INFO(i)}}},[a("i",{staticClass:"las la-search blue"})])])]}}])},[a("DxColumn",{attrs:{"data-field":"record_no",caption:"Record No.","sort-order":"desc"}}),a("DxColumn",{attrs:{"data-field":"date","data-type":"date",format:"dd MMM, yyyy",caption:"Travel Date"}}),a("DxColumn",{attrs:{"data-field":"created_by_name",caption:"Created By"}}),a("DxColumn",{attrs:{"data-field":"created_time","data-type":"date",format:"dd MMM, yyyy",caption:"Created Date"}}),a("DxColumn",{attrs:{caption:"Approval Status",alignment:"center",width:150,"cell-template":"approval-status"}}),a("DxColumn",{attrs:{width:50,caption:"","cell-template":"option-btn-set"}}),a("DxScrolling",{attrs:{mode:"standard"}}),a("DxSearchPanel",{attrs:{visible:!0}}),a("DxPaging",{attrs:{"page-size":10,"page-index":0}}),a("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}})],1)],1)]),1==t.isAdd?a("popupAdd",{on:{"btn-cancel-add":function(e){return t.TOGGLE_POPUP("add")},refreshList:function(e){return t.FETCH_LIST()}}}):t._e(),1==t.isEdit?a("popupEdit",{attrs:{editInfo:t.editInfo},on:{"btn-cancel-edit":function(e){return t.TOGGLE_POPUP("edit")},refreshList:function(e){return t.FETCH_LIST()}}}):t._e(),1==t.isLoading?a("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fc9b21"}}):t._e(),t.previewImg?a("previewImage",{attrs:{imageURL:t.previewImg},on:{"close-preview":function(e){return t.PREVIEW_IMG_CLOSE()}}}):t._e()],1)},s=[],o=(a(41539),a(66262)),n=a(48626),r=a(39477),l=a(53706),c=a.n(l),d=a(71642),u=a(17133),p=a.n(u),f=a(85981),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[a("div",{staticClass:"popup-header"},[a("label",[t._v("Add New Record")]),a("span",{staticStyle:{"font-size":"14px","padding-right":"20px"}},[t._v(t._s(t.formData.record_no)+" ")])]),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[t._m(0),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"Select Date"},model:{value:t.formData.bill_date,callback:function(e){t.$set(t.formData,"bill_date",e)},expression:"formData.bill_date"}})],1),a("div",{staticClass:"input-set",staticStyle:{"margin-top":"10px"}},[t._m(1),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.note,expression:"formData.note"}],staticStyle:{height:"80px","max-height":"200px"},attrs:{placeholder:"Note"},domProps:{value:t.formData.note},on:{input:function(e){e.target.composing||t.$set(t.formData,"note",e.target.value)}}})])])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},_=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Create Record for(Date):")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Notes:")])])}],v=(a(39714),a(47042),a(48176)),h=a.n(v),g={name:"popup-add-travel",components:{DxDateBox:h()},data:function(){return{formData:{id_user:"",record_no:"",bill_date:"",price:"",doc_seq:"",file:""},formSelect:{now:new Date}}},created:function(){var t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user,this.GET_LAST_SEQ_NO()},methods:{GET_LAST_SEQ_NO:function(){var t=this,e="TravelRecord";(0,r.Z)({method:"post",url:"/global/last-doc-seq",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{table_name:e}}).then((function(e){if(200==e.status&&e.data){var a=e.data[0].last_doc_seq;t.formData.doc_seq=null==a?1:a+1,t.formData.doc_seq<10&&(t.formData.doc_seq="0"+t.formData.doc_seq.toString()),t.CAL_DOC_NO()}})).catch((function(t){console.log(t)})).finally((function(){}))},CAL_DOC_NO:function(){var t,e=p()().month()+1,a=p()().year(),i=e.toString(),s=a.toString();1==i.length&&(i="0"+i),s=s.slice(2,4),t=i.toString()+"-"+s.toString(),this.formData.record_no="AI-TRR-"+t+"-"+this.formData.doc_seq.toString()},SAVE:function(){var t=this;this.formData.bill_date?this.formData.price?this.$ons.notification.confirm("Confirm save?").then((function(e){if(1==e){var a=t.formData;(0,r.Z)({method:"post",url:"/fuel-bill/fuel-bill-add",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:a}).then((function(e){200==e.status&&(t.$ons.notification.alert("Bill Record Add successful"),t.$emit("btn-cancel-add"),t.$emit("refreshList"))})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){}))}})):this.$ons.notification.alert('"Price" field cannot be empty'):this.$ons.notification.alert('"Bill Date" field cannot be empty')},CANCEL:function(){var t=this,e=this.formData;this.formData!=e?this.$ons.notification.confirm("Your unsaved changes will be lost").then((function(e){1==e&&t.$emit("btn-cancel-add")})):this.$emit("btn-cancel-add")}}},b=g,C=a(1001),D=(0,C.Z)(b,m,_,!1,null,"09b91afc",null),E=D.exports,w=a(31323),L=a(49075),I=a(89584),S=a(72421),R={name:"ViewTravelRcord",components:{toolbar:f.Z,DxDataGrid:n.DxDataGrid,DxSearchPanel:n.DxSearchPanel,DxPaging:n.DxPaging,DxPager:n.DxPager,DxScrolling:n.DxScrolling,DxColumn:n.DxColumn,previewImage:S.Z,contentLoading:L.Z,popupAdd:E,popupEdit:w.Z},created:function(){this.$store.commit("UPDATE_CURRENT_INAPP",{name:"Travel Record",icon:"/img/icon_menu/record/travel.png"}),this.FETCH_LIST()},data:function(){return{isAdd:!1,isEdit:!1,isLoading:!1,currentViewRow:1,errorMessage:"",editInfo:"",previewImg:"",TravelList:[]}},computed:{gas_bill_date:function(){return p()(this.currentViewRow.bill_date).format("LL")},baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{EXPORT_DATA:function(t){var e=new d.Workbook,a=e.addWorksheet("Clients");(0,o.d)({worksheet:a,component:t.component}).then((function(){e.xlsx.writeBuffer().then((function(t){c()(new Blob([t],{type:"application/octet-stream"}),"Clients.xlsx")}))})),t.cancel=!0},VIEW_INFO:function(t){var e=t.data.id_travel;null!=e&&this.$router.push("/record/travel/"+e)},DELETE_ITEM:function(){var t=this;this.$ons.notification.confirm("Confirm delete?").then((function(e){1==e&&(0,r.Z)({method:"delete",url:"/fuel-bill/fuel-bill-delete",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_fuel_bill:t.currentViewRow.id_fuel_bill}}).then((function(e){console.log(e),200==e.status&&(t.$ons.notification.alert("Delete successful"),t.FETCH_LIST())})).catch((function(t){console.log(t)})).finally((function(){}))}))},CLEAR_VIEW_INFO:function(){this.currentViewRow=""},TOGGLE_POPUP:function(t){"add"==t?1==this.isAdd?this.isAdd=!1:this.isAdd=!0:"edit"==t&&(1==this.isEdit?this.isEdit=!1:(this.editInfo=(0,I.Z)(this.currentViewRow),this.isEdit=!0))},FETCH_LIST:function(){var t=this;this.currentViewRow,this.isLoading=!0,(0,r.Z)({method:"get",url:"/travel-record/travel-record-list",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){e.data&&(t.TravelList=e.data,t.TravelList.length>0&&(t.currentViewRow=t.TravelList[t.TravelList.length-1]))})).catch((function(t){console.log(t)})).finally((function(){t.isLoading=!1}))},SCROLL_TOP_INFO:function(){""!=this.currentViewRow&&document.getElementById("info-sidebar").scroll({top:0,behavior:"smooth"})},PREVIEW_IMG:function(t){t&&(this.previewImg=t)},PREVIEW_IMG_CLOSE:function(){this.previewImg=""},APPROVE_BTN:function(t){var e=this,a=JSON.parse(localStorage.getItem("user")),i="N/A",s={id_fuel_bill:this.currentViewRow.id_fuel_bill,approve_status:0,id_user:a.id_user};"req_approve"==t?(s.approve_status=2,i="Confirm Send Approve Request?"):"approve"==t?(s.approve_status=3,i="Confirm Send Approve Feedback?"):"reject"==t?(s.approve_status=4,i="Confirm Send Reject Feedback?"):"req_edit"==t&&(s.approve_status=5,i="Confirm Send Request Edit Feedback?"),this.$ons.notification.confirm(i).then((function(t){1==t&&(0,r.Z)({method:"put",url:"/fuel-bill/fuel-bill-status",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:s}).then((function(t){console.log(t),200==t.status&&(e.$ons.notification.alert("Approval Status Sent"),e.FETCH_LIST())})).catch((function(t){console.log(t)})).finally((function(){}))}))}}},x=R,$=(0,C.Z)(x,i,s,!1,null,"ff45c4b8",null),P=$.exports}}]);
//# sourceMappingURL=8766-legacy.2852f72d.js.map