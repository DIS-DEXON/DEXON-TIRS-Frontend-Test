"use strict";(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[4674],{96125:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"approval-box"},[a("div",{staticClass:"message-box"},[1==this.status?a("p",{staticClass:"message-title blue"},[t._v("UNAPPROVED")]):t._e(),2==this.status?a("p",{staticClass:"message-title orange"},[t._v("PENDING")]):t._e(),3==this.status?a("p",{staticClass:"message-title green"},[t._v("APPROVED")]):t._e(),4==this.status?a("p",{staticClass:"message-title red"},[t._v("REJECTED")]):t._e(),5==this.status?a("p",{staticClass:"message-title red"},[t._v("REQUEST EDIT")]):t._e(),a("p",{staticClass:"message-text"},[t._v(t._s(t.statusText))])]),1==t.status&&"staff"==this.$store.state.user.role?a("div",{staticClass:"button-set"},[a("v-ons-toolbar-button",{staticClass:"blue",on:{click:function(e){return t.$emit("btnRequestApprove")}}},[a("i",{staticClass:"las la-reply"}),a("span",[t._v("Send Approve Request")])])],1):t._e(),2==t.status&&"manager"==this.$store.state.user.role?a("div",{staticClass:"button-set"},[a("div",{staticClass:"double-button-set"},[a("v-ons-toolbar-button",{staticClass:"green",on:{click:function(e){return t.$emit("btnApprove")}}},[a("i",{staticClass:"las la-check"}),a("span",[t._v("Approve")])]),a("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.$emit("btnReject")}}},[a("i",{staticClass:"las la-times"}),a("span",[t._v("Reject")])])],1),a("v-ons-toolbar-button",{staticClass:"blue",on:{click:function(e){return t.$emit("btnRequestEdit")}}},[a("i",{staticClass:"las la-reply-all"}),a("span",[t._v("Request Edit")])])],1):t._e(),5==t.status&&"staff"==this.$store.state.user.role?a("div",{staticClass:"button-set"},[5==t.status?a("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.$emit("btnResendApprove")}}},[a("i",{staticClass:"las la-reply-all"}),a("span",[t._v(" Resend Approve Request")])]):t._e()],1):t._e()])},i=[],n=(a(9653),{name:"app-approval-status",props:{status:Number},created:function(){},computed:{statusText:function(){var t=this.$store.state.user.role;return"staff"==t?1==this.status?"This record has not been sent to a section manager for an approval.":2==this.status?"This record has been sent to a section manager for an approval.":3==this.status?"This record is approved by a section manager. It cannot be edited or deleted.":4==this.status?"This record is rejected by a section manager.":5==this.status?"This record is requested review and edit by a section manager.":"N/A":"manager"==t?1==this.status?"This record has not been sent to a section manager for a review.":2==this.status?"This record is waiting for an approval feedback from a section manager.":3==this.status?"This record is approved.":4==this.status?"This record is rejected.":5==this.status?"This record has been request for editing. It is waiting for a new approval request.":"N/A":"N/A"}}}),o=n,r=a(1001),l=(0,r.Z)(o,s,i,!1,null,"99393d82",null),c=l.exports},42876:function(t,e,a){a.r(e),a.d(e,{default:function(){return P}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pm-page"},[a("div",{staticClass:"pm-toolbar"},[a("toolbar",{attrs:{pageSubName:"Record No. "+t.info.record_no,isBack:!0,isEdit:t.sign_status,isDelete:!0,isPrint:!1,isDownload:!0},on:{isDeleteBtn:function(e){return t.DELETE_PROJECT()},isEditBtn:function(e){return t.TOGGLE_POPUP()},isDownloadBtn:function(e){return t.DOWNLOAD_PDF()},refreshInfo:function(e){return t.FETCH_INFO()}}})],1),a("div",{staticClass:"pm-page-container"},[a("div",{staticClass:"page-content"},[this.info.created_by==this.$store.state.user.id_user||"manager"==this.$store.state.user.role?a("approvalBox",{staticClass:"approval-box-fullpage",attrs:{status:this.info.approve_status},on:{btnRequestApprove:function(e){return t.APPROVE_BTN("req_approve")},btnApprove:function(e){return t.APPROVE_BTN("approve")},btnReject:function(e){return t.APPROVE_BTN("reject")},btnRequestEdit:function(e){return t.APPROVE_BTN("req_edit")},btnResendApprove:function(e){return t.APPROVE_BTN("req_approve")}}}):t._e(),a("div",{staticClass:"page-info form"},[a("p",{staticClass:"page-section-label"},[t._v("Record Detail")]),a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Record No:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.info.record_no)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Travel Date:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.travel_date)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Created By:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.info.created_by_name)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Total Mile:")]),t.total_mile>0?a("p",{staticClass:"info"},[t._v(t._s(t.total_mile)+" Km")]):t._e(),!t.total_mile||t.total_mile<=0?a("p",{staticClass:"info"},[t._v("-")]):t._e()]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Created Date:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.created_date)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Approval Status:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.info.status_desc)+" ")])]),a("div",{staticClass:"input-set",staticStyle:{"grid-column":"span 3"}},[a("p",{staticClass:"label"},[t._v("Note:")]),a("p",{staticClass:"info",staticStyle:{height:"60px","text-align":"left"}},[t._v(" "+t._s(t.info.note)+" ")])])]),a("div",{},[a("DxDataGrid",{attrs:{id:"contact-client-list","data-source":t.TravelDetailList,selection:{mode:"single"},"hover-state-enabled":!0,"allow-column-reordering":!1,"show-borders":!0,"show-row-lines":!1,"row-alternation-enabled":!0},scopedSlots:t._u([{key:"option-btn-set",fn:function(e){var s=e.data;return[a("div",{staticClass:"table-btn-group"},[a("div",{staticClass:"table-btn",on:{click:function(e){return t.TOGGLE_POPUP("edit",s)}}},[a("i",{staticClass:"las la-pen green"})]),a("div",{staticClass:"table-btn",on:{click:function(e){return t.DELETE_ITEM(s)}}},[a("i",{staticClass:"las la-trash red"})])])]}},{key:"tableName",fn:function(){return[a("p",{staticClass:"page-intable-section-label"},[t._v("Visiting Record")])]},proxy:!0},{key:"addVisitRecord",fn:function(){return[a("v-ons-toolbar-button",{on:{click:function(e){return t.TOGGLE_POPUP()}}},[a("i",{staticClass:"las la-plus"}),a("span",[t._v("Add")])])]},proxy:!0}])},[a("DxColumn",{attrs:{"data-field":"visit_record_no",caption:"Visit Record No.","sort-order":"asc"}}),a("DxColumn",{attrs:{"data-field":"client_name",caption:"Client Name"}}),a("DxColumn",{attrs:{"data-field":"travel_from",caption:"From"}}),a("DxColumn",{attrs:{"data-field":"travel_to",caption:"To"}}),a("DxColumn",{attrs:{"data-field":"distance",caption:"Distance",alignment:"left"}}),a("DxColumn",{attrs:{width:80,caption:"","cell-template":"option-btn-set"}}),a("DxToolbar",[a("DxItem",{attrs:{location:"before",template:"tableName"}}),a("DxItem",{attrs:{location:"after",template:"addVisitRecord"}})],1),a("DxScrolling",{attrs:{mode:"standard"}}),a("DxSearchPanel",{attrs:{visible:!0}}),a("DxPaging",{attrs:{"page-size":10,"page-index":0}}),a("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}})],1)],1)])],1)]),a("popupAdd",{attrs:{travelDate:this.info.date}}),1==t.isEdit?a("popupEdit",{attrs:{editInfo:t.info},on:{closePopup:function(e){return t.TOGGLE_POPUP()},FETCH_INFO:function(e){return t.FETCH_INFO()}}}):t._e(),1==t.isSign?a("popupSign",{attrs:{title:t.popupTitle,signer:t.currentSigner,info:this.info},on:{closePopup:function(e){return t.TOGGLE_POPUP_SIGN()},FETCH_INFO:function(e){return t.FETCH_INFO()}}}):t._e(),1==t.isLoading?a("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fbcb04"}}):t._e()],1)},i=[],n=(a(41539),a(48626)),o=a(85981),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[a("div",{staticClass:"popup-header"},[a("label",[t._v("Select Visit Record")]),a("span",{staticStyle:{"font-size":"14px","padding-right":"20px"}},[t._v(t._s(t.formData.record_no)+" ")])]),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Travel Date:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.travel_date)+" ")])]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Visit Record:")]),a("DxSelectBox",{staticStyle:{border:"0","font-size":"14px"},attrs:{items:t.formSelect.jobType,placeholder:"Select Visit Record"},model:{value:t.formData.job_type,callback:function(e){t.$set(t.formData,"job_type",e)},expression:"formData.job_type"}})],1)])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},l=[],c=a(39477),u=a(56935),d=a.n(u),p=a(17133),f=a.n(p),_={name:"popup-add-travel-detail",components:{DxSelectBox:d()},props:{travelDate:String},data:function(){return{formData:{id_user:"",record_no:"",bill_date:"",price:"",doc_seq:"",file:""},formSelect:{visit_record_list:[{id_visit:0,visit_record_no:"AI-CVR-22-09-01",client_name:"PTTEP LNG",distance:24}]}}},created:function(){var t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user},computed:{travel_date:function(){return this.travelDate?f()(this.travelDate).format("LL"):null}},methods:{SAVE:function(){var t=this;this.formData.bill_date?this.formData.price?this.$ons.notification.confirm("Confirm save?").then((function(e){if(1==e){var a=t.formData;(0,c.Z)({method:"post",url:"/fuel-bill/fuel-bill-add",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:a}).then((function(e){200==e.status&&(t.$ons.notification.alert("Bill Record Add successful"),t.$emit("btn-cancel-add"),t.$emit("refreshList"))})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){}))}})):this.$ons.notification.alert('"Price" field cannot be empty'):this.$ons.notification.alert('"Bill Date" field cannot be empty')},CANCEL:function(){var t=this,e=this.formData;this.formData!=e?this.$ons.notification.confirm("Your unsaved changes will be lost").then((function(e){1==e&&t.$emit("btn-cancel-add")})):this.$emit("btn-cancel-add")}}},v=_,m=a(1001),h=(0,m.Z)(v,r,l,!1,null,"1ccbbc50",null),g=h.exports,b=a(98942),C=a(49075),D=a(96125),T={name:"ViewTravelInfo",components:{DxDataGrid:n.DxDataGrid,DxSearchPanel:n.DxSearchPanel,DxPaging:n.DxPaging,DxPager:n.DxPager,DxScrolling:n.DxScrolling,DxColumn:n.DxColumn,DxToolbar:n.DxToolbar,DxItem:n.DxItem,toolbar:o.Z,popupAdd:g,popupEdit:b.Z,contentLoading:C.Z,approvalBox:D.Z},created:function(){1==this.$store.state.status.server&&this.FETCH_INFO()},data:function(){return{isLoading:!1,isAdd:!1,isEdit:!1,isSign:!1,sign_status:!0,info:"",popupTitle:"",TravelDetailList:[{id_travel_detail:0,id_travel:2,id_visit:1,visit_record_no:"AI-CVR-09-22-01",travel_from:"DEXON Main Office",travel_to:"PTTLNG",distance:24,client_name:"PTTLNG",treval_note:"nothing to note krub"},{id_travel_detail:1,id_travel:2,id_visit:2,visit_record_no:"AI-CVR-09-22-02",travel_from:"PTTLNG",travel_to:"PTTEP S1",distance:76,client_name:"PTTEP S1",treval_note:""},{id_travel_detail:2,id_travel:2,id_visit:3,visit_record_no:"AI-CVR-09-22-03",travel_from:"PTTEP S1",travel_to:"DEXON Main Office",distance:96,client_name:"-",treval_note:""}]}},methods:{TOGGLE_POPUP_SIGN:function(t){1==this.isSign&&(this.isSign=!1),"dexon"==t?(this.popupTitle="Dexon Signature",this.currentSigner="dexon",this.isSign=!0):"client"==t&&(this.popupTitle="Client Signature",this.currentSigner="client",this.isSign=!0)},FETCH_INFO:function(){var t=this;this.isLoading=!0,setTimeout((function(){var e=t.$route.params;e&&(0,c.Z)({method:"post",url:"/travel-record/travel-record-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:e}).then((function(e){console.log(e),200==e.status&&e.data[0]?t.info=e.data[0]:t.$ons.notification.alert("No record found!")})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){t.isLoading=!1}))}),500)},FETCH_INFO_LIST:function(){var t=this;this.isLoading=!0,setTimeout((function(){var e=t.$route.params;e&&(0,c.Z)({method:"post",url:"/travel-record/travel-record-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:e}).then((function(e){console.log(e),200==e.status&&e.data[0]?t.info=e.data[0]:t.$ons.notification.alert("No record found!")})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){t.isLoading=!1}))}),500)},DELETE_PROJECT:function(){var t=this,e=this.$route.params;this.$ons.notification.confirm("Confirm delete?").then((function(a){1==a&&(0,c.Z)({method:"put",url:"/visit-record/visit-record-delete",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:e}).then((function(e){200==e.status&&(t.$ons.notification.alert("Visit Record delete successful"),t.$router.go(-1))})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){}))}))},TOGGLE_POPUP:function(t){"add"==t?this.isAdd=!this.isAdd:"edit"==t&&(this.isEdit=!this.isEdit)},APPROVE_BTN:function(t){var e=this,a=JSON.parse(localStorage.getItem("user")),s="N/A",i={id_fuel_bill:this.currentViewRow.id_fuel_bill,approve_status:0,id_user:a.id_user};"req_approve"==t?(i.approve_status=2,s="Confirm Send Approve Request?"):"approve"==t?(i.approve_status=3,s="Confirm Send Approve Feedback?"):"reject"==t?(i.approve_status=4,s="Confirm Send Reject Feedback?"):"req_edit"==t&&(i.approve_status=5,s="Confirm Send Request Edit Feedback?"),this.$ons.notification.confirm(s).then((function(t){1==t&&(0,c.Z)({method:"put",url:"/fuel-bill/fuel-bill-status",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:i}).then((function(t){console.log(t),200==t.status&&(e.$ons.notification.alert("Approval Status Sent"),e.FETCH_LIST())})).catch((function(t){console.log(t)})).finally((function(){}))}))}},computed:{travel_date:function(){return this.info.date?f()(this.info.date).format("LL"):null},created_date:function(){return this.info.created_time?f()(this.info.created_time).format("LLL"):null},total_mile:function(){var t=this.TravelDetailList.reduce((function(t,e){return t+e.distance}),0);return t}}},E=T,S=(0,m.Z)(E,s,i,!1,null,"d44785f0",null),P=S.exports},89584:function(t,e,a){a.d(e,{Z:function(){return i}});var s=a(68932),i=(a(47042),a(41539),a(70189),a(78783),a(33948),a(21249),a(51532),a(24603),a(28450),a(74916),a(88386),a(39714),a(92087),a(69600),n);function n(t){var e=t,a={}.toString.call(t).slice(8,-1);if("Set"==a)return new Set((0,s.Z)(t).map((function(t){return n(t)})));if("Map"==a)return new Map((0,s.Z)(t).map((function(t){return[n(t[0]),n(t[1])]})));if("Date"==a)return new Date(t.getTime());if("RegExp"==a)return RegExp(t.source,o(t));if("Array"==a||"Object"==a)for(var i in e=Array.isArray(t)?[]:{},t)e[i]=n(t[i]);return e}function o(t){if("string"==typeof t.source.flags)return t.source.flags;var e=[];return t.global&&e.push("g"),t.ignoreCase&&e.push("i"),t.multiline&&e.push("m"),t.sticky&&e.push("y"),t.unicode&&e.push("u"),e.join("")}}}]);
//# sourceMappingURL=4674-legacy.43fcfb4d.js.map