"use strict";(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[60],{96125:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"approval-box"},[a("div",{staticClass:"message-box"},[1==this.status?a("p",{staticClass:"message-title blue"},[t._v("UNAPPROVED")]):t._e(),2==this.status?a("p",{staticClass:"message-title orange"},[t._v("PENDING")]):t._e(),3==this.status?a("p",{staticClass:"message-title green"},[t._v("APPROVED")]):t._e(),4==this.status?a("p",{staticClass:"message-title red"},[t._v("REJECTED")]):t._e(),5==this.status?a("p",{staticClass:"message-title red"},[t._v("REQUEST EDIT")]):t._e(),a("p",{staticClass:"message-text"},[t._v(t._s(t.statusText))])]),1==t.status&&"staff"==this.$store.state.user.role?a("div",{staticClass:"button-set"},[a("v-ons-toolbar-button",{staticClass:"blue",on:{click:function(e){return t.$emit("btnRequestApprove")}}},[a("i",{staticClass:"las la-reply"}),a("span",[t._v("Send Approve Request")])])],1):t._e(),2==t.status&&"manager"==this.$store.state.user.role?a("div",{staticClass:"button-set"},[a("div",{staticClass:"double-button-set"},[a("v-ons-toolbar-button",{staticClass:"green",on:{click:function(e){return t.$emit("btnApprove")}}},[a("i",{staticClass:"las la-check"}),a("span",[t._v("Approve")])]),a("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.$emit("btnReject")}}},[a("i",{staticClass:"las la-times"}),a("span",[t._v("Reject")])])],1),a("v-ons-toolbar-button",{staticClass:"blue",on:{click:function(e){return t.$emit("btnRequestEdit")}}},[a("i",{staticClass:"las la-reply-all"}),a("span",[t._v("Request Edit")])])],1):t._e(),5==t.status&&"staff"==this.$store.state.user.role?a("div",{staticClass:"button-set"},[5==t.status?a("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.$emit("btnResendApprove")}}},[a("i",{staticClass:"las la-reply-all"}),a("span",[t._v(" Resend Approve Request")])]):t._e()],1):t._e()])},i=[],r={name:"app-approval-status",props:{status:Number},created(){},computed:{statusText(){var t=this.$store.state.user.role;return"staff"==t?1==this.status?"This record has not been sent to a section manager for an approval.":2==this.status?"This record has been sent to a section manager for an approval.":3==this.status?"This record is approved by a section manager. It cannot be edited or deleted.":4==this.status?"This record is rejected by a section manager.":5==this.status?"This record is requested review and edit by a section manager.":"N/A":"manager"==t?1==this.status?"This record has not been sent to a section manager for a review.":2==this.status?"This record is waiting for an approval feedback from a section manager.":3==this.status?"This record is approved.":4==this.status?"This record is rejected.":5==this.status?"This record has been request for editing. It is waiting for a new approval request.":"N/A":"N/A"}}},n=r,o=a(1001),l=(0,o.Z)(n,s,i,!1,null,"99393d82",null),c=l.exports},72421:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"image-preview-wrapper"},[a("div",{staticClass:"preview-popup"},[a("v-ons-toolbar-button",{staticClass:"btn-close",on:{click:function(e){return t.CLOSE_PREVIEW()}}},[a("i",{staticClass:"las la-times"})]),a("v-ons-toolbar-button",{staticClass:"btn-close download"},[a("a",{attrs:{target:"_blank",href:t.baseURL+t.imageURL,download:""}},[a("i",{staticClass:"las la-download"})])]),a("img",{attrs:{src:t.baseURL+t.imageURL}})],1)])},i=[],r={name:"image-preview",props:{imageURL:String},computed:{baseURL(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{DOWNLOAD_IMG(t){const e=document.createElement("a");e.href=t,e.download=t.split("/").pop(),document.body.appendChild(e),e.click(),document.body.removeChild(e)},CLOSE_PREVIEW(){this.$emit("close-preview")}}},n=r,o=a(1001),l=(0,o.Z)(n,s,i,!1,null,"1c402f72",null),c=l.exports},3060:function(t,e,a){a.r(e),a.d(e,{default:function(){return N}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pm-page"},[a("div",{staticClass:"pm-toolbar"},[a("toolbar",{attrs:{pageName:"Mileage Record",isNewBtn:!0,newBtnLabel:"New Mile Record"},on:{refreshInfo:function(e){return t.FETCH_LIST()},newBtnFn:function(e){return t.TOGGLE_POPUP("add")}}})],1),a("div",{staticClass:"pm-page-container"},[a("div",{staticClass:"page-content page-list"},[a("DxDataGrid",{attrs:{id:"contact-client-list","data-source":t.MileageList,selection:{mode:"single"},"hover-state-enabled":!0,"allow-column-reordering":!1,"show-borders":!0,"show-row-lines":!1,"row-alternation-enabled":!0},on:{exporting:t.EXPORT_DATA},scopedSlots:t._u([{key:"approval-status",fn:function(e){var s=e.data;return[a("div",{staticClass:"approval-incolumn"},[1==s.data.approve_status?a("div",{staticClass:"blue"},[a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),2==s.data.approve_status?a("div",{staticClass:"orange"},[a("i",{staticClass:"las la-clock"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),3==s.data.approve_status?a("div",{staticClass:"green"},[a("i",{staticClass:"las la-check-double"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),4==s.data.approve_status?a("div",{staticClass:"red"},[a("i",{staticClass:"las la-times"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),5==s.data.approve_status?a("div",{staticClass:"red"},[a("i",{staticClass:"las la-pen"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e()])]}},{key:"option-btn-set",fn:function(e){var s=e.data;return[a("div",{staticClass:"table-btn-group"},[a("div",{staticClass:"table-btn",on:{click:function(e){return t.VIEW_INFO(s)}}},[a("i",{staticClass:"las la-search blue"})])])]}}])},[a("DxColumn",{attrs:{"data-field":"record_no",caption:"Record No.",alignment:"left","sort-order":"desc"}}),a("DxColumn",{attrs:{"data-field":"created_by_name",caption:"Created By",alignment:"left"}}),a("DxColumn",{attrs:{"data-field":"start_date","data-type":"date",format:"dd MMM, yyyy",caption:"Start Date"}}),a("DxColumn",{attrs:{"data-field":"end_date","data-type":"date",format:"dd MMM, yyyy",caption:"End Date"}}),a("DxColumn",{attrs:{"data-field":"total_mile",caption:"Total Mile",alignment:"left"}}),a("DxColumn",{attrs:{caption:"Approval Status",alignment:"center",width:150,"cell-template":"approval-status"}}),a("DxColumn",{attrs:{width:50,caption:"","cell-template":"option-btn-set"}}),a("DxScrolling",{attrs:{mode:"standard"}}),a("DxSearchPanel",{attrs:{visible:!0}}),a("DxPaging",{attrs:{"page-size":10,"page-index":0}}),a("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}})],1)],1),1!=t.currentViewRow?a("div",{staticClass:"page-content page-info border-left"},[a("div",{staticClass:"pm-info-sidebar form",attrs:{id:"info-sidebar"}},[this.currentViewRow.created_by==this.$store.state.user.id_user||"manager"==this.$store.state.user.role?a("approvalBox",{attrs:{status:this.currentViewRow.approve_status},on:{btnRequestApprove:function(e){return t.APPROVE_BTN("req_approve")},btnApprove:function(e){return t.APPROVE_BTN("approve")},btnReject:function(e){return t.APPROVE_BTN("reject")},btnRequestEdit:function(e){return t.APPROVE_BTN("req_edit")},btnResendApprove:function(e){return t.APPROVE_BTN("req_approve")}}}):t._e(),a("p",{staticClass:"pm-section-label"},[t._v("Details")]),a("div",{staticClass:"form-item-container"},[t.currentViewRow.record_no?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Record No:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.currentViewRow.record_no)+" ")])]):t._e(),t.currentViewRow.created_by_name?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Created By:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.currentViewRow.created_by_name)+" ")])]):t._e(),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Start Date:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.start_date)+" ")])]),t.currentViewRow.start_mile?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Start Mile:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.currentViewRow.start_mile)),a("span",[t._v(" km")])])]):t._e(),t.currentViewRow.end_date?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("End Date:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.end_date)+" ")])]):t._e(),t.currentViewRow.end_mile?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("End Mile:")]),a("p",{staticClass:"info"},[t._v(t._s(t.currentViewRow.end_mile)),a("span",[t._v(" km")])])]):t._e(),t.currentViewRow.total_mile?a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Total Mile:")]),a("p",{staticClass:"info"},[t._v(" "+t._s(t.currentViewRow.total_mile)),a("span",[t._v(" km")])])]):t._e()]),a("p",{staticClass:"pm-section-label"},[t._v("Attachments")]),a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("Start Mile Image:")]),a("div",{staticClass:"img-box"},[null!=t.currentViewRow.start_img?a("v-ons-toolbar-button",{staticClass:"btn-preview",on:{click:function(e){return t.PREVIEW_IMG(t.currentViewRow.start_img)}}},[a("i",{staticClass:"las la-expand-arrows-alt"})]):t._e(),t.currentViewRow.start_img?a("img",{attrs:{src:this.baseURL+t.currentViewRow.start_img}}):t._e(),t.currentViewRow.start_img?t._e():a("i",{staticClass:"las la-image"}),t.currentViewRow.start_img?t._e():a("label",[t._v("No Image")])],1)]),a("div",{staticClass:"input-set"},[a("p",{staticClass:"label"},[t._v("End Mile Image:")]),a("div",{staticClass:"img-box"},[null!=t.currentViewRow.end_img?a("v-ons-toolbar-button",{staticClass:"btn-preview",on:{click:function(e){return t.PREVIEW_IMG(t.currentViewRow.end_img)}}},[a("i",{staticClass:"las la-expand-arrows-alt"})]):t._e(),t.currentViewRow.end_img?a("img",{attrs:{src:this.baseURL+t.currentViewRow.end_img}}):t._e(),t.currentViewRow.end_img?t._e():a("i",{staticClass:"las la-image"}),t.currentViewRow.end_img?t._e():a("label",[t._v("No Image")])],1)])]),"staff"==this.$store.state.user.role&&this.currentViewRow.created_by==this.$store.state.user.id_user?a("div",{staticClass:"form-button-container"},[1==this.currentViewRow.approve_status||5==this.currentViewRow.approve_status?a("div",{staticClass:"button-set info-button-set"},[a("v-ons-toolbar-button",{on:{click:function(e){return t.TOGGLE_POPUP("edit")}}},[a("i",{staticClass:"las la-pen"}),a("span",[t._v("Edit")])]),a("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.DELETE_ITEM()}}},[a("i",{staticClass:"las la-trash"}),a("span",[t._v("Delete")])])],1):t._e()]):t._e(),"manager"==this.$store.state.user.role?a("div",{staticClass:"form-button-container"},[a("div",{staticClass:"button-set info-button-set"},[a("v-ons-toolbar-button",{staticClass:"red",on:{click:function(e){return t.DELETE_ITEM()}}},[a("i",{staticClass:"las la-trash"}),a("span",[t._v("Delete")])])],1)]):t._e()],1)]):t._e()]),1==t.isAdd?a("popupAdd",{on:{"btn-cancel-add":function(e){return t.TOGGLE_POPUP("add")},refreshList:function(e){return t.FETCH_LIST()}}}):t._e(),1==t.isEdit?a("popupEdit",{attrs:{editInfo:t.editInfo},on:{"btn-cancel-edit":function(e){return t.TOGGLE_POPUP("edit")},refreshList:function(e){return t.FETCH_LIST()}}}):t._e(),1==t.isLoading?a("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fc9b21"}}):t._e(),t.previewImg?a("previewImage",{attrs:{imageURL:t.previewImg},on:{"close-preview":function(e){return t.PREVIEW_IMG_CLOSE()}}}):t._e()],1)},i=[],r=a(71642),n=a(53706),o=a.n(n),l=a(66262),c=a(17133),d=a.n(c),m=a(48626),u=a(39477),_=a(85981),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[a("div",{staticClass:"popup-header"},[a("label",[t._v("Add New Record")]),a("span",{staticStyle:{"font-size":"14px","padding-right":"20px"}},[t._v(t._s(t.formData.record_no)+" ")])]),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("label",{staticClass:"section-text"},[t._v("Start Mile")]),a("div",{staticClass:"input-set"},[t._m(0),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"Start Date"},model:{value:t.formData.start_date,callback:function(e){t.$set(t.formData,"start_date",e)},expression:"formData.start_date"}})],1),a("div",{staticClass:"input-set"},[t._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.start_mile,expression:"formData.start_mile"}],attrs:{type:"text",placeholder:"Mile Number"},domProps:{value:t.formData.start_mile},on:{input:function(e){e.target.composing||t.$set(t.formData,"start_mile",e.target.value)}}})]),a("div",{staticClass:"input-set"},[t._m(2),a("div",{staticClass:"picture-upload-box"},[this.formData.start_file?a("v-ons-toolbar-button",{staticClass:"btn-delete",on:{click:function(e){return t.PREVIEW_IMG_DELETE("start-img")}}},[a("i",{staticClass:"las la-trash"})]):t._e(),t._m(3),this.formData.start_file?t._e():a("div",{staticClass:"upload-box"},[a("div",{staticClass:"upload-btn-wrapper"},[a("input",{ref:"file_start_img",staticStyle:{display:"none"},attrs:{type:"file",id:"preview_input_img_start"},on:{change:function(e){return t.PREVIEW_IMG_UPLOAD("start-img")}}}),a("v-ons-toolbar-button",[a("label",{attrs:{for:"preview_input_img_start"}},[a("i",{staticClass:"las la-plus"}),t._v("Add Image")])])],1)])],1)])]),a("div",{staticClass:"hr-verticle"}),a("div",{staticClass:"form-item-container"},[a("label",{staticClass:"section-text"},[t._v("End Mile")]),a("div",{staticClass:"input-set"},[t._m(4),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"End Date"},model:{value:t.formData.end_date,callback:function(e){t.$set(t.formData,"end_date",e)},expression:"formData.end_date"}})],1),a("div",{staticClass:"input-set"},[t._m(5),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.end_mile,expression:"formData.end_mile"}],attrs:{type:"text",placeholder:"Mile Number"},domProps:{value:t.formData.end_mile},on:{input:function(e){e.target.composing||t.$set(t.formData,"end_mile",e.target.value)}}})]),a("div",{staticClass:"input-set"},[t._m(6),a("div",{staticClass:"picture-upload-box"},[a("div",{staticClass:"preview-box"},[a("img",{attrs:{id:"preview_img_end",src:"",alt:""}}),this.formData.end_file?a("v-ons-toolbar-button",{staticClass:"btn-delete",on:{click:function(e){return t.PREVIEW_IMG_DELETE("end-img")}}},[a("i",{staticClass:"las la-trash"})]):t._e()],1),this.formData.end_file?t._e():a("div",{staticClass:"upload-box"},[a("div",{staticClass:"upload-btn-wrapper"},[a("input",{ref:"file_end_img",staticStyle:{display:"none"},attrs:{type:"file",id:"preview_input_img_end"},on:{change:function(e){return t.PREVIEW_IMG_UPLOAD("end-img")}}}),a("v-ons-toolbar-button",[a("label",{attrs:{for:"preview_input_img_end"}},[a("i",{staticClass:"las la-plus"}),t._v("Add Image")])])],1)])])])])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Start Date:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Mile Number:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("ODO Image:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"preview-box"},[a("img",{attrs:{id:"preview_img_start",src:"",alt:""}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("End Date:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Mile Number:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("ODO Image:")])])}],v=a(48176),h=a.n(v),g={name:"popup-add-maileage",components:{DxDateBox:h()},data(){return{formData:{},formSelect:{now:new Date}}},created(){let t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user,this.GET_LAST_SEQ_NO()},methods:{GET_LAST_SEQ_NO(){let t="MileRecord";(0,u.Z)({method:"post",url:"/global/last-doc-seq",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{table_name:t}}).then((t=>{if(200==t.status&&t.data){var e=t.data[0].last_doc_seq;this.formData.doc_seq=null==e?1:e+1,this.formData.doc_seq<10&&(this.formData.doc_seq="0"+this.formData.doc_seq.toString()),this.CAL_DOC_NO()}})).catch((t=>{console.log(t)})).finally((()=>{}))},CAL_DOC_NO(){var t,e=d()().month()+1,a=d()().year(),s=e.toString(),i=a.toString();1==s.length&&(s="0"+s),i=i.slice(2,4),t=s.toString()+"-"+i.toString(),this.formData.record_no="AI-MR-"+t+"-"+this.formData.doc_seq.toString()},PREVIEW_IMG_UPLOAD(t){if("start-img"==t){this.formData.start_file=this.$refs.file_start_img.files[0];var e=this.formData.start_file;e&&("image/png"==e.type||"image/jpeg"==e.type?e.size<2e7?document.getElementById("preview_img_start").src=window.URL.createObjectURL(e):(this.$ons.notification.alert("File size too large. (20 MB max)"),this.PREVIEW_IMG_FORM_CLEAR("start-img")):(this.$ons.notification.alert("Incorrect filetype. <br/> Only PNG/JPG/JPEG file can be uploaded."),this.PREVIEW_IMG_FORM_CLEAR("start-img")))}else if("end-img"==t){this.formData.end_file=this.$refs.file_end_img.files[0];var a=this.formData.end_file;a&&("image/png"==a.type||"image/jpeg"==a.type?a.size<2e7?document.getElementById("preview_img_end").src=window.URL.createObjectURL(a):(this.$ons.notification.alert("File size too large. (20 MB max)"),this.PREVIEW_IMG_FORM_CLEAR("start-img")):(this.$ons.notification.alert("Incorrect filetype. <br/> Only PNG/JPG/JPEG file can be uploaded."),this.PREVIEW_IMG_FORM_CLEAR("end-img")))}},PREVIEW_IMG_DELETE(t){"start-img"==t?(this.formData.start_file="",document.getElementById("preview_img_start").src=""):"end-img"==t&&(this.formData.end_file="",document.getElementById("preview_img_end").src="")},PREVIEW_IMG_FORM_CLEAR(t){if("start-img"==t){const t=document.getElementById("preview_input_img_start");t.val="",this.formData.start_file=""}else if("end-img"==t){const t=document.getElementById("preview_input_img_end");this.formData.end_file="",t.val=""}},SAVE(){if(this.formData.start_date)if(this.formData.start_mile){let t=isNaN(this.formData.start_mile);0==t?this.formData.start_file?this.$ons.notification.confirm("Confirm save?").then((t=>{if(1==t){const t=this.formData;console.log(t),(0,u.Z)({method:"post",url:"/mile-record/mile-record-add",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&(this.$ons.notification.alert("Mileage Record Add successful"),this.$emit("btn-cancel-add"),this.$emit("refreshList"))})).catch((t=>{console.log(t)})).finally((()=>{}))}})):this.$ons.notification.alert('"Start Mile Image" field cannot be empty'):this.$ons.notification.alert('"Start Mile Number" should be numberic input only')}else this.$ons.notification.alert('"Start Mile Number" field cannot be empty');else this.$ons.notification.alert('"Start Date" field cannot be empty')},CANCEL(){let t=this.formData;this.formData!=t?this.$ons.notification.confirm("Your unsaved changes will be lost").then((t=>{1==t&&this.$emit("btn-cancel-add")})):this.$emit("btn-cancel-add")}}},b=g,C=a(1001),E=(0,C.Z)(b,p,f,!1,null,"9d1370d0",null),w=E.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[t._m(0),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("label",{staticClass:"section-text"},[t._v("Start Mile")]),a("div",{staticClass:"input-set"},[t._m(1),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"Start Date"},model:{value:t.formData.start_date,callback:function(e){t.$set(t.formData,"start_date",e)},expression:"formData.start_date"}})],1),a("div",{staticClass:"input-set"},[t._m(2),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.start_mile,expression:"formData.start_mile"}],attrs:{type:"text",placeholder:"Mile Number"},domProps:{value:t.formData.start_mile},on:{input:function(e){e.target.composing||t.$set(t.formData,"start_mile",e.target.value)}}})]),a("div",{staticClass:"input-set"},[t._m(3),a("div",{staticClass:"picture-upload-box"},[t._m(4),a("div",{staticClass:"upload-box"},[a("div",{staticClass:"upload-btn-wrapper"},[a("input",{ref:"file_start_img",staticStyle:{display:"none"},attrs:{type:"file",id:"preview_input_img_start"},on:{change:function(e){return t.PREVIEW_IMG_UPLOAD("start-img")}}}),a("v-ons-toolbar-button",[a("label",{attrs:{for:"preview_input_img_start"}},[a("i",{staticClass:"las la-image"}),t._v("Select File")])]),a("v-ons-toolbar-button",{staticClass:"btn-delete",on:{click:function(e){return t.PREVIEW_IMG_DELETE("start-img")}}},[a("i",{staticClass:"las la-trash"})])],1)])])])]),a("div",{staticClass:"hr-verticle"}),a("div",{staticClass:"form-item-container"},[a("label",{staticClass:"section-text"},[t._v("End Mile")]),a("div",{staticClass:"input-set"},[t._m(5),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"End Date"},model:{value:t.formData.end_date,callback:function(e){t.$set(t.formData,"end_date",e)},expression:"formData.end_date"}})],1),a("div",{staticClass:"input-set"},[t._m(6),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.end_mile,expression:"formData.end_mile"}],attrs:{type:"text",placeholder:"Mile Number"},domProps:{value:t.formData.end_mile},on:{input:function(e){e.target.composing||t.$set(t.formData,"end_mile",e.target.value)}}})]),a("div",{staticClass:"input-set"},[t._m(7),a("div",{staticClass:"picture-upload-box"},[t._m(8),a("div",{staticClass:"upload-box"},[a("div",{staticClass:"upload-btn-wrapper"},[a("input",{ref:"file_end_img",staticStyle:{display:"none"},attrs:{type:"file",id:"preview_input_img_end"},on:{change:function(e){return t.PREVIEW_IMG_UPLOAD("end-img")}}}),a("v-ons-toolbar-button",[a("label",{attrs:{for:"preview_input_img_end"}},[a("i",{staticClass:"las la-image"}),t._v("Select File")])]),a("v-ons-toolbar-button",{staticClass:"btn-delete",on:{click:function(e){return t.PREVIEW_IMG_DELETE("end-img")}}},[a("i",{staticClass:"las la-trash"})])],1)])])])])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},R=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-header"},[a("label",[t._v("Edit Record")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Start Date:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Mile Number:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("ODO Image:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"preview-box"},[a("img",{attrs:{id:"preview_img_start",src:"",alt:""}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("End Date:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Mile Number:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("ODO Image:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"preview-box"},[a("img",{attrs:{id:"preview_img_end",src:"",alt:""}})])}],I=a(89584),x={name:"popup-edit-mileage",components:{DxDateBox:h()},props:{editInfo:Object},data(){return{formData:{},formSelect:{now:new Date}}},computed:{baseURL(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},created(){this.formData=(0,I.Z)(this.editInfo);let t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user,this.formData.doc_seq=parseInt(this.formData.doc_seq)},mounted(){null!=this.formData.start_img&&(document.getElementById("preview_img_start").src=this.baseURL+this.formData.start_img),null!=this.formData.end_img&&(document.getElementById("preview_img_end").src=this.baseURL+this.formData.end_img)},methods:{PREVIEW_IMG_UPLOAD(t){if("start-img"==t){this.formData.start_file=this.$refs.file_start_img.files[0];var e=this.formData.start_file;e&&("image/png"==e.type||"image/jpeg"==e.type?e.size<2e7?document.getElementById("preview_img_start").src=window.URL.createObjectURL(e):(this.$ons.notification.alert("File size too large. (20 MB max)"),this.PREVIEW_IMG_FORM_CLEAR("start-img")):(this.$ons.notification.alert("Incorrect filetype. <br/> Only PNG/JPG/JPEG file can be uploaded."),this.PREVIEW_IMG_FORM_CLEAR("start-img")))}else if("end-img"==t){this.formData.end_file=this.$refs.file_end_img.files[0];var a=this.formData.end_file;a&&("image/png"==a.type||"image/jpeg"==a.type?a.size<2e7?document.getElementById("preview_img_end").src=window.URL.createObjectURL(a):(this.$ons.notification.alert("File size too large. (20 MB max)"),this.PREVIEW_IMG_FORM_CLEAR("start-img")):(this.$ons.notification.alert("Incorrect filetype. <br/> Only PNG/JPG/JPEG file can be uploaded."),this.PREVIEW_IMG_FORM_CLEAR("end-img")))}},PREVIEW_IMG_DELETE(t){"start-img"==t?(this.formData.start_file="",document.getElementById("preview_img_start").src=""):"end-img"==t&&(this.formData.end_file="",document.getElementById("preview_img_end").src="")},PREVIEW_IMG_FORM_CLEAR(t){if("start-img"==t){const t=document.getElementById("preview_input_img_start");t.val="",this.formData.start_file=""}else if("end-img"==t){const t=document.getElementById("preview_input_img_end");this.formData.end_file="",t.val=""}},SAVE(){if(this.formData.start_date)if(this.formData.start_mile){let t=isNaN(this.formData.start_mile);0==t?this.formData.start_file||this.formData.start_img?this.$ons.notification.confirm("Confirm save?").then((t=>{if(1==t){this.formData.start_file&&(this.formData.start_img=null),this.formData.end_file&&(this.formData.end_img=null);const t=this.formData;console.log(t),(0,u.Z)({method:"put",url:"/mile-record/mile-record-edit",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&(this.$ons.notification.alert("Edit Mileage Record successful"),this.$emit("btn-cancel-edit"),this.$emit("refreshList"))})).catch((t=>{console.log(t)})).finally((()=>{}))}})):this.$ons.notification.alert('"Start Mile Image" field cannot be empty'):this.$ons.notification.alert('"Start Mile Number" should be numberic input only')}else this.$ons.notification.alert('"Start Mile Number" field cannot be empty');else this.$ons.notification.alert('"Start Date" field cannot be empty')},CANCEL(){let t=this.formData;this.formData!=t?this.$ons.notification.confirm("Your unsaved changes will be lost").then((t=>{1==t&&this.$emit("btn-cancel-edit")})):this.$emit("btn-cancel-edit")}}},y=x,L=(0,C.Z)(y,D,R,!1,null,"088b348b",null),P=L.exports,S=a(49075),M=a(72421),$=a(96125),V={name:"ViewMileageList",components:{toolbar:_.Z,DxDataGrid:m.DxDataGrid,DxSearchPanel:m.DxSearchPanel,DxPaging:m.DxPaging,DxPager:m.DxPager,DxScrolling:m.DxScrolling,DxColumn:m.DxColumn,previewImage:M.Z,contentLoading:S.Z,popupAdd:w,popupEdit:P,approvalBox:$.Z},created(){this.$store.commit("UPDATE_CURRENT_INAPP",{name:"Mileage Record",icon:"/img/icon_menu/record/mileage.png"}),this.FETCH_LIST()},data(){return{isAdd:!1,isEdit:!1,isLoading:!1,currentViewRow:1,errorMessage:"",editInfo:"",previewImg:"",MileageList:""}},computed:{start_date(){return this.currentViewRow.start_date?d()(this.currentViewRow.start_date).format("LL"):""},end_date(){return this.currentViewRow.end_date?d()(this.currentViewRow.end_date).format("LL"):""},baseURL(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{EXPORT_DATA(t){const e=new r.Workbook,a=e.addWorksheet("Clients");(0,l.d)({worksheet:a,component:t.component}).then((function(){e.xlsx.writeBuffer().then((function(t){o()(new Blob([t],{type:"application/octet-stream"}),"Clients.xlsx")}))})),t.cancel=!0},VIEW_INFO(t){t.data&&(this.currentViewRow=t.data,this.SCROLL_TOP_INFO())},CLEAR_VIEW_INFO(){this.currentViewRow=""},TOGGLE_POPUP(t){"add"==t?1==this.isAdd?this.isAdd=!1:this.isAdd=!0:"edit"==t&&(1==this.isEdit?this.isEdit=!1:(this.editInfo=(0,I.Z)(this.currentViewRow),this.isEdit=!0))},FETCH_LIST(){this.currentViewRow=1,this.isLoading=!0,(0,u.Z)({method:"get",url:"/mile-record/mile-record-list",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((t=>{t.data&&(this.MileageList=t.data,this.MileageList.length>0&&(this.currentViewRow=this.MileageList[this.MileageList.length-1]))})).catch((t=>{console.log(t)})).finally((()=>{this.isLoading=!1}))},DELETE_ITEM(){this.$ons.notification.confirm("Confirm delete?").then((t=>{1==t&&(0,u.Z)({method:"delete",url:"/mile-record/mile-record-delete",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_mile:this.currentViewRow.id_mile}}).then((t=>{console.log(t),200==t.status&&(this.$ons.notification.alert("Delete successful"),this.FETCH_LIST())})).catch((t=>{console.log(t)})).finally((()=>{}))}))},SCROLL_TOP_INFO(){document.getElementById("info-sidebar").scroll({top:0,behavior:"smooth"})},PREVIEW_IMG(t){t&&(this.previewImg=t)},PREVIEW_IMG_CLOSE(){this.previewImg=""},APPROVE_BTN(t){var e=JSON.parse(localStorage.getItem("user")),a="N/A",s={id_mile:this.currentViewRow.id_mile,approve_status:0,id_user:e.id_user};"req_approve"==t?(s.approve_status=2,a="Confirm Send Approve Request?"):"approve"==t?(s.approve_status=3,a="Confirm Send Approve Feedback?"):"reject"==t?(s.approve_status=4,a="Confirm Send Reject Feedback?"):"req_edit"==t&&(s.approve_status=5,a="Confirm Send Request Edit Feedback?"),this.$ons.notification.confirm(a).then((t=>{1==t&&(0,u.Z)({method:"put",url:"/mile-record/mile-record-status",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:s}).then((t=>{console.log(t),200==t.status&&(this.$ons.notification.alert("Approval Status Sent"),this.FETCH_LIST())})).catch((t=>{console.log(t)})).finally((()=>{}))}))}}},O=V,A=(0,C.Z)(O,s,i,!1,null,"5fac2f50",null),N=A.exports},89584:function(t,e,a){a.d(e,{Z:function(){return s}});var s=i;function i(t){let e=t;var a={}.toString.call(t).slice(8,-1);if("Set"==a)return new Set([...t].map((t=>i(t))));if("Map"==a)return new Map([...t].map((t=>[i(t[0]),i(t[1])])));if("Date"==a)return new Date(t.getTime());if("RegExp"==a)return RegExp(t.source,r(t));if("Array"==a||"Object"==a)for(var s in e=Array.isArray(t)?[]:{},t)e[s]=i(t[s]);return e}function r(t){if("string"==typeof t.source.flags)return t.source.flags;var e=[];return t.global&&e.push("g"),t.ignoreCase&&e.push("i"),t.multiline&&e.push("m"),t.sticky&&e.push("y"),t.unicode&&e.push("u"),e.join("")}}}]);
//# sourceMappingURL=60.9eed7248.js.map