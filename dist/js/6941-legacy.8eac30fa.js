"use strict";(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[6941],{76941:function(t,e,a){a.r(e),a.d(e,{default:function(){return L}});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pm-page"},[a("div",{staticClass:"pm-toolbar"},[a("toolbar",{attrs:{pageName:"Weekly Report",isNewBtn:!0,newBtnLabel:"New Report"},on:{refreshInfo:function(e){return t.FETCH_LIST()},newBtnFn:function(e){return t.TOGGLE_POPUP("add")}}})],1),a("div",{staticClass:"pm-page-container"},[a("div",{staticClass:"page-content page-list"},[a("DxDataGrid",{attrs:{id:"project-manager-project-list","data-source":t.dataList,selection:{mode:"single"},"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!1,"row-alternation-enabled":!0},on:{exporting:t.EXPORT_DATA},scopedSlots:t._u([{key:"cell-button-set",fn:function(e){var n=e.data;return[a("div",{staticClass:"table-btn-group"},[a("div",{staticClass:"table-btn",on:{click:function(e){return t.VIEW_INFO(n)}}},[a("i",{staticClass:"las la-search blue"})])])]}}])},[a("DxColumn",{attrs:{"data-field":"record_no",width:150,caption:"Record No.","sort-order":"desc"}}),a("DxColumn",{attrs:{"data-field":"start_date","data-type":"date",format:"dd MMM, yyyy",caption:"Start Date"}}),a("DxColumn",{attrs:{"data-field":"end_date","data-type":"date",format:"dd MMM, yyyy",caption:"End Date"}}),a("DxColumn",{attrs:{"data-field":"week_no",caption:"Week No.",width:100,alignment:"left"}}),a("DxColumn",{attrs:{"data-field":"created_by_name",width:220,caption:"Created By"}}),a("DxColumn",{attrs:{"data-field":"created_time","data-type":"date",format:"dd MMM, yyyy",caption:"Created Date",width:150}}),a("DxColumn",{attrs:{width:50,caption:"","cell-template":"cell-button-set"}}),a("DxScrolling",{attrs:{mode:"standard"}}),a("DxSearchPanel",{attrs:{visible:!0}}),a("DxPaging",{attrs:{"page-size":10,"page-index":0}}),a("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),a("DxExport",{attrs:{enabled:!0}})],1)],1)]),1==t.isAdd?a("popupAdd",{on:{"btn-cancel-add":function(e){return t.TOGGLE_POPUP("add")},refreshInfo:function(e){return t.FETCH_LIST()}}}):t._e(),1==t.isLoading?a("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fc9b21"}}):t._e()],1)},o=[],i=(a(41539),a(71642)),s=a(53706),r=a.n(s),l=a(66262),c=a(48626),d=a(49075),u=a(85981),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[t._m(0),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[t._m(1),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"Start Date"},model:{value:t.formData.start_date,callback:function(e){t.$set(t.formData,"start_date",e)},expression:"formData.start_date"}})],1),a("div",{staticClass:"input-set"},[t._m(2),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"End Date"},model:{value:t.formData.end_date,callback:function(e){t.$set(t.formData,"end_date",e)},expression:"formData.end_date"}})],1)])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},p=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-header"},[a("label",[t._v("Add New Record")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Start Date:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("End Date:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])}],m=(a(39714),a(47042),a(78783),a(33948),a(60285),a(41637),a(39477)),_=a(48176),h=a.n(_),D=a(17133),g=a.n(D),E={name:"popup-add-weekly-report",components:{DxDateBox:h()},data:function(){return{formData:{id_user:"",record_no:"",doc_seq:""},formSelect:{now:new Date}}},created:function(){var t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user,this.GET_LAST_SEQ_NO()},methods:{GET_LAST_SEQ_NO:function(){var t=this,e="WeeklyReport";(0,m.Z)({method:"post",url:"/global/last-doc-seq",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{table_name:e}}).then((function(e){if(console.log(e),200==e.status&&e.data){var a=e.data[0].last_doc_seq;t.formData.doc_seq=null==a?1:a+1,t.formData.doc_seq<10&&(t.formData.doc_seq="0"+t.formData.doc_seq.toString()),t.CAL_DOC_NO()}})).catch((function(t){console.log(t)})).finally((function(){}))},CAL_DOC_NO:function(){var t,e=g()().month()+1,a=g()().year(),n=e.toString(),o=a.toString();1==n.length&&(n="0"+n),o=o.slice(2,4),t=n.toString()+"-"+o.toString(),this.formData.record_no="AI-WSR-"+t+"-"+this.formData.doc_seq.toString()},PREVIEW_IMG_UPLOAD:function(){this.formData.file=this.$refs.file_img.files[0];var t=this.formData.file;t&&("image/png"==t.type||"image/jpeg"==t.type?t.size<2e7?document.getElementById("preview_img").src=window.URL.createObjectURL(t):(this.$ons.notification.alert("File size too large. (20 MB max)"),this.PREVIEW_IMG_FORM_CLEAR()):(this.$ons.notification.alert("Incorrect filetype. <br/> Only PNG/JPG/JPEG file can be uploaded."),this.PREVIEW_IMG_FORM_CLEAR()))},PREVIEW_IMG_DELETE:function(){this.formData.file="",document.getElementById("preview_img").src=""},PREVIEW_IMG_FORM_CLEAR:function(){var t=document.getElementById("preview_input_img");t.val="",this.formData.file=""},SAVE:function(){var t=this;this.formData.start_date?this.formData.end_date?this.$ons.notification.confirm("Confirm save?").then((function(e){if(1==e){var a=t.formData;(0,m.Z)({method:"post",url:"/weekly-report/weekly-report-add",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:a}).then((function(e){200==e.status&&(t.$ons.notification.alert("Add successful"),t.$emit("refreshInfo"),t.$emit("btn-cancel-add"))})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){}))}})):this.$ons.notification.alert('"End Date" field cannot be empty'):this.$ons.notification.alert('"Start Date" field cannot be empty')},CANCEL:function(){var t=this,e=this.formData;this.formData!=e?this.$ons.notification.confirm("Your unsaved changes will be lost").then((function(e){1==e&&t.$emit("btn-cancel-add")})):this.$emit("btn-cancel-add")}}},v=E,C=a(1001),w=(0,C.Z)(v,f,p,!1,null,"15ad7265",null),x=w.exports,b=a(89584),y={name:"ViewWeeklyReport",components:{toolbar:u.Z,DxDataGrid:c.DxDataGrid,DxSearchPanel:c.DxSearchPanel,DxPaging:c.DxPaging,DxPager:c.DxPager,DxScrolling:c.DxScrolling,DxColumn:c.DxColumn,DxExport:c.DxExport,contentLoading:d.Z,popupAdd:x},created:function(){this.$store.commit("UPDATE_CURRENT_INAPP",{name:"Weekly Report",icon:"/img/icon_menu/executive_management/weekly.png"}),1==this.$store.state.status.server&&this.FETCH_LIST()},computed:{report_date:function(){return g()(this.currentViewRow.report_date).format("dddd, LL")}},data:function(){return{isAdd:!1,isEdit:!1,isLoading:!1,currentViewRow:1,dataList:[{}]}},methods:{VIEW_INFO:function(t){var e=t.data.id_weekly;null!=e&&this.$router.push("/executive-management/weekly-report/"+e)},EXPORT_DATA:function(t){var e=new i.Workbook,a=e.addWorksheet("Projects");(0,l.d)({worksheet:a,component:t.component}).then((function(){e.xlsx.writeBuffer().then((function(t){r()(new Blob([t],{type:"application/octet-stream"}),"Projects.xlsx")}))})),t.cancel=!0},TOGGLE_POPUP:function(t){"add"==t?1==this.isAdd?this.isAdd=!1:this.isAdd=!0:"edit"==t&&(1==this.isEdit?this.isEdit=!1:(this.editInfo=(0,b.Z)(this.currentViewRow),this.isEdit=!0))},DELETE_ITEM:function(){},FETCH_LIST:function(){var t=this;this.isLoading=!0,(0,m.Z)({method:"get",url:"/weekly-report/weekly-report-list",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){200==e.status&&e.data&&(t.dataList=e.data)})).catch((function(e){t.$ons.notification.alert(e.code+" "+e.response.status+" "+e.message)})).finally((function(){t.isLoading=!1}))}}},S=y,P=(0,C.Z)(S,n,o,!1,null,"28d8ac11",null),L=P.exports}}]);
//# sourceMappingURL=6941-legacy.8eac30fa.js.map