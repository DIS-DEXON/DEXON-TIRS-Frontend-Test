"use strict";(self["webpackChunkai_portal"]=self["webpackChunkai_portal"]||[]).push([[766],{72421:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"image-preview-wrapper"},[a("div",{staticClass:"preview-popup"},[a("v-ons-toolbar-button",{staticClass:"btn-close",on:{click:function(e){return t.CLOSE_PREVIEW()}}},[a("i",{staticClass:"las la-times"})]),a("v-ons-toolbar-button",{staticClass:"btn-close download"},[a("a",{attrs:{target:"_blank",href:t.baseURL+t.imageURL,download:""}},[a("i",{staticClass:"las la-download"})])]),a("img",{attrs:{src:t.baseURL+t.imageURL}})],1)])},i=[],o={name:"image-preview",props:{imageURL:String},computed:{baseURL(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{DOWNLOAD_IMG(t){const e=document.createElement("a");e.href=t,e.download=t.split("/").pop(),document.body.appendChild(e),e.click(),document.body.removeChild(e)},CLOSE_PREVIEW(){this.$emit("close-preview")}}},r=o,n=a(1001),l=(0,n.Z)(r,s,i,!1,null,"1c402f72",null),c=l.exports},31323:function(t,e,a){a.d(e,{Z:function(){return m}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[t._m(0),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[t._m(1),a("p",{staticClass:"info"},[t._v(" "+t._s(t.formData.record_no)+" ")])]),a("div",{staticClass:"input-set"},[t._m(2),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"Bill Date"},model:{value:t.formData.bill_date,callback:function(e){t.$set(t.formData,"bill_date",e)},expression:"formData.bill_date"}})],1),a("div",{staticClass:"input-set"},[t._m(3),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.price,expression:"formData.price"}],attrs:{type:"text",placeholder:"Price"},domProps:{value:t.formData.price},on:{input:function(e){e.target.composing||t.$set(t.formData,"price",e.target.value)}}})])]),a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[t._m(4),a("div",{staticClass:"picture-upload-box"},[t._m(5),a("div",{staticClass:"upload-box"},[a("div",{staticClass:"upload-btn-wrapper"},[a("input",{ref:"file_img",staticStyle:{display:"none"},attrs:{type:"file",id:"preview_input_img"},on:{change:function(e){return t.PREVIEW_IMG_UPLOAD()}}}),a("v-ons-toolbar-button",[a("label",{attrs:{for:"preview_input_img"}},[a("i",{staticClass:"las la-image"}),t._v("Select File")])]),a("v-ons-toolbar-button",{staticClass:"btn-delete",on:{click:function(e){return t.PREVIEW_IMG_DELETE()}}},[a("i",{staticClass:"las la-trash"})])],1)])])])])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-header"},[a("label",[t._v("Edit Record")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Record No:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Bill Date:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Price:")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Receipt Image:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"preview-box"},[a("img",{attrs:{id:"preview_img",src:"",alt:""}})])}],o=a(39477),r=a(89584),n=a(48176),l=a.n(n),c={name:"popup-edit-gasbill",components:{DxDateBox:l()},props:{editInfo:Object},data(){return{formData:{},formSelect:{now:new Date}}},computed:{baseURL(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},created(){this.formData=(0,r.Z)(this.editInfo);let t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user,this.formData.doc_seq=parseInt(this.formData.doc_seq)},mounted(){null!=this.formData.receipt_img&&(document.getElementById("preview_img").src=this.baseURL+this.formData.receipt_img)},methods:{PREVIEW_IMG_UPLOAD(){this.formData.file=this.$refs.file_img.files[0];var t=this.formData.file;t&&("image/png"==t.type||"image/jpeg"==t.type?t.size<2e7?document.getElementById("preview_img").src=window.URL.createObjectURL(t):(this.$ons.notification.alert("File size too large. (20 MB max)"),this.PREVIEW_IMG_FORM_CLEAR()):(this.$ons.notification.alert("Incorrect filetype. <br/> Only PNG/JPG/JPEG file can be uploaded."),this.PREVIEW_IMG_FORM_CLEAR()))},PREVIEW_IMG_DELETE(){this.formData.file=null,this.formData.receipt_img=null,document.getElementById("preview_img").src=""},PREVIEW_IMG_FORM_CLEAR(){const t=document.getElementById("preview_input_img");t.val="",this.formData.file=null},SAVE(){this.formData.bill_date?this.formData.price?this.$ons.notification.confirm("Confirm save?").then((t=>{if(1==t){const t=this.formData;(0,o.Z)({method:"put",url:"/fuel-bill/fuel-bill-edit",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&(this.$ons.notification.alert("Bill Record Edit successful"),this.$emit("btn-cancel-edit"),this.$emit("refreshList"))})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{}))}})):this.$ons.notification.alert('"Price" field cannot be empty'):this.$ons.notification.alert('"Bill Date" field cannot be empty')},CANCEL(){let t=this.formData;this.formData!=t?this.$ons.notification.confirm("Your unsaved changes will be lost").then((t=>{1==t&&this.$emit("btn-cancel-edit")})):this.$emit("btn-cancel-edit")}}},d=c,u=a(1001),p=(0,u.Z)(d,s,i,!1,null,"787961ae",null),m=p.exports},78766:function(t,e,a){a.r(e),a.d(e,{default:function(){return $}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pm-page"},[a("div",{staticClass:"pm-toolbar"},[a("toolbar",{attrs:{pageName:"Travel Record",isNewBtn:!0,newBtnLabel:"New Travel Record"},on:{refreshInfo:function(e){return t.FETCH_LIST()},newBtnFn:function(e){return t.TOGGLE_POPUP("add")}}})],1),a("div",{staticClass:"pm-page-container"},[a("div",{staticClass:"page-content page-list"},[a("DxDataGrid",{attrs:{id:"contact-client-list","data-source":t.TravelList,selection:{mode:"single"},"hover-state-enabled":!0,"allow-column-reordering":!1,"show-borders":!0,"show-row-lines":!1,"row-alternation-enabled":!0},on:{exporting:t.EXPORT_DATA},scopedSlots:t._u([{key:"approval-status",fn:function(e){var s=e.data;return[a("div",{staticClass:"approval-incolumn"},[1==s.data.approve_status?a("div",{staticClass:"blue"},[a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),2==s.data.approve_status?a("div",{staticClass:"orange"},[a("i",{staticClass:"las la-clock"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),3==s.data.approve_status?a("div",{staticClass:"green"},[a("i",{staticClass:"las la-check-double"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),4==s.data.approve_status?a("div",{staticClass:"red"},[a("i",{staticClass:"las la-times"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e(),5==s.data.approve_status?a("div",{staticClass:"red"},[a("i",{staticClass:"las la-pen"}),a("span",[t._v(t._s(s.data.status_desc))])]):t._e()])]}},{key:"option-btn-set",fn:function(e){var s=e.data;return[a("div",{staticClass:"table-btn-group"},[a("div",{staticClass:"table-btn",on:{click:function(e){return t.VIEW_INFO(s)}}},[a("i",{staticClass:"las la-search blue"})])])]}}])},[a("DxColumn",{attrs:{"data-field":"record_no",caption:"Record No.","sort-order":"desc"}}),a("DxColumn",{attrs:{"data-field":"date","data-type":"date",format:"dd MMM, yyyy",caption:"Travel Date"}}),a("DxColumn",{attrs:{"data-field":"created_by_name",caption:"Created By"}}),a("DxColumn",{attrs:{"data-field":"created_time","data-type":"date",format:"dd MMM, yyyy",caption:"Created Date"}}),a("DxColumn",{attrs:{caption:"Approval Status",alignment:"center",width:150,"cell-template":"approval-status"}}),a("DxColumn",{attrs:{width:50,caption:"","cell-template":"option-btn-set"}}),a("DxScrolling",{attrs:{mode:"standard"}}),a("DxSearchPanel",{attrs:{visible:!0}}),a("DxPaging",{attrs:{"page-size":10,"page-index":0}}),a("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}})],1)],1)]),1==t.isAdd?a("popupAdd",{on:{"btn-cancel-add":function(e){return t.TOGGLE_POPUP("add")},refreshList:function(e){return t.FETCH_LIST()}}}):t._e(),1==t.isEdit?a("popupEdit",{attrs:{editInfo:t.editInfo},on:{"btn-cancel-edit":function(e){return t.TOGGLE_POPUP("edit")},refreshList:function(e){return t.FETCH_LIST()}}}):t._e(),1==t.isLoading?a("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fc9b21"}}):t._e(),t.previewImg?a("previewImage",{attrs:{imageURL:t.previewImg},on:{"close-preview":function(e){return t.PREVIEW_IMG_CLOSE()}}}):t._e()],1)},i=[],o=a(66262),r=a(48626),n=a(39477),l=a(53706),c=a.n(l),d=a(71642),u=a(17133),p=a.n(u),m=a(85981),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"popup-wrapper"},[a("div",{staticClass:"popup-card"},[a("div",{staticClass:"popup-header"},[a("label",[t._v("Add New Record")]),a("span",{staticStyle:{"font-size":"14px","padding-right":"20px"}},[t._v(t._s(t.formData.record_no)+" ")])]),a("div",{staticClass:"popup-content form"},[a("div",{staticClass:"form-item-container"},[a("div",{staticClass:"input-set"},[t._m(0),a("DxDateBox",{attrs:{value:t.formSelect.now,type:"date",placeholder:"Select Date"},model:{value:t.formData.bill_date,callback:function(e){t.$set(t.formData,"bill_date",e)},expression:"formData.bill_date"}})],1),a("div",{staticClass:"input-set",staticStyle:{"margin-top":"10px"}},[t._m(1),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.note,expression:"formData.note"}],staticStyle:{height:"80px","max-height":"200px"},attrs:{placeholder:"Note"},domProps:{value:t.formData.note},on:{input:function(e){e.target.composing||t.$set(t.formData,"note",e.target.value)}}})])])]),a("div",{staticClass:"popup-footer"},[a("div",{staticClass:"button-set"},[a("button",{staticClass:"blue",on:{click:function(e){return t.SAVE()}}},[a("label",[t._v("Save")])]),a("button",{staticClass:"grey",on:{click:function(e){return t.CANCEL()}}},[a("label",[t._v("Cancel")])])])])])])},_=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Create Record for(Date):")]),a("span",{staticClass:"star-label"},[a("i",{staticClass:"las la-asterisk"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label-box"},[a("p",{staticClass:"label"},[t._v("Notes:")])])}],h=a(48176),v=a.n(h),g={name:"popup-add-travel",components:{DxDateBox:v()},data(){return{formData:{id_user:"",record_no:"",bill_date:"",price:"",doc_seq:"",file:""},formSelect:{now:new Date}}},created(){let t=JSON.parse(localStorage.getItem("user"));this.formData.id_user=t.id_user,this.GET_LAST_SEQ_NO()},methods:{GET_LAST_SEQ_NO(){let t="TravelRecord";(0,n.Z)({method:"post",url:"/global/last-doc-seq",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{table_name:t}}).then((t=>{if(200==t.status&&t.data){var e=t.data[0].last_doc_seq;this.formData.doc_seq=null==e?1:e+1,this.formData.doc_seq<10&&(this.formData.doc_seq="0"+this.formData.doc_seq.toString()),this.CAL_DOC_NO()}})).catch((t=>{console.log(t)})).finally((()=>{}))},CAL_DOC_NO(){var t,e=p()().month()+1,a=p()().year(),s=e.toString(),i=a.toString();1==s.length&&(s="0"+s),i=i.slice(2,4),t=s.toString()+"-"+i.toString(),this.formData.record_no="AI-TRR-"+t+"-"+this.formData.doc_seq.toString()},SAVE(){this.formData.bill_date?this.formData.price?this.$ons.notification.confirm("Confirm save?").then((t=>{if(1==t){const t=this.formData;(0,n.Z)({method:"post",url:"/fuel-bill/fuel-bill-add",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t}).then((t=>{200==t.status&&(this.$ons.notification.alert("Bill Record Add successful"),this.$emit("btn-cancel-add"),this.$emit("refreshList"))})).catch((t=>{this.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)})).finally((()=>{}))}})):this.$ons.notification.alert('"Price" field cannot be empty'):this.$ons.notification.alert('"Bill Date" field cannot be empty')},CANCEL(){let t=this.formData;this.formData!=t?this.$ons.notification.confirm("Your unsaved changes will be lost").then((t=>{1==t&&this.$emit("btn-cancel-add")})):this.$emit("btn-cancel-add")}}},b=g,C=a(1001),D=(0,C.Z)(b,f,_,!1,null,"09b91afc",null),E=D.exports,w=a(31323),S=a(49075),L=a(89584),R=a(72421),I={name:"ViewTravelRcord",components:{toolbar:m.Z,DxDataGrid:r.DxDataGrid,DxSearchPanel:r.DxSearchPanel,DxPaging:r.DxPaging,DxPager:r.DxPager,DxScrolling:r.DxScrolling,DxColumn:r.DxColumn,previewImage:R.Z,contentLoading:S.Z,popupAdd:E,popupEdit:w.Z},created(){this.$store.commit("UPDATE_CURRENT_INAPP",{name:"Travel Record",icon:"/img/icon_menu/record/travel.png"}),this.FETCH_LIST()},data(){return{isAdd:!1,isEdit:!1,isLoading:!1,currentViewRow:1,errorMessage:"",editInfo:"",previewImg:"",TravelList:[]}},computed:{gas_bill_date(){return p()(this.currentViewRow.bill_date).format("LL")},baseURL(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{EXPORT_DATA(t){const e=new d.Workbook,a=e.addWorksheet("Clients");(0,o.d)({worksheet:a,component:t.component}).then((function(){e.xlsx.writeBuffer().then((function(t){c()(new Blob([t],{type:"application/octet-stream"}),"Clients.xlsx")}))})),t.cancel=!0},VIEW_INFO(t){const e=t.data.id_travel;null!=e&&this.$router.push("/record/travel/"+e)},DELETE_ITEM(){this.$ons.notification.confirm("Confirm delete?").then((t=>{1==t&&(0,n.Z)({method:"delete",url:"/fuel-bill/fuel-bill-delete",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_fuel_bill:this.currentViewRow.id_fuel_bill}}).then((t=>{console.log(t),200==t.status&&(this.$ons.notification.alert("Delete successful"),this.FETCH_LIST())})).catch((t=>{console.log(t)})).finally((()=>{}))}))},CLEAR_VIEW_INFO(){this.currentViewRow=""},TOGGLE_POPUP(t){"add"==t?1==this.isAdd?this.isAdd=!1:this.isAdd=!0:"edit"==t&&(1==this.isEdit?this.isEdit=!1:(this.editInfo=(0,L.Z)(this.currentViewRow),this.isEdit=!0))},FETCH_LIST(){this.currentViewRow,this.isLoading=!0,(0,n.Z)({method:"get",url:"/travel-record/travel-record-list",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((t=>{t.data&&(this.TravelList=t.data,this.TravelList.length>0&&(this.currentViewRow=this.TravelList[this.TravelList.length-1]))})).catch((t=>{console.log(t)})).finally((()=>{this.isLoading=!1}))},SCROLL_TOP_INFO(){""!=this.currentViewRow&&document.getElementById("info-sidebar").scroll({top:0,behavior:"smooth"})},PREVIEW_IMG(t){t&&(this.previewImg=t)},PREVIEW_IMG_CLOSE(){this.previewImg=""},APPROVE_BTN(t){var e=JSON.parse(localStorage.getItem("user")),a="N/A",s={id_fuel_bill:this.currentViewRow.id_fuel_bill,approve_status:0,id_user:e.id_user};"req_approve"==t?(s.approve_status=2,a="Confirm Send Approve Request?"):"approve"==t?(s.approve_status=3,a="Confirm Send Approve Feedback?"):"reject"==t?(s.approve_status=4,a="Confirm Send Reject Feedback?"):"req_edit"==t&&(s.approve_status=5,a="Confirm Send Request Edit Feedback?"),this.$ons.notification.confirm(a).then((t=>{1==t&&(0,n.Z)({method:"put",url:"/fuel-bill/fuel-bill-status",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:s}).then((t=>{console.log(t),200==t.status&&(this.$ons.notification.alert("Approval Status Sent"),this.FETCH_LIST())})).catch((t=>{console.log(t)})).finally((()=>{}))}))}}},x=I,y=(0,C.Z)(x,s,i,!1,null,"ff45c4b8",null),$=y.exports},89584:function(t,e,a){a.d(e,{Z:function(){return s}});var s=i;function i(t){let e=t;var a={}.toString.call(t).slice(8,-1);if("Set"==a)return new Set([...t].map((t=>i(t))));if("Map"==a)return new Map([...t].map((t=>[i(t[0]),i(t[1])])));if("Date"==a)return new Date(t.getTime());if("RegExp"==a)return RegExp(t.source,o(t));if("Array"==a||"Object"==a)for(var s in e=Array.isArray(t)?[]:{},t)e[s]=i(t[s]);return e}function o(t){if("string"==typeof t.source.flags)return t.source.flags;var e=[];return t.global&&e.push("g"),t.ignoreCase&&e.push("i"),t.multiline&&e.push("m"),t.sticky&&e.push("y"),t.unicode&&e.push("u"),e.join("")}}}]);
//# sourceMappingURL=766.36cc615f.js.map