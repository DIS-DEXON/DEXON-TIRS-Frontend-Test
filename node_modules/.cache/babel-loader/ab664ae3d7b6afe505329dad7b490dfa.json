{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport toolbar from \"@/components/app-structures/app-toolbar.vue\";\nimport popupSign from \"@/views/Applications/Record/Visiting/visiting-signature-add.vue\";\nimport popupEdit from \"@/views/Applications/Record/Visiting/visiting-edit.vue\";\nimport contentLoading from \"@/components/app-structures/app-content-loading.vue\";\nimport axios from \"/axios.js\";\nimport moment from \"moment\";\nimport { jsPDF } from \"jspdf\";\nexport default {\n  name: \"ViewVisitingInfo\",\n  components: {\n    toolbar: toolbar,\n    popupEdit: popupEdit,\n    popupSign: popupSign,\n    contentLoading: contentLoading\n  },\n  created: function created() {\n    if (this.$store.state.status.server == true) this.FETCH_INFO();\n  },\n  data: function data() {\n    return {\n      isLoading: false,\n      isEdit: false,\n      isSign: false,\n      currentSigner: \"\",\n      sign_status: true,\n      info: \"\",\n      popupTitle: \"\"\n    };\n  },\n  methods: {\n    TOGGLE_POPUP_SIGN: function TOGGLE_POPUP_SIGN(opt) {\n      if (this.isSign == true) this.isSign = false;\n\n      if (opt == \"dexon\") {\n        this.popupTitle = \"Dexon Signature\";\n        this.currentSigner = \"dexon\";\n        this.isSign = true;\n      } else if (opt == \"client\") {\n        this.popupTitle = \"Client Signature\";\n        this.currentSigner = \"client\";\n        this.isSign = true;\n      }\n    },\n    FETCH_INFO: function FETCH_INFO() {\n      var _this = this;\n\n      this.isLoading = true;\n      setTimeout(function () {\n        var id_visit = _this.$route.params;\n\n        if (id_visit) {\n          axios({\n            method: \"post\",\n            url: \"/visit-record/visit-record-info\",\n            headers: {\n              Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n            },\n            data: id_visit\n          }).then(function (res) {\n            // console.log(res);\n            if (res.status == 200 && res.data[0]) {\n              _this.info = res.data[0];\n\n              if (_this.info.sign_dacon_signed == true || _this.info.sign_client_signed == true) {\n                _this.sign_status = false;\n              }\n            } else {\n              _this.$ons.notification.alert(\"Record information not found\");\n            }\n          }).catch(function (error) {\n            _this.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n          }).finally(function () {\n            _this.isLoading = false;\n          });\n        }\n      }, 500);\n    },\n    DELETE_PROJECT: function DELETE_PROJECT() {\n      var _this2 = this;\n\n      var id_visit = this.$route.params;\n      this.$ons.notification.confirm(\"Confirm delete?\").then(function (res) {\n        if (res == 1) {\n          axios({\n            method: \"put\",\n            url: \"/visit-record/visit-record-delete\",\n            headers: {\n              Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n            },\n            data: id_visit\n          }).then(function (res) {\n            if (res.status == 200) {\n              _this2.$ons.notification.alert(\"Visit Record delete successful\");\n\n              _this2.$router.go(-1);\n            }\n          }).catch(function (error) {\n            _this2.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n          }).finally(function () {});\n        }\n      });\n    },\n    DOWNLOAD_PDF: function DOWNLOAD_PDF() {\n      var doc = new jsPDF({\n        orientation: \"l\",\n        unit: \"mm\",\n        format: [1005, 720],\n        putOnlyUsedFonts: true\n      });\n      doc.html(document.getElementById(\"report-sheet\"), {\n        callback: function callback(doc) {\n          doc.save();\n        }\n      });\n    },\n    TOGGLE_POPUP: function TOGGLE_POPUP() {\n      this.isEdit = !this.isEdit;\n    }\n  },\n  computed: {\n    sign_dacon_date: function sign_dacon_date() {\n      if (this.info.sign_dacon_date) return moment(this.info.sign_dacon_date).format(\"LL\");\n      return null;\n    },\n    sign_client_date: function sign_client_date() {\n      if (this.info.sign_client_date) return moment(this.info.sign_client_date).format(\"LL\");\n      return null;\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,0BADA;AAEAC;AACAC,oBADA;AAEAC,wBAFA;AAGAC,wBAHA;AAIAC;AAJA,GAFA;AAQAC,SARA,qBAQA;AACA;AACA,GAVA;AAWAC,MAXA,kBAWA;AACA;AACAC,sBADA;AAEAC,mBAFA;AAGAC,mBAHA;AAIAC,uBAJA;AAKAC,uBALA;AAMAC,cANA;AAOAC;AAPA;AASA,GArBA;AAsBAC;AACAC,qBADA,6BACAC,GADA,EACA;AACA;;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA;AACA,KAZA;AAaAC,cAbA,wBAaA;AAAA;;AACA;AACAC;AACA;;AACA;AACAC;AACAC,0BADA;AAEAC,kDAFA;AAGAC;AACAC,6BACA;AAFA,aAHA;AAOAjB;AAPA,aASAkB,IATA,CASA;AACA;AAEA;AACA;;AACA,kBACA,wCACA,qCAFA,EAGA;AACA;AACA;AACA,aARA,MAQA;AACA;AACA;AACA,WAvBA,EAwBAC,KAxBA,CAwBA;AACA,0CACAC,8DADA;AAGA,WA5BA,EA6BAC,OA7BA,CA6BA;AACA;AACA,WA/BA;AAgCA;AACA,OApCA,EAoCA,GApCA;AAqCA,KApDA;AAqDAC,kBArDA,4BAqDA;AAAA;;AACA;AACA;AACA;AACAT;AACAC,yBADA;AAEAC,oDAFA;AAGAC;AACAC,6BACA;AAFA,aAHA;AAOAjB;AAPA,aASAkB,IATA,CASA;AACA;AACA;;AACA;AACA;AACA,WAdA,EAeAC,KAfA,CAeA;AACA,2CACAC,8DADA;AAGA,WAnBA,EAoBAC,OApBA,CAoBA,cApBA;AAqBA;AACA,OAxBA;AAyBA,KAhFA;AAiFAE,gBAjFA,0BAiFA;AACA;AACAC,wBADA;AAEAC,kBAFA;AAGAC,2BAHA;AAIAC;AAJA;AAOAC;AACAC;AACAD;AACA;AAHA;AAKA,KA9FA;AA+FAE,gBA/FA,0BA+FA;AACA;AACA;AAjGA,GAtBA;AAyHAC;AACAC,mBADA,6BACA;AACA,qCACA;AACA;AACA,KALA;AAMAC,oBANA,8BAMA;AACA,sCACA;AACA;AACA;AAVA;AAzHA","names":["name","components","toolbar","popupEdit","popupSign","contentLoading","created","data","isLoading","isEdit","isSign","currentSigner","sign_status","info","popupTitle","methods","TOGGLE_POPUP_SIGN","opt","FETCH_INFO","setTimeout","axios","method","url","headers","Authorization","then","catch","error","finally","DELETE_PROJECT","DOWNLOAD_PDF","orientation","unit","format","putOnlyUsedFonts","doc","callback","TOGGLE_POPUP","computed","sign_dacon_date","sign_client_date"],"sourceRoot":"src/views/Applications/Record/Visiting","sources":["VisitRecordInfo.vue"],"sourcesContent":["<template>\n  <div class=\"pm-page\">\n    <div class=\"pm-toolbar\">\n      <toolbar\n        :pageSubName=\"'Record No. ' + info.doc_no\"\n        :isBack=\"true\"\n        :isEdit=\"sign_status\"\n        :isDelete=\"true\"\n        :isPrint=\"false\"\n        :isDownload=\"true\"\n        @isDeleteBtn=\"DELETE_PROJECT()\"\n        @isEditBtn=\"TOGGLE_POPUP()\"\n        @isDownloadBtn=\"DOWNLOAD_PDF()\"\n        @refreshInfo=\"FETCH_INFO()\"\n      />\n    </div>\n    <div class=\"pm-page-container\">\n      <div class=\"page-content\">\n        <div id=\"report-sheet\">\n          <div class=\"report-container\">\n            <div class=\"sheet-header\">\n              <div class=\"logo\"><img src=\"/img/ai-logo.png\" /></div>\n              <div class=\"title\">client visiting record</div>\n              <div class=\"docno\">{{ info.doc_no }}</div>\n            </div>\n            <div class=\"sheet-body\">\n              <div class=\"section-label\"><label>client information</label></div>\n              <div class=\"section-label\"><label>visiting objective</label></div>\n\n              <div class=\"form-item-label\"><label>Company</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.client_company_name }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Visiting</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.obj_visiting_comment }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Location/Address</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.client_location }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Meeting</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.obj_meeting_comment }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Name</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.client_name }}</label>\n              </div>\n\n              <div class=\"form-item-label\">\n                <label>Sales and Marketing</label>\n              </div>\n              <div class=\"form-item-value\">\n                <label>{{ info.obj_saleandmarketing_comment }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Position</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.client_position }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Submit Document</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.obj_submitdoc_comment }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Email</label></div>\n              <div class=\"form-item-value\">\n                <label style=\"text-transform: lowercase\">{{\n                  info.client_email\n                }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Receive Document</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.obj_receivedoc_comment }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Tel.</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.client_phone_no }}</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Other</label></div>\n              <div class=\"form-item-value\">\n                <label>{{ info.obj_other_comment }}</label>\n              </div>\n\n              <div class=\"section-label\" style=\"grid-column: span 6\">\n                <label>note</label>\n              </div>\n              <div class=\"form-item-value form-item-value-textarea\">\n                <label>{{ info.note }}</label>\n              </div>\n              <div class=\"section-label\" style=\"grid-column: span 3\">\n                <label>dacon acknowledgement</label>\n              </div>\n              <div class=\"section-label\" style=\"grid-column: span 3\">\n                <label>client acknowledgement</label>\n              </div>\n              <div class=\"form-item-label\" style=\"grid-column: span 1\">\n                <label>Name</label>\n              </div>\n              <div class=\"form-item-value\" style=\"grid-column: span 1\">\n                <label>{{ info.firstname }} {{ info.lastname }}</label>\n              </div>\n\n              <div\n                class=\"form-item-label\"\n                style=\"border-width: 0.5px; justify-content: center\"\n              >\n                <label>Signature</label>\n              </div>\n\n              <div class=\"form-item-label\" style=\"grid-column: span 1\">\n                <label>Name</label>\n              </div>\n              <div class=\"form-item-value\" style=\"grid-column: span 1\">\n                <label>{{ info.client_name }}</label>\n              </div>\n\n              <div\n                class=\"form-item-label\"\n                style=\"border-width: 0.5px; justify-content: center\"\n              >\n                <label>Signature</label>\n              </div>\n\n              <div class=\"form-item-label\"><label>Position</label></div>\n              <div class=\"form-item-value\" style=\"grid-column: span 1\">\n                <label>{{ info.position }}</label>\n              </div>\n              <div\n                class=\"form-item-value\"\n                style=\"\n                  grid-column: span 1;\n                  grid-row: span 2;\n                  border-width: 0.5px;\n                  padding: 0;\n                \"\n              >\n                <div\n                  class=\"btn-add-sign\"\n                  v-if=\"\n                    info.sign_dacon_signed == false ||\n                    info.sign_dacon_signed == null\n                  \"\n                  v-on:click=\"TOGGLE_POPUP_SIGN('dexon')\"\n                >\n                  <i class=\"las la-pen-nib\"></i>\n                  <span>Click to Sign</span>\n                </div>\n                <div class=\"sign-img\" v-if=\"info.sign_dacon_signed == true\">\n                  <img :src=\"info.sign_dacon_img\" />\n                </div>\n              </div>\n              <div class=\"form-item-label\"><label>Position</label></div>\n              <div class=\"form-item-value\" style=\"grid-column: span 1\">\n                <label>{{ info.client_position }}</label>\n              </div>\n              <div\n                class=\"form-item-value\"\n                style=\"\n                  grid-column: span 1;\n                  grid-row: span 2;\n                  border-width: 0.5px;\n                  padding: 0;\n                \"\n              >\n                <div\n                  class=\"btn-add-sign\"\n                  v-if=\"\n                    info.sign_client_signed == false ||\n                    info.sign_client_signed == null\n                  \"\n                  v-on:click=\"TOGGLE_POPUP_SIGN('client')\"\n                >\n                  <i class=\"las la-pen-nib\"></i>\n                  <span>Click to Sign</span>\n                </div>\n                <div class=\"sign-img\" v-if=\"info.sign_client_signed == true\">\n                  <img :src=\"info.sign_client_img\" />\n                </div>\n              </div>\n              <div class=\"form-item-label\"><label>Sign Date</label></div>\n              <div class=\"form-item-value\" style=\"grid-column: span 1\">\n                <label>{{ sign_dacon_date }}</label>\n              </div>\n              <div class=\"form-item-label\"><label>Sign Date</label></div>\n              <div class=\"form-item-value\" style=\"grid-column: span 1\">\n                <label>{{ sign_client_date }}</label>\n              </div>\n            </div>\n            <div class=\"sheet-footer\">\n              <label>F-PINT71-01 Rev.02</label>\n              <label>Effective Date: 11-May-2021</label>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <popupEdit\n      v-if=\"isEdit == true\"\n      @closePopup=\"TOGGLE_POPUP()\"\n      @FETCH_INFO=\"FETCH_INFO()\"\n      :editInfo=\"info\"\n    />\n    <popupSign\n      v-if=\"isSign == true\"\n      :title=\"popupTitle\"\n      :signer=\"currentSigner\"\n      :info=\"this.info\"\n      @closePopup=\"TOGGLE_POPUP_SIGN()\"\n      @FETCH_INFO=\"FETCH_INFO()\"\n    />\n\n    <contentLoading\n      text=\"Loading, please wait...\"\n      v-if=\"isLoading == true\"\n      color=\"#fbcb04\"\n    />\n  </div>\n</template>\n\n<script>\nimport toolbar from \"@/components/app-structures/app-toolbar.vue\";\nimport popupSign from \"@/views/Applications/Record/Visiting/visiting-signature-add.vue\";\nimport popupEdit from \"@/views/Applications/Record/Visiting/visiting-edit.vue\";\nimport contentLoading from \"@/components/app-structures/app-content-loading.vue\";\nimport axios from \"/axios.js\";\nimport moment from \"moment\";\nimport { jsPDF } from \"jspdf\";\nexport default {\n  name: \"ViewVisitingInfo\",\n  components: {\n    toolbar,\n    popupEdit,\n    popupSign,\n    contentLoading,\n  },\n  created() {\n    if (this.$store.state.status.server == true) this.FETCH_INFO();\n  },\n  data() {\n    return {\n      isLoading: false,\n      isEdit: false,\n      isSign: false,\n      currentSigner: \"\",\n      sign_status: true,\n      info: \"\",\n      popupTitle: \"\",\n    };\n  },\n  methods: {\n    TOGGLE_POPUP_SIGN(opt) {\n      if (this.isSign == true) this.isSign = false;\n      if (opt == \"dexon\") {\n        this.popupTitle = \"Dexon Signature\";\n        this.currentSigner = \"dexon\";\n        this.isSign = true;\n      } else if (opt == \"client\") {\n        this.popupTitle = \"Client Signature\";\n        this.currentSigner = \"client\";\n        this.isSign = true;\n      }\n    },\n    FETCH_INFO() {\n      this.isLoading = true;\n      setTimeout(() => {\n        const id_visit = this.$route.params;\n        if (id_visit) {\n          axios({\n            method: \"post\",\n            url: \"/visit-record/visit-record-info\",\n            headers: {\n              Authorization:\n                \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n            },\n            data: id_visit,\n          })\n            .then((res) => {\n              // console.log(res);\n\n              if (res.status == 200 && res.data[0]) {\n                this.info = res.data[0];\n                if (\n                  this.info.sign_dacon_signed == true ||\n                  this.info.sign_client_signed == true\n                ) {\n                  this.sign_status = false;\n                }\n              } else {\n                this.$ons.notification.alert(\"Record information not found\");\n              }\n            })\n            .catch((error) => {\n              this.$ons.notification.alert(\n                error.code + \" \" + error.response.status + \" \" + error.message\n              );\n            })\n            .finally(() => {\n              this.isLoading = false;\n            });\n        }\n      }, 500);\n    },\n    DELETE_PROJECT() {\n      const id_visit = this.$route.params;\n      this.$ons.notification.confirm(\"Confirm delete?\").then((res) => {\n        if (res == 1) {\n          axios({\n            method: \"put\",\n            url: \"/visit-record/visit-record-delete\",\n            headers: {\n              Authorization:\n                \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n            },\n            data: id_visit,\n          })\n            .then((res) => {\n              if (res.status == 200) {\n                this.$ons.notification.alert(\"Visit Record delete successful\");\n                this.$router.go(-1);\n              }\n            })\n            .catch((error) => {\n              this.$ons.notification.alert(\n                error.code + \" \" + error.response.status + \" \" + error.message\n              );\n            })\n            .finally(() => {});\n        }\n      });\n    },\n    DOWNLOAD_PDF() {\n      var doc = new jsPDF({\n        orientation: \"l\",\n        unit: \"mm\",\n        format: [1005, 720],\n        putOnlyUsedFonts: true,\n      });\n\n      doc.html(document.getElementById(\"report-sheet\"), {\n        callback: function (doc) {\n          doc.save();\n        },\n      });\n    },\n    TOGGLE_POPUP() {\n      this.isEdit = !this.isEdit;\n    },\n  },\n  computed: {\n    sign_dacon_date() {\n      if (this.info.sign_dacon_date)\n        return moment(this.info.sign_dacon_date).format(\"LL\");\n      return null;\n    },\n    sign_client_date() {\n      if (this.info.sign_client_date)\n        return moment(this.info.sign_client_date).format(\"LL\");\n      return null;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/style/main.scss\";\n.pm-page {\n  border: 1px solid #e6e6e6;\n  border-width: 0 0 0 1px;\n  background-color: #ffffff;\n  width: 100%;\n  height: calc(100vh - 78px);\n  display: grid;\n  grid-template-rows: 61px calc(100vh - 61px);\n\n  .pm-page-container {\n    background-color: #d9d9d9;\n    display: grid;\n    grid-template-columns: 100%;\n    height: calc(100% - 78px);\n    .page-content {\n      width: 100%;\n      height: calc(100vh - 139px);\n      overflow-x: scroll;\n      overflow-y: scroll;\n      display: flex;\n      justify-content: flex-start;\n      flex-direction: column;\n      align-items: center;\n    }\n    .page-content::-webkit-scrollbar {\n      display: none;\n    }\n  }\n}\nh1 {\n  font-size: 2em;\n}\n.report-container {\n  .header {\n    .title {\n      grid-column: span 4;\n    }\n  }\n  .section-label {\n    grid-column: span 3;\n  }\n  .ackn-section {\n    grid-column: span 6;\n    display: grid;\n    grid-template-columns: repeat(7, 14.28%);\n  }\n}\n\n.btn-add-sign {\n  background-color: transparent;\n  padding: 4px 6px;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 0px;\n  cursor: pointer;\n\n  i {\n    font-size: 18px;\n    color: $web-font-color-blue;\n  }\n\n  span {\n    font-size: 14px;\n    font-weight: 500;\n    color: $web-font-color-blue;\n    padding-left: 6px;\n    text-align: center;\n  }\n}\n\n.sign-img {\n  width: 100%;\n  img {\n    width: 100%;\n    object-fit: contain;\n  }\n}\n</style>"]},"metadata":{},"sourceType":"module"}