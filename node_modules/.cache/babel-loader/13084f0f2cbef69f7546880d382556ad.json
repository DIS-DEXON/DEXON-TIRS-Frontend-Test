{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//DataGrid\n// import { exportDataGrid } from \"devextreme/excel_exporter\";\nimport \"devextreme/dist/css/dx.light.css\";\nimport { DxDataGrid, // DxSearchPanel,\nDxPaging, // DxPager,\nDxScrolling, DxColumn // DxExport,\n} from \"devextreme-vue/data-grid\"; //Charts\n\nimport ChartCurrentSalesLine from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-line.vue\";\nimport ChartCurrentSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-pie.vue\";\nimport ChartCurrentSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-bar.vue\";\nimport ChartForecastSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-pie.vue\";\nimport ChartForecastSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-bar.vue\";\nimport ChartProjectProgress from \"@/views/Applications/ExecutiveManagement/Charts/project-progress-line.vue\"; //Year Set\n\nimport YearSetCurrent from \"@/views/Applications/ExecutiveManagement/YearSet/current-sales.vue\";\nimport YearSetForecast from \"@/views/Applications/ExecutiveManagement/YearSet/forecast-sales.vue\"; //DataGrid\n//Structures\n\nimport contentLoading from \"@/components/app-structures/app-content-loading.vue\";\nimport ViewLayout from \"@/layouts/sidebar-layout.vue\";\nimport ViewLayoutNoneSidebar from \"@/layouts/non-sidebar-layout.vue\"; //API\n\nimport axios from \"/axios.js\";\nimport moment from \"moment\";\nexport default {\n  name: \"ViewSummaryReport\",\n  components: {\n    // toolbar,\n    contentLoading,\n    ChartCurrentSalesLine,\n    ChartCurrentSalesPie,\n    ChartCurrentSalesBar,\n    YearSetCurrent,\n    ChartForecastSalesPie,\n    ChartForecastSalesBar,\n    YearSetForecast,\n    ChartProjectProgress,\n    //DataGrid\n    DxDataGrid,\n    // DxSearchPanel,\n    DxPaging,\n    // DxPager,\n    DxScrolling,\n    DxColumn // DxExport,\n\n  },\n\n  created() {\n    if (this.$store.state.user.role == \"ceo\" || this.$store.state.user.role == \"manager\") {\n      if (this.$store.state.user.role == \"ceo\") {\n        this.$emit(`update:layout`, ViewLayoutNoneSidebar);\n      } else {\n        this.$emit(`update:layout`, ViewLayout);\n      }\n\n      this.$store.commit(\"CLEAR_CURRENT_INAPP\");\n      this.$store.commit(\"UPDATE_CURRENT_INAPP\", {\n        name: \"Executive Summary Report\",\n        icon: \"/img/icon_menu/executive_management/summary.png\"\n      });\n      this.FETCH_INFO();\n      this.FETCH_DATA_PROJECT_FORECAST();\n      this.FETCH_DATA_PROJECT_PROGRESS();\n    }\n  },\n\n  data() {\n    return {\n      isLoading: false,\n      info: {\n        weekly_report: {}\n      },\n      quarter: [{\n        no: \"Year 2023\"\n      }, {\n        no: \"Q1\"\n      }, {\n        no: \"Q2\"\n      }, {\n        no: \"Q3\"\n      }, {\n        no: \"Q4\"\n      }, {\n        no: \"Total\"\n      }],\n      forecast_project_list: [],\n      current_project_progress_list: [],\n      current_project_progress_chart: []\n    };\n  },\n\n  computed: {\n    weekly_start_date() {\n      return moment(this.info.weekly_report.start_date).format(\"ddd-MMM-DD-YY\");\n    },\n\n    weekly_end_date() {\n      return moment(this.info.weekly_report.end_date).format(\"ddd-MMM-DD-YY\");\n    },\n\n    current_date() {\n      return moment().format(\"dddd, LL, hh:mm:ss a\");\n    },\n\n    current_year() {\n      return moment().year();\n    },\n\n    report_message() {\n      if (this.info.weekly_report.report_message) {\n        var htmlString = this.info.weekly_report.report_message;\n        return htmlString.replace(/\\\\/g, \"\");\n      } else return this.$store.state.inAppMessage.noData;\n    },\n\n    forecast_revenue_total() {\n      var list = this.forecast_project_list;\n      var sum = 0;\n\n      for (var i = 0; i < list.length; i++) {\n        sum += list[i].project_value;\n      }\n\n      return (sum / 1000000).toFixed(2);\n    }\n\n  },\n  methods: {\n    FETCH_INFO() {\n      axios({\n        method: \"get\",\n        url: \"weekly-report/get-last-weekly-report\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n        }\n      }).then(res => {\n        // console.log(res);\n        if (res.data) {\n          this.info.weekly_report = res.data[0];\n        }\n      }).catch(error => {\n        this.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n      }).finally(() => {});\n    },\n\n    FETCH_DATA_PROJECT_FORECAST() {\n      axios({\n        method: \"get\",\n        url: \"/forecast-sales/forecast-sales-list\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n        }\n      }).then(res => {\n        console.log(res);\n\n        if (res.data) {\n          this.forecast_project_list = res.data;\n        }\n      }).catch(error => {\n        this.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n      }).finally(() => {});\n    },\n\n    FETCH_DATA_PROJECT_PROGRESS() {\n      axios({\n        method: \"get\",\n        url: \"/current-sales/project-current-sales-progress\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n        }\n      }).then(res => {\n        // console.log(res);\n        if (res.data) {\n          this.current_project_progress_chart = res.data;\n        }\n      }).catch(error => {\n        this.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n      }).finally(() => {});\n    },\n\n    PROJECT_PROGRESS_PERCENT(cellInfo) {\n      return cellInfo.value.toFixed(0) + \" %\";\n    },\n\n    FORECAST_CONFIDENCE_LEVEL(cellInfo) {\n      return cellInfo.value.toFixed(0) + \" %\";\n    },\n\n    FORECAST_REVENUE(cellInfo) {\n      return (cellInfo.value / 1000000).toFixed(2);\n    },\n\n    TEST(data) {\n      console.log(data);\n    }\n\n  },\n\n  mounted() {}\n\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwQA;AACA;AACA;AACA,SACAA,UADA,EAEA;AACAC,QAHA,EAIA;AACAC,WALA,EAMAC,QANA,CAOA;AAPA,OAQA,0BARA,C,CAUA;;AACA;AACA;AACA;AAEA;AACA;AAEA,6G,CAEA;;AACA;AACA,kG,CAEA;AAEA;;AACA;AACA;AACA,qE,CAEA;;AACA;AACA;AAEA;AACAC,2BADA;AAEAC;AACA;AACAC,kBAFA;AAGAC,yBAHA;AAIAC,wBAJA;AAKAC,wBALA;AAMAC,kBANA;AAOAC,yBAPA;AAQAC,yBARA;AASAC,mBATA;AAUAC,wBAVA;AAWA;AACAd,cAZA;AAaA;AACAC,YAdA;AAeA;AACAC,eAhBA;AAiBAC,YAjBA,CAkBA;;AAlBA,GAFA;;AAsBAY;AACA,QACA,wCACA,wCAFA,EAGA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;;AACA;AACA;AACAX,wCADA;AAEAY;AAFA;AAIA;AACA;AACA;AACA;AACA,GAzCA;;AA0CAC;AACA;AACAC,sBADA;AAEAC;AACAC;AADA,OAFA;AAKAC,gBACA;AACAC;AADA,OADA,EAIA;AACAA;AADA,OAJA,EAOA;AACAA;AADA,OAPA,EAUA;AACAA;AADA,OAVA,EAaA;AACAA;AADA,OAbA,EAgBA;AACAA;AADA,OAhBA,CALA;AAyBAC,+BAzBA;AA0BAC,uCA1BA;AA2BAC;AA3BA;AA6BA,GAxEA;;AAyEAC;AACAC;AACA;AACA,KAHA;;AAIAC;AACA;AACA,KANA;;AAOAC;AACA;AACA,KATA;;AAUAC;AACA;AACA,KAZA;;AAaAC;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA,KAlBA;;AAmBAC;AACA;AACA;;AACA;AACAC;AACA;;AACA;AACA;;AA1BA,GAzEA;AAsGAC;AACAC;AACAC;AACAC,qBADA;AAEAC,mDAFA;AAGAC;AACAC;AADA;AAHA,SAOAC,IAPA,CAOAC;AACA;AACA;AACA;AACA;AACA,OAZA,EAaAC,KAbA,CAaAC;AACA,qCACAA,8DADA;AAGA,OAjBA,EAkBAC,OAlBA,CAkBA,QAlBA;AAmBA,KArBA;;AAsBAC;AACAV;AACAC,qBADA;AAEAC,kDAFA;AAGAC;AACAC;AADA;AAHA,SAOAC,IAPA,CAOAC;AACAK;;AACA;AACA;AACA;AACA,OAZA,EAaAJ,KAbA,CAaAC;AACA,qCACAA,8DADA;AAGA,OAjBA,EAkBAC,OAlBA,CAkBA,QAlBA;AAmBA,KA1CA;;AA2CAG;AACAZ;AACAC,qBADA;AAEAC,4DAFA;AAGAC;AACAC;AADA;AAHA,SAOAC,IAPA,CAOAC;AACA;AACA;AACA;AACA;AACA,OAZA,EAaAC,KAbA,CAaAC;AACA,qCACAA,8DADA;AAGA,OAjBA,EAkBAC,OAlBA,CAkBA,QAlBA;AAmBA,KA/DA;;AAgEAI;AACA;AACA,KAlEA;;AAmEAC;AACA;AACA,KArEA;;AAsEAC;AACA;AACA,KAxEA;;AAyEAC;AACAL;AACA;;AA3EA,GAtGA;;AAmLAM;;AAnLA","names":["DxDataGrid","DxPaging","DxScrolling","DxColumn","name","components","contentLoading","ChartCurrentSalesLine","ChartCurrentSalesPie","ChartCurrentSalesBar","YearSetCurrent","ChartForecastSalesPie","ChartForecastSalesBar","YearSetForecast","ChartProjectProgress","created","icon","data","isLoading","info","weekly_report","quarter","no","forecast_project_list","current_project_progress_list","current_project_progress_chart","computed","weekly_start_date","weekly_end_date","current_date","current_year","report_message","forecast_revenue_total","sum","methods","FETCH_INFO","axios","method","url","headers","Authorization","then","res","catch","error","finally","FETCH_DATA_PROJECT_FORECAST","console","FETCH_DATA_PROJECT_PROGRESS","PROJECT_PROGRESS_PERCENT","FORECAST_CONFIDENCE_LEVEL","FORECAST_REVENUE","TEST","mounted"],"sourceRoot":"src/views/Applications/ExecutiveManagement","sources":["SummaryReport.vue"],"sourcesContent":["<template>\n  <div class=\"pm-page\">\n    <div class=\"pm-page-container\">\n      <div class=\"page-header\">\n        <h1>\n          <span style=\"font-size: 32px\">E</span>xecutive\n          <span style=\"font-size: 32px\">R</span>eport of\n          <span style=\"font-size: 32px\">a</span>sset\n          <span style=\"font-size: 32px\">i</span>ntegrity\n          <span style=\"font-size: 32px\">s</span>ection\n        </h1>\n        <div>\n          <label>report period:</label>\n          <label> {{ weekly_start_date }} to {{ weekly_end_date }}</label>\n        </div>\n        <div>\n          <label>report by:</label>\n          <label>Mr. Chawanat Kongthanakana</label>\n        </div>\n        <!-- <div>\n          <label>position:</label>\n          <label>asset integrity section manager</label>\n        </div> -->\n      </div>\n      <div class=\"page-content\">\n        <div class=\"page-report\">\n          <!-- Weekly Report -->\n          <div class=\"report-item\">\n            <h2>Executive Summary</h2>\n            <div class=\"report-item-card\">\n              <div class=\"report-message-display\" v-html=\"report_message\"></div>\n            </div>\n          </div>\n          <!-- Current Sales -->\n          <div class=\"report-item\">\n            <h2>Current Revenue of {{ current_year }}</h2>\n            <div class=\"report-item-card\">\n              <YearSetCurrent />\n              <div class=\"chart-wrapper-grid\">\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartCurrentSalesLine />\n                  <div class=\"figure-label\">\n                    THE SUMMARY OF CURRENT REVENUE BY MONTHLY IN 2022\n                  </div>\n                </div>\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartCurrentSalesPie />\n                  <div class=\"figure-label\">THE TOTAL REVENUE IN 2022</div>\n                </div>\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartCurrentSalesBar />\n                  <div class=\"figure-label\">\n                    THE SUMMARY OF CURRENT REVENUE IN 2022\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <!-- Forecast Sales -->\n          <div class=\"report-item\">\n            <h2>Forecast Revenue of {{ current_year + 1 }}</h2>\n            <div class=\"report-item-card\">\n              <YearSetForecast />\n              <div class=\"chart-wrapper-grid\">\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartForecastSalesBar />\n                  <div class=\"figure-label\">\n                    THE SUMMARY OF FORECAST REVENUE IN 2023\n                  </div>\n                </div>\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartForecastSalesPie />\n                  <div class=\"figure-label\">\n                    THE TOTAL FORECAST OF REVENUE BY SERVICE TYPE IN 2023\n                  </div>\n                </div>\n              </div>\n              <div class=\"table-summary\">\n                <div class=\"panel-head\">The Forecast Revenue of 2023</div>\n                <DxDataGrid\n                  id=\"summary-forecast-revenue\"\n                  :data-source=\"forecast_project_list\"\n                  :selection=\"{ mode: 'single' }\"\n                  :hover-state-enabled=\"true\"\n                  :allow-column-reordering=\"true\"\n                  :show-borders=\"true\"\n                  :show-row-lines=\"false\"\n                  :row-alternation-enabled=\"true\"\n                >\n                  <DxPaging :page-size=\"100\" />\n                  <DxColumn\n                    data-field=\"\"\n                    :width=\"50\"\n                    alignment=\"center\"\n                    caption=\"No.\"\n                    cell-template=\"CELL_ROW_FORECAST\"\n                  />\n                  <DxColumn\n                    data-field=\"service_type_desc\"\n                    alignment=\"center\"\n                    caption=\"Service Type\"\n                    :width=\"100\"\n                    header-cell-template=\"service-header\"\n                  />\n                  <DxColumn\n                    data-field=\"project_name\"\n                    alignment=\"left\"\n                    caption=\"Project Name\"\n                  />\n                  <DxColumn\n                    data-field=\"client_name\"\n                    caption=\"Client Name\"\n                    :width=\"380\"\n                  />\n                  <DxColumn\n                    data-field=\"confident_level\"\n                    caption=\"Confidence Level (%)\"\n                    alignment=\"center\"\n                    :width=\"120\"\n                    :customize-text=\"FORECAST_CONFIDENCE_LEVEL\"\n                    header-cell-template=\"confidence-header\"\n                  />\n                  <DxColumn\n                    data-field=\"project_value\"\n                    caption=\"Forecast Revenue (MB)\"\n                    alignment=\"center\"\n                    :width=\"120\"\n                    :customize-text=\"FORECAST_REVENUE\"\n                    header-cell-template=\"forecast-header\"\n                  />\n                  <!-- Configuration goes here -->\n                  <!-- <DxFilterRow :visible=\"true\" /> -->\n                  <DxScrolling mode=\"standard\" />\n                  <template #service-header>\n                    <div>Service<br />Type</div>\n                  </template>\n                  <template #confidence-header>\n                    <div>Confident<br />Level(%)</div>\n                  </template>\n                  <template #forecast-header>\n                    <div>Forecast<br />Revenue(MB)</div>\n                  </template>\n                  <template #CELL_ROW_FORECAST=\"{ data }\">\n                    {{ data.rowIndex + 1 }}\n                  </template>\n                </DxDataGrid>\n                <div class=\"panel-summary\">\n                  <div class=\"label\">total forecast revenue</div>\n                  <div class=\"total-count\">{{ forecast_revenue_total }} MB</div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <!-- Project Progress -->\n          <div class=\"report-item\">\n            <h2>current project progress</h2>\n            <div class=\"report-item-card\">\n              <div class=\"table-summary\">\n                <div class=\"panel-head\">Project Progress Summary</div>\n                <DxDataGrid\n                  id=\"summary-forecast-revenue\"\n                  :data-source=\"current_project_progress_chart\"\n                  :selection=\"{ mode: 'single' }\"\n                  :hover-state-enabled=\"true\"\n                  :allow-column-reordering=\"true\"\n                  :show-borders=\"true\"\n                  :show-row-lines=\"false\"\n                  :row-alternation-enabled=\"true\"\n                >\n                  <DxPaging :page-size=\"100\" />\n                  <DxColumn\n                    data-field=\"\"\n                    :width=\"50\"\n                    alignment=\"center\"\n                    caption=\"No.\"\n                    cell-template=\"CELL_ROW_CURRENT\"\n                  />\n                  <DxColumn\n                    data-field=\"project_no\"\n                    alignment=\"center\"\n                    caption=\"Project No.\"\n                    :width=\"120\"\n                  />\n                  <DxColumn\n                    data-field=\"project_name\"\n                    alignment=\"left\"\n                    caption=\"Project Name\"\n                  />\n                  <DxColumn\n                    data-field=\"service_type\"\n                    alignment=\"center\"\n                    caption=\"Service Type\"\n                    :width=\"100\"\n                    header-cell-template=\"service-header\"\n                  />\n                  <DxColumn\n                    data-field=\"client_name\"\n                    :width=\"300\"\n                    caption=\"Client Name\"\n                  />\n                  <DxColumn\n                    data-field=\"actual_cumulative\"\n                    caption=\"Progress (%)\"\n                    :width=\"120\"\n                    alignment=\"center\"\n                    :customize-text=\"PROJECT_PROGRESS_PERCENT\"\n                    header-cell-template=\"progress-header\"\n                  />\n                  <DxColumn\n                    data-field=\"status_cumulative\"\n                    caption=\"Progress Status\"\n                    :width=\"120\"\n                    alignment=\"center\"\n                    header-cell-template=\"progress-status-header\"\n                  />\n\n                  <!-- Configuration goes here -->\n                  <!-- <DxFilterRow :visible=\"true\" /> -->\n                  <DxScrolling mode=\"standard\" />\n                  <template #service-header>\n                    <div>Service<br />Type</div>\n                  </template>\n                  <template #progress-header>\n                    <div>Progress<br />(%)</div>\n                  </template>\n                  <template #progress-status-header>\n                    <div>Progress<br />Status</div>\n                  </template>\n                  <template #CELL_ROW_CURRENT=\"{ data }\">\n                    {{ data.rowIndex + 1 }}\n                  </template>\n                </DxDataGrid>\n              </div>\n              <div class=\"chart-wrpper-grid\">\n                <div class=\"chart-wrapper\">\n                  <div\n                    v-for=\"(item, index) in current_project_progress_chart\"\n                    :key=\"item.id_project\"\n                  >\n                    <ChartProjectProgress\n                      :info=\"current_project_progress_chart[index]\"\n                      v-if=\"item.status_cumulative != 'Done'\"\n                    />\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <label class=\"update-label\"\n            >Information Updated on: {{ current_date }}</label\n          >\n        </div>\n      </div>\n    </div>\n\n    <contentLoading\n      text=\"Loading, please wait...\"\n      v-if=\"isLoading == true\"\n      color=\"#fc9b21\"\n    />\n  </div>\n</template> \n\n<script>\n//DataGrid\n// import { exportDataGrid } from \"devextreme/excel_exporter\";\nimport \"devextreme/dist/css/dx.light.css\";\nimport {\n  DxDataGrid,\n  // DxSearchPanel,\n  DxPaging,\n  // DxPager,\n  DxScrolling,\n  DxColumn,\n  // DxExport,\n} from \"devextreme-vue/data-grid\";\n\n//Charts\nimport ChartCurrentSalesLine from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-line.vue\";\nimport ChartCurrentSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-pie.vue\";\nimport ChartCurrentSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-bar.vue\";\n\nimport ChartForecastSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-pie.vue\";\nimport ChartForecastSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-bar.vue\";\n\nimport ChartProjectProgress from \"@/views/Applications/ExecutiveManagement/Charts/project-progress-line.vue\";\n\n//Year Set\nimport YearSetCurrent from \"@/views/Applications/ExecutiveManagement/YearSet/current-sales.vue\";\nimport YearSetForecast from \"@/views/Applications/ExecutiveManagement/YearSet/forecast-sales.vue\";\n\n//DataGrid\n\n//Structures\nimport contentLoading from \"@/components/app-structures/app-content-loading.vue\";\nimport ViewLayout from \"@/layouts/sidebar-layout.vue\";\nimport ViewLayoutNoneSidebar from \"@/layouts/non-sidebar-layout.vue\";\n\n//API\nimport axios from \"/axios.js\";\nimport moment from \"moment\";\n\nexport default {\n  name: \"ViewSummaryReport\",\n  components: {\n    // toolbar,\n    contentLoading,\n    ChartCurrentSalesLine,\n    ChartCurrentSalesPie,\n    ChartCurrentSalesBar,\n    YearSetCurrent,\n    ChartForecastSalesPie,\n    ChartForecastSalesBar,\n    YearSetForecast,\n    ChartProjectProgress,\n    //DataGrid\n    DxDataGrid,\n    // DxSearchPanel,\n    DxPaging,\n    // DxPager,\n    DxScrolling,\n    DxColumn,\n    // DxExport,\n  },\n  created() {\n    if (\n      this.$store.state.user.role == \"ceo\" ||\n      this.$store.state.user.role == \"manager\"\n    ) {\n      if (this.$store.state.user.role == \"ceo\") {\n        this.$emit(`update:layout`, ViewLayoutNoneSidebar);\n      } else {\n        this.$emit(`update:layout`, ViewLayout);\n      }\n      this.$store.commit(\"CLEAR_CURRENT_INAPP\");\n      this.$store.commit(\"UPDATE_CURRENT_INAPP\", {\n        name: \"Executive Summary Report\",\n        icon: \"/img/icon_menu/executive_management/summary.png\",\n      });\n      this.FETCH_INFO();\n      this.FETCH_DATA_PROJECT_FORECAST();\n      this.FETCH_DATA_PROJECT_PROGRESS();\n    }\n  },\n  data() {\n    return {\n      isLoading: false,\n      info: {\n        weekly_report: {},\n      },\n      quarter: [\n        {\n          no: \"Year 2023\",\n        },\n        {\n          no: \"Q1\",\n        },\n        {\n          no: \"Q2\",\n        },\n        {\n          no: \"Q3\",\n        },\n        {\n          no: \"Q4\",\n        },\n        {\n          no: \"Total\",\n        },\n      ],\n      forecast_project_list: [],\n      current_project_progress_list: [],\n      current_project_progress_chart: [],\n    };\n  },\n  computed: {\n    weekly_start_date() {\n      return moment(this.info.weekly_report.start_date).format(\"ddd-MMM-DD-YY\");\n    },\n    weekly_end_date() {\n      return moment(this.info.weekly_report.end_date).format(\"ddd-MMM-DD-YY\");\n    },\n    current_date() {\n      return moment().format(\"dddd, LL, hh:mm:ss a\");\n    },\n    current_year() {\n      return moment().year();\n    },\n    report_message() {\n      if (this.info.weekly_report.report_message) {\n        var htmlString = this.info.weekly_report.report_message;\n        return htmlString.replace(/\\\\/g, \"\");\n      } else return this.$store.state.inAppMessage.noData;\n    },\n    forecast_revenue_total() {\n      var list = this.forecast_project_list;\n      var sum = 0;\n      for (var i = 0; i < list.length; i++) {\n        sum += list[i].project_value;\n      }\n      return (sum / 1000000).toFixed(2);\n    },\n  },\n\n  methods: {\n    FETCH_INFO() {\n      axios({\n        method: \"get\",\n        url: \"weekly-report/get-last-weekly-report\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n        },\n      })\n        .then((res) => {\n          // console.log(res);\n          if (res.data) {\n            this.info.weekly_report = res.data[0];\n          }\n        })\n        .catch((error) => {\n          this.$ons.notification.alert(\n            error.code + \" \" + error.response.status + \" \" + error.message\n          );\n        })\n        .finally(() => {});\n    },\n    FETCH_DATA_PROJECT_FORECAST() {\n      axios({\n        method: \"get\",\n        url: \"/forecast-sales/forecast-sales-list\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n        },\n      })\n        .then((res) => {\n          console.log(res);\n          if (res.data) {\n            this.forecast_project_list = res.data;\n          }\n        })\n        .catch((error) => {\n          this.$ons.notification.alert(\n            error.code + \" \" + error.response.status + \" \" + error.message\n          );\n        })\n        .finally(() => {});\n    },\n    FETCH_DATA_PROJECT_PROGRESS() {\n      axios({\n        method: \"get\",\n        url: \"/current-sales/project-current-sales-progress\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n        },\n      })\n        .then((res) => {\n          // console.log(res);\n          if (res.data) {\n            this.current_project_progress_chart = res.data;\n          }\n        })\n        .catch((error) => {\n          this.$ons.notification.alert(\n            error.code + \" \" + error.response.status + \" \" + error.message\n          );\n        })\n        .finally(() => {});\n    },\n    PROJECT_PROGRESS_PERCENT(cellInfo) {\n      return cellInfo.value.toFixed(0) + \" %\";\n    },\n    FORECAST_CONFIDENCE_LEVEL(cellInfo) {\n      return cellInfo.value.toFixed(0) + \" %\";\n    },\n    FORECAST_REVENUE(cellInfo) {\n      return (cellInfo.value / 1000000).toFixed(2);\n    },\n    TEST(data) {\n      console.log(data);\n    },\n  },\n  mounted() {},\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/style/main.scss\";\n* {\n  font-family: \"Play\", \"Noto Sans Thai\" !important;\n}\n.pm-page {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  height: 100%;\n  // background-color: rgb(202, 202, 202);\n  .pm-page-container {\n    .page-header {\n      height: 220px;\n      display: flex;\n      justify-content: center;\n      align-items: flex-start;\n      flex-direction: column;\n      background-image: url(\"/public/img/main-bg.jpg\");\n      background-size: cover;\n      background-position: center;\n      background-repeat: no-repeat;\n      position: relative;\n      h1,\n      div {\n        margin: 0;\n        text-align: left;\n        color: #fff;\n        font-style: normal;\n        width: -webkit-fill-available;\n        font-family: \"Play\", \"Noto Sans Thai\" !important;\n        width: 1280px;\n\n        @media screen and (max-width: 1280px) {\n          text-indent: 20px;\n          width: 1024px;\n        }\n      }\n      h1,\n      div {\n        margin: 0 auto;\n      }\n      h1 {\n        font-size: 26px;\n        font-weight: 600;\n        text-transform: uppercase;\n        margin-bottom: 10px;\n      }\n      div {\n        margin-bottom: 6px;\n        display: grid;\n        grid-template-columns: 150px auto;\n        label {\n          font-size: 16px;\n          text-align: left;\n          font-weight: 300;\n          font-family: \"Play\", \"Noto Sans Thai\" !important;\n          text-transform: uppercase;\n        }\n      }\n    }\n    .page-content {\n      height: fit-content;\n      display: flex;\n      justify-content: center;\n      align-content: center;\n      .page-report {\n        width: 1280px;\n        // background-color: #fff;\n        margin: 0 auto;\n\n        @media screen and (max-width: 1920px) {\n          width: 1280px;\n        }\n        @media screen and (max-width: 1280px) {\n          width: 1024px;\n        }\n\n        .report-detail {\n          display: flex;\n          justify-content: center;\n          align-items: flex-start;\n          flex-direction: column;\n          label {\n            font-size: 14px;\n          }\n        }\n        .report-item {\n          margin-top: 40px;\n          h2 {\n            margin: 0;\n            font-size: 20px;\n            font-style: normal;\n            text-transform: uppercase;\n            font-family: \"Play\", \"Noto Sans Thai\" !important;\n          }\n          .report-item-card {\n            background-color: #fff;\n            padding: 20px;\n            margin-top: 20px;\n            margin-bottom: 60px;\n            box-shadow: 0 4px 12px -2px rgb(107 117 161 / 16%);\n            border-radius: 6px;\n            min-height: 200px;\n            height: fit-content;\n          }\n        }\n      }\n    }\n  }\n}\n\n.update-label {\n  font-size: 12px;\n  color: $web-font-color-grey;\n  padding-bottom: 60px;\n}\n\n.report-message-display {\n  min-height: 200px;\n  font-size: 16px;\n  // background-color: #f7f7f7;\n  padding: 10px;\n  // border: 1px solid #e8e8e8;\n  border-radius: 3px;\n  div {\n    width: 100%;\n    img {\n      max-width: 100%;\n      width: 100%;\n    }\n  }\n}\n</style>"]},"metadata":{},"sourceType":"module"}