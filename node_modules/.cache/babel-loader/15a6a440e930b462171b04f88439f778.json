{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"/axios.js\";\nimport clone from \"just-clone\";\nimport signature from \"@/js/signaturePad\";\nimport SignaturePad from \"signature_pad\";\nimport moment from \"moment\";\nexport default {\n  name: \"popup-add-visiting-signature\",\n  components: {},\n\n  data() {\n    return {\n      formData: {}\n    };\n  },\n\n  props: {\n    title: String,\n    signer: String,\n    info: Object\n  },\n\n  mounted() {\n    signature();\n    this.formData = clone(this.info);\n  },\n\n  methods: {\n    CLEAR_CANVAS() {\n      var canvas = document.querySelector(\"canvas\");\n      var signaturePad = new SignaturePad(canvas);\n      signaturePad.clear();\n    },\n\n    SAVE() {\n      var canvas = document.querySelector(\"canvas\");\n      var signature = canvas.toDataURL(); // var today = moment();\n\n      if (this.signer == \"dexon\") {\n        this.formData.sign_dacon_date = moment().toDate();\n        this.formData.sign_dacon_signed = 1;\n        this.formData.sign_dacon_img = signature;\n      } else {\n        this.formData.sign_client_date = moment().toDate();\n        this.formData.sign_client_signed = 1;\n        this.formData.sign_client_img = signature;\n      }\n\n      if (signature) {\n        this.$ons.notification.confirm(\"Confirm SAVE?\").then(res => {\n          if (res == 1) {\n            axios({\n              method: \"put\",\n              url: \"/visit-record/visit-record-sign\",\n              headers: {\n                Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n              },\n              data: this.formData\n            }).then(res => {\n              if (res.status == 200) {\n                console.log(res);\n\n                if (this.signer == \"dexon\") {\n                  this.$ons.notification.alert(\"Dexon Signed\");\n                } else {\n                  this.$ons.notification.alert(\"Client Signed\");\n                }\n\n                this.$emit(\"closePopup\");\n                this.$emit(\"FETCH_INFO\");\n              }\n            }).catch(error => {\n              this.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n            }).finally(() => {});\n          }\n        });\n      }\n    },\n\n    CANCEL() {\n      this.$emit(\"closePopup\");\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACAA,sCADA;AAEAC,gBAFA;;AAGAC;AACA;AACAC;AADA;AAGA,GAPA;;AAQAC;AACAC,iBADA;AAEAC,kBAFA;AAGAC;AAHA,GARA;;AAaAC;AACAC;AACA;AACA,GAhBA;;AAiBAC;AACAC;AACA;AACA;AACAC;AACA,KALA;;AAMAC;AACA;AACA,yCAFA,CAGA;;AAEA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACAC;AACAC,2BADA;AAEAC,oDAFA;AAGAC;AACAC,+BACA;AAFA,eAHA;AAOAhB;AAPA,eASAiB,IATA,CASAC;AACA;AACAC;;AACA;AACA;AACA,iBAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;AACA,aApBA,EAqBAC,KArBA,CAqBAC;AACA,2CACAA,8DADA;AAGA,aAzBA,EA0BAC,OA1BA,CA0BA,QA1BA;AA2BA;AACA,SA9BA;AA+BA;AACA,KAtDA;;AAuDAC;AACA;AACA;;AAzDA;AAjBA","names":["name","components","data","formData","props","title","signer","info","mounted","signature","methods","CLEAR_CANVAS","signaturePad","SAVE","axios","method","url","headers","Authorization","then","res","console","catch","error","finally","CANCEL"],"sourceRoot":"src/views/Applications/Record/Visiting","sources":["visiting-signature-add.vue"],"sourcesContent":["<template>\n  <div class=\"popup-wrapper\">\n    <div class=\"popup-card\">\n      <div class=\"popup-header\">\n        <label>{{ title }}</label>\n      </div>\n      <div class=\"popup-content\">\n        <div id=\"signature-pad\" class=\"signature-pad\">\n          <div class=\"signature-pad--body\">\n            <canvas\n              id=\"sign-canvas\"\n              width=\"600\"\n              style=\"touch-action: none; user-select: none\"\n              height=\"200\"\n            >\n              <h1>test</h1>\n            </canvas>\n            <div class=\"signature-line\"></div>\n            <div class=\"btn-clear\" v-on:click=\"CLEAR_CANVAS()\">\n              <i class=\"las la-undo-alt\"></i>\n              <span>clear</span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"popup-footer\">\n        <div class=\"button-set\">\n          <button class=\"blue\" v-on:click=\"SAVE()\">\n            <label>Save</label>\n          </button>\n          <button class=\"grey\" v-on:click=\"CANCEL()\">\n            <label>Cancel</label>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"/axios.js\";\nimport clone from \"just-clone\";\nimport signature from \"@/js/signaturePad\";\nimport SignaturePad from \"signature_pad\";\nimport moment from \"moment\";\nexport default {\n  name: \"popup-add-visiting-signature\",\n  components: {},\n  data() {\n    return {\n      formData: {},\n    };\n  },\n  props: {\n    title: String,\n    signer: String,\n    info: Object,\n  },\n  mounted() {\n    signature();\n    this.formData = clone(this.info);\n  },\n  methods: {\n    CLEAR_CANVAS() {\n      var canvas = document.querySelector(\"canvas\");\n      var signaturePad = new SignaturePad(canvas);\n      signaturePad.clear();\n    },\n    SAVE() {\n      var canvas = document.querySelector(\"canvas\");\n      var signature = canvas.toDataURL();\n      // var today = moment();\n\n      if (this.signer == \"dexon\") {\n        this.formData.sign_dacon_date = moment().toDate();\n        this.formData.sign_dacon_signed = 1;\n        this.formData.sign_dacon_img = signature;\n      } else {\n        this.formData.sign_client_date = moment().toDate();\n        this.formData.sign_client_signed = 1;\n        this.formData.sign_client_img = signature;\n      }\n\n      if (signature) {\n        this.$ons.notification.confirm(\"Confirm SAVE?\").then((res) => {\n          if (res == 1) {\n            axios({\n              method: \"put\",\n              url: \"/visit-record/visit-record-sign\",\n              headers: {\n                Authorization:\n                  \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n              },\n              data: this.formData,\n            })\n              .then((res) => {\n                if (res.status == 200) {\n                  console.log(res);\n                  if (this.signer == \"dexon\") {\n                    this.$ons.notification.alert(\"Dexon Signed\");\n                  } else {\n                    this.$ons.notification.alert(\"Client Signed\");\n                  }\n                  this.$emit(\"closePopup\");\n                  this.$emit(\"FETCH_INFO\");\n                }\n              })\n              .catch((error) => {\n                this.$ons.notification.alert(\n                  error.code + \" \" + error.response.status + \" \" + error.message\n                );\n              })\n              .finally(() => {});\n          }\n        });\n      }\n    },\n    CANCEL() {\n      this.$emit(\"closePopup\");\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/style/main.scss\";\n.section-text {\n  grid-column: span 2;\n}\n.signature-pad {\n  canvas {\n    border: 1px solid #000;\n  }\n\n  .signature-pad--body {\n    position: relative;\n    .signature-line {\n      width: 80%;\n      height: 1px;\n      position: absolute;\n      bottom: 60px;\n      left: 50%;\n      transform: translate(-50%);\n      border: 1px solid #000;\n      border-width: 0 0 1px 0;\n    }\n    .btn-clear {\n      position: absolute;\n      top: 5px;\n      right: 5px;\n      background-color: transparent;\n      padding: 4px 6px;\n      width: fit-content;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      border: 0px;\n      cursor: pointer;\n\n      i {\n        font-size: 18px;\n        color: $web-font-color-blue;\n      }\n\n      span {\n        font-size: 14px;\n        font-weight: 500;\n        color: $web-font-color-blue;\n        padding-left: 6px;\n      }\n    }\n  }\n}\n</style>"]},"metadata":{},"sourceType":"module"}