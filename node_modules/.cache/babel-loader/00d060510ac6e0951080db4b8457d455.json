{"ast":null,"code":"import \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.object.to-string.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//DataGrid\n// import { exportDataGrid } from \"devextreme/excel_exporter\";\nimport \"devextreme/dist/css/dx.light.css\";\nimport { DxDataGrid, // DxSearchPanel,\nDxPaging, // DxPager,\nDxScrolling, DxColumn // DxExport,\n} from \"devextreme-vue/data-grid\"; //Charts\n\nimport ChartCurrentSalesLine from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-line.vue\";\nimport ChartCurrentSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-pie.vue\";\nimport ChartCurrentSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-bar.vue\";\nimport ChartForecastSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-pie.vue\";\nimport ChartForecastSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-bar.vue\";\nimport ChartForecastSalesByMonthLine from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-bymonth-line.vue\";\nimport ChartProjectProgress from \"@/views/Applications/ExecutiveManagement/Charts/project-progress-line.vue\"; //Year Set\n\nimport YearSetCurrent from \"@/views/Applications/ExecutiveManagement/YearSet/current-sales.vue\";\nimport YearSetForecast from \"@/views/Applications/ExecutiveManagement/YearSet/forecast-sales.vue\"; //DataGrid\n//Structures\n\nimport contentLoading from \"@/components/app-structures/app-content-loading.vue\";\nimport ViewLayout from \"@/layouts/sidebar-layout.vue\";\nimport ViewLayoutNoneSidebar from \"@/layouts/non-sidebar-layout.vue\";\nimport UnderDevelopment from \"@/components/unavailable-feature.vue\"; //API\n\nimport axios from \"/axios.js\";\nimport moment from \"moment\";\nexport default {\n  name: \"ViewSummaryReport\",\n  components: {\n    // toolbar,\n    UnderDevelopment: UnderDevelopment,\n    contentLoading: contentLoading,\n    ChartCurrentSalesLine: ChartCurrentSalesLine,\n    ChartCurrentSalesPie: ChartCurrentSalesPie,\n    ChartCurrentSalesBar: ChartCurrentSalesBar,\n    YearSetCurrent: YearSetCurrent,\n    ChartForecastSalesPie: ChartForecastSalesPie,\n    ChartForecastSalesBar: ChartForecastSalesBar,\n    YearSetForecast: YearSetForecast,\n    ChartProjectProgress: ChartProjectProgress,\n    ChartForecastSalesByMonthLine: ChartForecastSalesByMonthLine,\n    //DataGrid\n    DxDataGrid: DxDataGrid,\n    // DxSearchPanel,\n    DxPaging: DxPaging,\n    // DxPager,\n    DxScrolling: DxScrolling,\n    DxColumn: DxColumn // DxExport,\n\n  },\n  created: function created() {\n    this.$store.commit(\"CLEAR_CURRENT_INAPP\");\n    this.$store.commit(\"UPDATE_CURRENT_INAPP\", {\n      name: \"Executive Summary Report\",\n      icon: \"/img/icon_menu/executive_management/summary.png\"\n    });\n    this.FETCH_INFO();\n    this.FETCH_DATA_PROJECT_FORECAST();\n    this.FETCH_DATA_PROJECT_PROGRESS(); // this.$emit(`update:layout`, ViewLayoutNoneSidebar);\n\n    var user_role = JSON.parse(localStorage.getItem(\"role\"));\n    console.log(user_role);\n\n    if (user_role == \"ceo\") {\n      this.$emit(\"update:layout\", ViewLayoutNoneSidebar);\n    } else {\n      this.$emit(\"update:layout\", ViewLayout);\n    }\n  },\n  data: function data() {\n    return {\n      isLoading: false,\n      info: {\n        weekly_report: {}\n      },\n      quarter: [{\n        no: \"Year 2023\"\n      }, {\n        no: \"Q1\"\n      }, {\n        no: \"Q2\"\n      }, {\n        no: \"Q3\"\n      }, {\n        no: \"Q4\"\n      }, {\n        no: \"Total\"\n      }],\n      forecast_project_list: [],\n      current_project_progress_list: [],\n      current_project_progress_chart: []\n    };\n  },\n  computed: {\n    weekly_start_date: function weekly_start_date() {\n      return moment(this.info.weekly_report.start_date).format(\"ddd-MMM-DD-YY\");\n    },\n    weekly_end_date: function weekly_end_date() {\n      return moment(this.info.weekly_report.end_date).format(\"ddd-MMM-DD-YY\");\n    },\n    current_date: function current_date() {\n      return moment().format(\"dddd, LL, hh:mm:ss a\");\n    },\n    current_year: function current_year() {\n      return moment().year();\n    },\n    report_message: function report_message() {\n      if (this.info.weekly_report.report_message) {\n        var htmlString = this.info.weekly_report.report_message;\n        return htmlString.replace(/\\\\/g, \"\");\n      } else return this.$store.state.inAppMessage.noData;\n    },\n    forecast_revenue_total: function forecast_revenue_total() {\n      var list = this.forecast_project_list;\n      var sum = 0;\n\n      for (var i = 0; i < list.length; i++) {\n        sum += list[i].project_value;\n      }\n\n      return (sum / 1000000).toFixed(2);\n    }\n  },\n  methods: {\n    FETCH_INFO: function FETCH_INFO() {\n      var _this = this;\n\n      axios({\n        method: \"get\",\n        url: \"weekly-report/get-last-weekly-report\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n        }\n      }).then(function (res) {\n        // console.log(res);\n        if (res.data) {\n          _this.info.weekly_report = res.data[0];\n        }\n      }).catch(function (error) {\n        _this.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n      }).finally(function () {});\n    },\n    FETCH_DATA_PROJECT_FORECAST: function FETCH_DATA_PROJECT_FORECAST() {\n      var _this2 = this;\n\n      axios({\n        method: \"get\",\n        url: \"/forecast-sales/forecast-sales-list\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n        }\n      }).then(function (res) {\n        // console.log(res);\n        if (res.data) {\n          _this2.forecast_project_list = res.data;\n        }\n      }).catch(function (error) {\n        _this2.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n      }).finally(function () {});\n    },\n    FETCH_DATA_PROJECT_PROGRESS: function FETCH_DATA_PROJECT_PROGRESS() {\n      var _this3 = this;\n\n      axios({\n        method: \"get\",\n        url: \"/current-sales/project-current-sales-progress\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n        }\n      }).then(function (res) {\n        // console.log(res);\n        if (res.data) {\n          _this3.current_project_progress_chart = res.data;\n        }\n      }).catch(function (error) {\n        _this3.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n      }).finally(function () {});\n    },\n    PROJECT_PROGRESS_PERCENT: function PROJECT_PROGRESS_PERCENT(cellInfo) {\n      return cellInfo.value.toFixed(2);\n    },\n    FORECAST_CONFIDENCE_LEVEL: function FORECAST_CONFIDENCE_LEVEL(cellInfo) {\n      return cellInfo.value.toFixed(0);\n    },\n    FORECAST_REVENUE: function FORECAST_REVENUE(cellInfo) {\n      return (cellInfo.value / 1000000).toFixed(2);\n    },\n    STATUS_PROJECT_CUMULATIVE: function STATUS_PROJECT_CUMULATIVE(e) {\n      if (e.rowType === \"data\" && e.column.dataField === \"status_cumulative\") {\n        e.cellElement.style.background = e.data.status_cumulative == \"On plan\" ? \"#ccffcc\" : e.data.status_cumulative == \"Over plan\" ? \"#66ff99\" : e.data.status_cumulative == \"Lower plan\" ? \"#ffff00\" : e.data.status_cumulative == \"Done\" ? \"#00cc00\" : \"\";\n      }\n    }\n  },\n  mounted: function mounted() {}\n};","map":{"version":3,"mappings":"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","names":["DxDataGrid","DxPaging","DxScrolling","DxColumn","name","components","UnderDevelopment","contentLoading","ChartCurrentSalesLine","ChartCurrentSalesPie","ChartCurrentSalesBar","YearSetCurrent","ChartForecastSalesPie","ChartForecastSalesBar","YearSetForecast","ChartProjectProgress","ChartForecastSalesByMonthLine","created","icon","console","data","isLoading","info","weekly_report","quarter","no","forecast_project_list","current_project_progress_list","current_project_progress_chart","computed","weekly_start_date","weekly_end_date","current_date","current_year","report_message","forecast_revenue_total","sum","methods","FETCH_INFO","axios","method","url","headers","Authorization","then","catch","error","finally","FETCH_DATA_PROJECT_FORECAST","FETCH_DATA_PROJECT_PROGRESS","PROJECT_PROGRESS_PERCENT","cellInfo","FORECAST_CONFIDENCE_LEVEL","FORECAST_REVENUE","STATUS_PROJECT_CUMULATIVE","e","mounted"],"sourceRoot":"src/views/Applications/ExecutiveManagement","sources":["SummaryReport.vue"],"sourcesContent":["<template>\n  <div class=\"pm-page\">\n    <div class=\"pm-page-container\">\n      <div class=\"page-header\">\n        <h1>\n          <span style=\"font-size: 32px\">E</span>xecutive\n          <span style=\"font-size: 32px\">R</span>eport of\n          <span style=\"font-size: 32px\">a</span>sset\n          <span style=\"font-size: 32px\">i</span>ntegrity\n          <span style=\"font-size: 32px\">s</span>ection\n        </h1>\n        <div>\n          <label>report period:</label>\n          <label> {{ weekly_start_date }} to {{ weekly_end_date }}</label>\n        </div>\n        <div>\n          <label>report by:</label>\n          <label>Mr. Chawanat Kongthanakana</label>\n        </div>\n        <!-- <div>\n          <label>position:</label>\n          <label>asset integrity section manager</label>\n        </div> -->\n      </div>\n      <div class=\"page-content\">\n        <div class=\"page-report\">\n          <!-- Weekly Report -->\n          <div class=\"report-item\">\n            <h2>The Executive Summary</h2>\n            <div class=\"report-item-card\">\n              <div class=\"report-message-display\" v-html=\"report_message\"></div>\n            </div>\n          </div>\n          <!-- Current Sales -->\n          <div class=\"report-item\">\n            <h2>The Current Revenue of {{ current_year }}</h2>\n            <div class=\"report-item-card\">\n              <YearSetCurrent />\n              <div class=\"chart-wrapper-grid\">\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartCurrentSalesLine />\n                  <!-- <div class=\"figure-label\">\n                    THE SUMMARY OF CURRENT REVENUE BY MONTHLY IN 2022\n                  </div> -->\n                </div>\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartCurrentSalesPie />\n                  <!-- <div class=\"figure-label\">THE TOTAL REVENUE IN 2022</div> -->\n                </div>\n                <div\n                  class=\"chart-wrapper\"\n                  style=\"grid-column: span 2; margin-bottom: 0px\"\n                >\n                  <ChartCurrentSalesBar />\n                  <!-- <div class=\"figure-label\">\n                    THE SUMMARY OF CURRENT REVENUE IN 2022\n                  </div> -->\n                </div>\n              </div>\n            </div>\n          </div>\n          <!-- Forecast Sales -->\n          <div class=\"report-item\">\n            <h2>The Forecast Revenue of {{ current_year + 1 }}</h2>\n            <div class=\"report-item-card\">\n              <YearSetForecast />\n              <div class=\"chart-wrapper-grid\">\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartForecastSalesBar />\n                  <!-- <div class=\"figure-label\">\n                    THE SUMMARY OF FORECAST REVENUE IN 2023\n                  </div> -->\n                </div>\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartForecastSalesByMonthLine />\n                  <!-- <div class=\"figure-label\">\n                    THE SUMMARY OF FORECAST REVENUE IN 2023\n                  </div> -->\n                </div>\n                <div class=\"chart-wrapper\" style=\"grid-column: span 2\">\n                  <ChartForecastSalesPie />\n                  <!-- <div class=\"figure-label\">\n                    THE TOTAL FORECAST OF REVENUE BY SERVICE TYPE IN 2023\n                  </div> -->\n                </div>\n              </div>\n              <div class=\"table-summary\">\n                <div class=\"panel-head\">\n                  The Forecast Revenue Summary of 2023\n                </div>\n                <DxDataGrid\n                  id=\"summary-forecast-revenue\"\n                  :data-source=\"forecast_project_list\"\n                  :selection=\"{ mode: 'single' }\"\n                  :hover-state-enabled=\"true\"\n                  :allow-column-reordering=\"true\"\n                  :show-borders=\"true\"\n                  :show-row-lines=\"false\"\n                  :row-alternation-enabled=\"true\"\n                >\n                  <DxPaging :page-size=\"100\" />\n                  <DxColumn\n                    data-field=\"\"\n                    :width=\"50\"\n                    alignment=\"center\"\n                    caption=\"No.\"\n                    cell-template=\"CELL_ROW_FORECAST\"\n                  />\n                  <DxColumn\n                    data-field=\"service_type_desc\"\n                    alignment=\"center\"\n                    caption=\"Service Type\"\n                    :width=\"100\"\n                    header-cell-template=\"service-header\"\n                  />\n                  <DxColumn\n                    data-field=\"project_name\"\n                    alignment=\"left\"\n                    caption=\"Project Name\"\n                  />\n                  <DxColumn\n                    data-field=\"client_name\"\n                    caption=\"Client Name\"\n                    :width=\"400\"\n                  />\n                  <DxColumn\n                    data-field=\"confident_level\"\n                    caption=\"Confidence Level (%)\"\n                    alignment=\"right\"\n                    :width=\"120\"\n                    :customize-text=\"FORECAST_CONFIDENCE_LEVEL\"\n                    header-cell-template=\"confidence-header\"\n                    css-class=\"confidence-padding\"\n                  />\n                  <DxColumn\n                    data-field=\"project_value\"\n                    caption=\"Forecast Revenue (MB)\"\n                    alignment=\"right\"\n                    :width=\"120\"\n                    :customize-text=\"FORECAST_REVENUE\"\n                    header-cell-template=\"forecast-header\"\n                    css-class=\"forecast-value-padding\"\n                  />\n                  <!-- Configuration goes here -->\n                  <!-- <DxFilterRow :visible=\"true\" /> -->\n                  <DxScrolling mode=\"standard\" />\n                  <template #service-header>\n                    <div>Service<br />Type</div>\n                  </template>\n                  <template #confidence-header>\n                    <div>Confident<br />Level(%)</div>\n                  </template>\n                  <template #forecast-header>\n                    <div>Forecast<br />Revenue(MB)</div>\n                  </template>\n                  <template #CELL_ROW_FORECAST=\"{ data }\">\n                    {{ data.rowIndex + 1 }}\n                  </template>\n                </DxDataGrid>\n                <div class=\"panel-summary\">\n                  <div class=\"label\">total forecast revenue (Million Baht)</div>\n                  <div class=\"total-count\">{{ forecast_revenue_total }}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <!-- Project Progress -->\n          <div class=\"report-item\">\n            <h2>the current project progress</h2>\n            <div class=\"report-item-card\">\n              <div class=\"table-summary\">\n                <div class=\"panel-head\">Project Progress Summary</div>\n                <DxDataGrid\n                  id=\"summary-forecast-revenue\"\n                  :data-source=\"current_project_progress_chart\"\n                  :selection=\"{ mode: 'single' }\"\n                  :hover-state-enabled=\"true\"\n                  :allow-column-reordering=\"true\"\n                  :show-borders=\"true\"\n                  :show-row-lines=\"false\"\n                  :row-alternation-enabled=\"true\"\n                  @cell-prepared=\"STATUS_PROJECT_CUMULATIVE\"\n                >\n                  <DxPaging :page-size=\"100\" />\n                  <DxColumn\n                    data-field=\"\"\n                    :width=\"50\"\n                    alignment=\"center\"\n                    caption=\"No.\"\n                    cell-template=\"CELL_ROW_CURRENT\"\n                  />\n                  <DxColumn\n                    data-field=\"project_no\"\n                    alignment=\"center\"\n                    caption=\"Project No.\"\n                    :width=\"120\"\n                    sort-order=\"asc\"\n                  />\n                  <DxColumn\n                    data-field=\"project_name\"\n                    alignment=\"left\"\n                    caption=\"Project Name\"\n                  />\n                  <DxColumn\n                    data-field=\"service_type\"\n                    alignment=\"center\"\n                    caption=\"Service Type\"\n                    :width=\"100\"\n                    header-cell-template=\"service-header\"\n                  />\n                  <DxColumn\n                    data-field=\"client_name\"\n                    :width=\"400\"\n                    caption=\"Client Name\"\n                  />\n                  <DxColumn\n                    data-field=\"actual_cumulative\"\n                    caption=\"Progress (%)\"\n                    :width=\"120\"\n                    alignment=\"right\"\n                    :customize-text=\"PROJECT_PROGRESS_PERCENT\"\n                    header-cell-template=\"progress-header\"\n                    css-class=\"progress-padding\"\n                  />\n                  <DxColumn\n                    data-field=\"status_cumulative\"\n                    caption=\"Progress Status\"\n                    :width=\"120\"\n                    alignment=\"center\"\n                    header-cell-template=\"progress-status-header\"\n                  />\n\n                  <!-- Configuration goes here -->\n                  <!-- <DxFilterRow :visible=\"true\" /> -->\n                  <DxScrolling mode=\"standard\" />\n                  <template #service-header>\n                    <div>Service<br />Type</div>\n                  </template>\n                  <template #progress-header>\n                    <div>Progress<br />(%)</div>\n                  </template>\n                  <template #progress-status-header>\n                    <div>Progress<br />Status</div>\n                  </template>\n                  <template #CELL_ROW_CURRENT=\"{ data }\">\n                    {{ data.rowIndex + 1 }}\n                  </template>\n                </DxDataGrid>\n              </div>\n              <div class=\"chart-wrpper-grid\">\n                <div class=\"chart-wrapper\">\n                  <div\n                    v-for=\"(item, index) in current_project_progress_chart\"\n                    :key=\"item.id_project\"\n                  >\n                    <ChartProjectProgress\n                      :info=\"current_project_progress_chart[index]\"\n                      v-if=\"item.status_cumulative != 'Done'\"\n                    />\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"report-item\">\n            <h2>the sales and marketing</h2>\n            <div class=\"report-item-card\">\n              <UnderDevelopment />\n            </div>\n          </div>\n          <label class=\"update-label\"\n            >Information Updated on: {{ current_date }}</label\n          >\n        </div>\n      </div>\n    </div>\n\n    <contentLoading\n      text=\"Loading, please wait...\"\n      v-if=\"isLoading == true\"\n      color=\"#fc9b21\"\n    />\n  </div>\n</template> \n\n<script>\n//DataGrid\n// import { exportDataGrid } from \"devextreme/excel_exporter\";\nimport \"devextreme/dist/css/dx.light.css\";\nimport {\n  DxDataGrid,\n  // DxSearchPanel,\n  DxPaging,\n  // DxPager,\n  DxScrolling,\n  DxColumn,\n  // DxExport,\n} from \"devextreme-vue/data-grid\";\n\n//Charts\nimport ChartCurrentSalesLine from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-line.vue\";\nimport ChartCurrentSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-pie.vue\";\nimport ChartCurrentSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/current-sales-bar.vue\";\n\nimport ChartForecastSalesPie from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-pie.vue\";\nimport ChartForecastSalesBar from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-bar.vue\";\nimport ChartForecastSalesByMonthLine from \"@/views/Applications/ExecutiveManagement/Charts/forecast-sales-bymonth-line.vue\";\n\nimport ChartProjectProgress from \"@/views/Applications/ExecutiveManagement/Charts/project-progress-line.vue\";\n\n//Year Set\nimport YearSetCurrent from \"@/views/Applications/ExecutiveManagement/YearSet/current-sales.vue\";\nimport YearSetForecast from \"@/views/Applications/ExecutiveManagement/YearSet/forecast-sales.vue\";\n\n//DataGrid\n\n//Structures\nimport contentLoading from \"@/components/app-structures/app-content-loading.vue\";\nimport ViewLayout from \"@/layouts/sidebar-layout.vue\";\nimport ViewLayoutNoneSidebar from \"@/layouts/non-sidebar-layout.vue\";\nimport UnderDevelopment from \"@/components/unavailable-feature.vue\";\n\n//API\nimport axios from \"/axios.js\";\nimport moment from \"moment\";\n\nexport default {\n  name: \"ViewSummaryReport\",\n  components: {\n    // toolbar,\n    UnderDevelopment,\n    contentLoading,\n    ChartCurrentSalesLine,\n    ChartCurrentSalesPie,\n    ChartCurrentSalesBar,\n    YearSetCurrent,\n    ChartForecastSalesPie,\n    ChartForecastSalesBar,\n    YearSetForecast,\n    ChartProjectProgress,\n    ChartForecastSalesByMonthLine,\n    //DataGrid\n    DxDataGrid,\n    // DxSearchPanel,\n    DxPaging,\n    // DxPager,\n    DxScrolling,\n    DxColumn,\n    // DxExport,\n  },\n  created() {\n    this.$store.commit(\"CLEAR_CURRENT_INAPP\");\n    this.$store.commit(\"UPDATE_CURRENT_INAPP\", {\n      name: \"Executive Summary Report\",\n      icon: \"/img/icon_menu/executive_management/summary.png\",\n    });\n    this.FETCH_INFO();\n    this.FETCH_DATA_PROJECT_FORECAST();\n    this.FETCH_DATA_PROJECT_PROGRESS();\n    // this.$emit(`update:layout`, ViewLayoutNoneSidebar);\n    var user_role = JSON.parse(localStorage.getItem(\"role\"));\n    console.log(user_role);\n    if (user_role == \"ceo\") {\n      this.$emit(`update:layout`, ViewLayoutNoneSidebar);\n    } else {\n      this.$emit(`update:layout`, ViewLayout);\n    }\n  },\n  data() {\n    return {\n      isLoading: false,\n      info: {\n        weekly_report: {},\n      },\n      quarter: [\n        {\n          no: \"Year 2023\",\n        },\n        {\n          no: \"Q1\",\n        },\n        {\n          no: \"Q2\",\n        },\n        {\n          no: \"Q3\",\n        },\n        {\n          no: \"Q4\",\n        },\n        {\n          no: \"Total\",\n        },\n      ],\n      forecast_project_list: [],\n      current_project_progress_list: [],\n      current_project_progress_chart: [],\n    };\n  },\n  computed: {\n    weekly_start_date() {\n      return moment(this.info.weekly_report.start_date).format(\"ddd-MMM-DD-YY\");\n    },\n    weekly_end_date() {\n      return moment(this.info.weekly_report.end_date).format(\"ddd-MMM-DD-YY\");\n    },\n    current_date() {\n      return moment().format(\"dddd, LL, hh:mm:ss a\");\n    },\n    current_year() {\n      return moment().year();\n    },\n    report_message() {\n      if (this.info.weekly_report.report_message) {\n        var htmlString = this.info.weekly_report.report_message;\n        return htmlString.replace(/\\\\/g, \"\");\n      } else return this.$store.state.inAppMessage.noData;\n    },\n    forecast_revenue_total() {\n      var list = this.forecast_project_list;\n      var sum = 0;\n      for (var i = 0; i < list.length; i++) {\n        sum += list[i].project_value;\n      }\n      return (sum / 1000000).toFixed(2);\n    },\n  },\n\n  methods: {\n    FETCH_INFO() {\n      axios({\n        method: \"get\",\n        url: \"weekly-report/get-last-weekly-report\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n        },\n      })\n        .then((res) => {\n          // console.log(res);\n          if (res.data) {\n            this.info.weekly_report = res.data[0];\n          }\n        })\n        .catch((error) => {\n          this.$ons.notification.alert(\n            error.code + \" \" + error.response.status + \" \" + error.message\n          );\n        })\n        .finally(() => {});\n    },\n    FETCH_DATA_PROJECT_FORECAST() {\n      axios({\n        method: \"get\",\n        url: \"/forecast-sales/forecast-sales-list\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n        },\n      })\n        .then((res) => {\n          // console.log(res);\n          if (res.data) {\n            this.forecast_project_list = res.data;\n          }\n        })\n        .catch((error) => {\n          this.$ons.notification.alert(\n            error.code + \" \" + error.response.status + \" \" + error.message\n          );\n        })\n        .finally(() => {});\n    },\n    FETCH_DATA_PROJECT_PROGRESS() {\n      axios({\n        method: \"get\",\n        url: \"/current-sales/project-current-sales-progress\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n        },\n      })\n        .then((res) => {\n          // console.log(res);\n          if (res.data) {\n            this.current_project_progress_chart = res.data;\n          }\n        })\n        .catch((error) => {\n          this.$ons.notification.alert(\n            error.code + \" \" + error.response.status + \" \" + error.message\n          );\n        })\n        .finally(() => {});\n    },\n    PROJECT_PROGRESS_PERCENT(cellInfo) {\n      return cellInfo.value.toFixed(2);\n    },\n    FORECAST_CONFIDENCE_LEVEL(cellInfo) {\n      return cellInfo.value.toFixed(0);\n    },\n    FORECAST_REVENUE(cellInfo) {\n      return (cellInfo.value / 1000000).toFixed(2);\n    },\n    STATUS_PROJECT_CUMULATIVE(e) {\n      if (e.rowType === \"data\" && e.column.dataField === \"status_cumulative\") {\n        e.cellElement.style.background =\n          e.data.status_cumulative == \"On plan\"\n            ? \"#ccffcc\"\n            : e.data.status_cumulative == \"Over plan\"\n            ? \"#66ff99\"\n            : e.data.status_cumulative == \"Lower plan\"\n            ? \"#ffff00\"\n            : e.data.status_cumulative == \"Done\"\n            ? \"#00cc00\"\n            : \"\";\n      }\n    },\n  },\n  mounted() {},\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/style/main.scss\";\n* {\n  font-family: \"Play\", \"Noto Sans Thai\" !important;\n}\n.pm-page {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  height: 100%;\n  // background-color: rgb(202, 202, 202);\n  .pm-page-container {\n    .page-header {\n      height: 220px;\n      display: flex;\n      justify-content: center;\n      align-items: flex-start;\n      flex-direction: column;\n      background-image: url(\"/public/img/main-bg.png\");\n      background-size: cover;\n      background-position: center;\n      background-repeat: no-repeat;\n      position: relative;\n      padding: 0 20px;\n      h1,\n      div {\n        margin: 0;\n        text-align: left;\n        color: #fff;\n        font-style: normal;\n        width: -webkit-fill-available;\n        font-family: \"Play\", \"Noto Sans Thai\" !important;\n        width: 1280px;\n        max-width: 1600px;\n\n        @media screen and (max-width: 1600px) {\n          width: 100%;\n        }\n      }\n      h1,\n      div {\n        margin: 0 auto;\n      }\n      h1 {\n        font-size: 26px;\n        font-weight: 600;\n        text-transform: uppercase;\n        margin-bottom: 10px;\n      }\n      div {\n        margin-bottom: 6px;\n        display: grid;\n        grid-template-columns: 150px auto;\n        label {\n          font-size: 16px;\n          text-align: left;\n          font-weight: 300;\n          font-family: \"Play\", \"Noto Sans Thai\" !important;\n          text-transform: uppercase;\n        }\n      }\n    }\n    .page-content {\n      height: fit-content;\n      display: flex;\n      justify-content: center;\n      align-content: center;\n      .page-report {\n        width: 1280px;\n        // background-color: #fff;\n        margin: 0 auto;\n\n        @media screen and (max-width: 1920px) {\n          width: 1280px;\n        }\n        @media screen and (max-width: 1600px) {\n          width: calc(100% - 40px);\n          padding: 0 20px;\n        }\n\n        .report-detail {\n          display: flex;\n          justify-content: center;\n          align-items: flex-start;\n          flex-direction: column;\n          label {\n            font-size: 14px;\n          }\n        }\n        .report-item {\n          margin-top: 40px;\n          h2 {\n            margin: 0;\n            font-size: 20px;\n            font-style: normal;\n            text-transform: uppercase;\n            font-family: \"Play\", \"Noto Sans Thai\" !important;\n          }\n          .report-item-card {\n            background-color: #fff;\n            padding: 10px 20px 20px 20px;\n            margin-top: 20px;\n            margin-bottom: 60px;\n            box-shadow: 0 4px 12px -2px rgb(107 117 161 / 16%);\n            border-radius: 6px;\n            min-height: 200px;\n            height: fit-content;\n          }\n        }\n      }\n    }\n  }\n}\n\n.update-label {\n  font-size: 12px;\n  color: $web-font-color-grey;\n  padding-bottom: 60px;\n}\n\n.report-message-display {\n  min-height: 200px;\n  font-size: 16px;\n  font-family: \"Calibri\";\n  // background-color: #f7f7f7;\n  padding: 0 10px;\n  // border: 1px solid #e8e8e8;\n  border-radius: 3px;\n  div {\n    width: 100%;\n    img {\n      max-width: 100%;\n      width: 100%;\n    }\n  }\n}\n\n.chart-wrapper-grid {\n  border: 0px;\n}\n</style>"]},"metadata":{},"sourceType":"module"}