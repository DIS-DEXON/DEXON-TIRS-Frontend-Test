{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.array.slice.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"/axios.js\"; // import clone from \"just-clone\";\n\nimport DxDateBox from \"devextreme-vue/date-box\";\nimport moment from \"moment\";\nexport default {\n  name: \"popup-add-travel\",\n  components: {\n    DxDateBox: DxDateBox\n  },\n  data: function data() {\n    return {\n      formData: {\n        id_user: \"\",\n        record_no: \"\",\n        bill_date: \"\",\n        price: \"\",\n        doc_seq: \"\",\n        file: \"\"\n      },\n      formSelect: {\n        now: new Date()\n      }\n    };\n  },\n  created: function created() {\n    var id = JSON.parse(localStorage.getItem(\"user\"));\n    this.formData.id_user = id.id_user;\n    this.GET_LAST_SEQ_NO();\n  },\n  methods: {\n    GET_LAST_SEQ_NO: function GET_LAST_SEQ_NO() {\n      var _this = this;\n\n      var tbname = \"TravelRecord\";\n      axios({\n        method: \"post\",\n        url: \"/global/last-doc-seq\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n        },\n        data: {\n          table_name: tbname\n        }\n      }).then(function (res) {\n        if (res.status == 200 && res.data) {\n          var curSeq = res.data[0].last_doc_seq;\n\n          if (curSeq == null) {\n            _this.formData.doc_seq = 1;\n          } else {\n            _this.formData.doc_seq = curSeq + 1;\n          }\n\n          if (_this.formData.doc_seq < 10) {\n            _this.formData.doc_seq = \"0\" + _this.formData.doc_seq.toString();\n          }\n\n          _this.CAL_DOC_NO();\n        }\n      }).catch(function (error) {\n        console.log(error);\n      }).finally(function () {});\n    },\n    CAL_DOC_NO: function CAL_DOC_NO() {\n      var month = moment().month() + 1;\n      var year = moment().year();\n      var monthyear;\n      var s_month = month.toString();\n      var s_year = year.toString();\n\n      if (s_month.length == 1) {\n        s_month = \"0\" + s_month;\n      }\n\n      s_year = s_year.slice(2, 4);\n      monthyear = s_month.toString() + \"-\" + s_year.toString();\n      this.formData.record_no = \"AI-TRR-\" + monthyear + \"-\" + this.formData.doc_seq.toString();\n    },\n    SAVE: function SAVE() {\n      var _this2 = this;\n\n      if (this.formData.bill_date) {\n        if (this.formData.price) {\n          this.$ons.notification.confirm(\"Confirm save?\").then(function (res) {\n            if (res == 1) {\n              var data = _this2.formData;\n              axios({\n                method: \"post\",\n                url: \"/fuel-bill/fuel-bill-add\",\n                headers: {\n                  \"Content-Type\": \"multipart/form-data\",\n                  Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\"))\n                },\n                data: data\n              }).then(function (res) {\n                if (res.status == 200) {\n                  _this2.$ons.notification.alert(\"Bill Record Add successful\");\n\n                  _this2.$emit(\"btn-cancel-add\");\n\n                  _this2.$emit(\"refreshList\");\n                }\n              }).catch(function (error) {\n                _this2.$ons.notification.alert(error.code + \" \" + error.response.status + \" \" + error.message);\n              }).finally(function () {});\n            }\n          });\n        } else {\n          this.$ons.notification.alert('\"Price\" field cannot be empty');\n        }\n      } else {\n        this.$ons.notification.alert('\"Bill Date\" field cannot be empty');\n      }\n    },\n    CANCEL: function CANCEL() {\n      var _this3 = this;\n\n      // console.log(this.formData);\n      var form = this.formData; // console.log(form);\n\n      if (this.formData != form) {\n        this.$ons.notification.confirm(\"Your unsaved changes will be lost\").then(function (res) {\n          if (res == 1) {\n            _this3.$emit(\"btn-cancel-add\");\n          }\n        });\n      } else {\n        this.$emit(\"btn-cancel-add\");\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA,8B,CACA;;AACA;AACA;AACA;AACAA,0BADA;AAEAC;AAAAC;AAAA,GAFA;AAGAC,MAHA,kBAGA;AACA;AACAC;AACAC,mBADA;AAEAC,qBAFA;AAGAC,qBAHA;AAIAC,iBAJA;AAKAC,mBALA;AAMAC;AANA,OADA;AASAC;AACAC;AADA;AATA;AAaA,GAjBA;AAkBAC,SAlBA,qBAkBA;AACA;AACA;AACA;AACA,GAtBA;AAuBAC;AACAC,mBADA,6BACA;AAAA;;AACA;AACAC;AACAC,sBADA;AAEAC,mCAFA;AAGAC;AACAC;AADA,SAHA;AAMAjB;AACAkB;AADA;AANA,SAUAC,IAVA,CAUA;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA,OAvBA,EAwBAC,KAxBA,CAwBA;AACAC;AACA,OA1BA,EA2BAC,OA3BA,CA2BA,cA3BA;AA4BA,KA/BA;AAgCAC,cAhCA,wBAgCA;AACA;AACA;AACA;AAEA;AACA;;AAEA;AACAC;AACA;;AACAC;AAEAC;AACA,gCACA,8DADA;AAEA,KAhDA;AAiDAC,QAjDA,kBAiDA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACAd;AACAC,8BADA;AAEAC,+CAFA;AAGAC;AACA,uDADA;AAEAC,iCACA;AAHA,iBAHA;AAQAjB;AARA,iBAUAmB,IAVA,CAUA;AACA;AACA;;AACA;;AACA;AACA;AACA,eAhBA,EAiBAC,KAjBA,CAiBA;AACA,+CACAQ,aACA,GADA,GAEAA,qBAFA,GAGA,GAHA,GAIAA,aALA;AAOA,eAzBA,EA0BAN,OA1BA,CA0BA,cA1BA;AA2BA;AACA,WA/BA;AAgCA,SAjCA,MAiCA;AACA;AACA;AACA,OArCA,MAqCA;AACA;AACA;AACA,KA1FA;AA2FAO,UA3FA,oBA2FA;AAAA;;AACA;AACA,+BAFA,CAGA;;AACA;AACA,+BACAC,OADA,CACA,mCADA,EAEAX,IAFA,CAEA;AACA;AACA;AACA;AACA,SANA;AAOA,OARA,MAQA;AACA;AACA;AACA;AA1GA;AAvBA","names":["name","components","DxDateBox","data","formData","id_user","record_no","bill_date","price","doc_seq","file","formSelect","now","created","methods","GET_LAST_SEQ_NO","axios","method","url","headers","Authorization","table_name","then","catch","console","finally","CAL_DOC_NO","s_month","s_year","monthyear","SAVE","error","CANCEL","confirm"],"sourceRoot":"src/views/Applications/Record/Travel","sources":["travel-add.vue"],"sourcesContent":["<template>\n  <div class=\"popup-wrapper\">\n    <div class=\"popup-card\">\n      <div class=\"popup-header\">\n        <label>Add New Record</label>\n        <span style=\"font-size: 14px; padding-right: 20px\"\n          >{{ formData.record_no }}\n        </span>\n      </div>\n      <div class=\"popup-content form\">\n        <div class=\"form-item-container\">\n          <div class=\"input-set\">\n            <div class=\"label-box\">\n              <p class=\"label\">Create Record for(Date):</p>\n              <span class=\"star-label\"><i class=\"las la-asterisk\"></i></span>\n            </div>\n            <DxDateBox\n              :value=\"formSelect.now\"\n              type=\"date\"\n              v-model=\"formData.bill_date\"\n              placeholder=\"Select Date\"\n            />\n          </div>\n          <div class=\"input-set\" style=\"margin-top: 10px\">\n            <div class=\"label-box\">\n              <p class=\"label\">Notes:</p>\n              <!-- <span class=\"star-label\"><i class=\"las la-asterisk\"></i></span> -->\n            </div>\n            <textarea\n              v-model=\"formData.note\"\n              placeholder=\"Note\"\n              style=\"height: 80px; max-height: 200px\"\n            />\n          </div>\n        </div>\n      </div>\n      <div class=\"popup-footer\">\n        <div class=\"button-set\">\n          <button class=\"blue\" v-on:click=\"SAVE()\">\n            <label>Save</label>\n          </button>\n          <button class=\"grey\" v-on:click=\"CANCEL()\">\n            <label>Cancel</label>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"/axios.js\";\n// import clone from \"just-clone\";\nimport DxDateBox from \"devextreme-vue/date-box\";\nimport moment from \"moment\";\nexport default {\n  name: \"popup-add-travel\",\n  components: { DxDateBox },\n  data() {\n    return {\n      formData: {\n        id_user: \"\",\n        record_no: \"\",\n        bill_date: \"\",\n        price: \"\",\n        doc_seq: \"\",\n        file: \"\",\n      },\n      formSelect: {\n        now: new Date(),\n      },\n    };\n  },\n  created() {\n    let id = JSON.parse(localStorage.getItem(\"user\"));\n    this.formData.id_user = id.id_user;\n    this.GET_LAST_SEQ_NO();\n  },\n  methods: {\n    GET_LAST_SEQ_NO() {\n      let tbname = \"TravelRecord\";\n      axios({\n        method: \"post\",\n        url: \"/global/last-doc-seq\",\n        headers: {\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n        },\n        data: {\n          table_name: tbname,\n        },\n      })\n        .then((res) => {\n          if (res.status == 200 && res.data) {\n            var curSeq = res.data[0].last_doc_seq;\n            if (curSeq == null) {\n              this.formData.doc_seq = 1;\n            } else {\n              this.formData.doc_seq = curSeq + 1;\n            }\n            if (this.formData.doc_seq < 10) {\n              this.formData.doc_seq = \"0\" + this.formData.doc_seq.toString();\n            }\n            this.CAL_DOC_NO();\n          }\n        })\n        .catch((error) => {\n          console.log(error);\n        })\n        .finally(() => {});\n    },\n    CAL_DOC_NO() {\n      var month = moment().month() + 1;\n      var year = moment().year();\n      var monthyear;\n\n      var s_month = month.toString();\n      var s_year = year.toString();\n\n      if (s_month.length == 1) {\n        s_month = \"0\" + s_month;\n      }\n      s_year = s_year.slice(2, 4);\n\n      monthyear = s_month.toString() + \"-\" + s_year.toString();\n      this.formData.record_no =\n        \"AI-TRR-\" + monthyear + \"-\" + this.formData.doc_seq.toString();\n    },\n    SAVE() {\n      if (this.formData.bill_date) {\n        if (this.formData.price) {\n          this.$ons.notification.confirm(\"Confirm save?\").then((res) => {\n            if (res == 1) {\n              const data = this.formData;\n              axios({\n                method: \"post\",\n                url: \"/fuel-bill/fuel-bill-add\",\n                headers: {\n                  \"Content-Type\": \"multipart/form-data\",\n                  Authorization:\n                    \"Bearer \" + JSON.parse(localStorage.getItem(\"token\")),\n                },\n                data: data,\n              })\n                .then((res) => {\n                  if (res.status == 200) {\n                    this.$ons.notification.alert(\"Bill Record Add successful\");\n                    this.$emit(\"btn-cancel-add\");\n                    this.$emit(\"refreshList\");\n                  }\n                })\n                .catch((error) => {\n                  this.$ons.notification.alert(\n                    error.code +\n                      \" \" +\n                      error.response.status +\n                      \" \" +\n                      error.message\n                  );\n                })\n                .finally(() => {});\n            }\n          });\n        } else {\n          this.$ons.notification.alert('\"Price\" field cannot be empty');\n        }\n      } else {\n        this.$ons.notification.alert('\"Bill Date\" field cannot be empty');\n      }\n    },\n    CANCEL() {\n      // console.log(this.formData);\n      let form = this.formData;\n      // console.log(form);\n      if (this.formData != form) {\n        this.$ons.notification\n          .confirm(\"Your unsaved changes will be lost\")\n          .then((res) => {\n            if (res == 1) {\n              this.$emit(\"btn-cancel-add\");\n            }\n          });\n      } else {\n        this.$emit(\"btn-cancel-add\");\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/style/main.scss\";\n.popup-content {\n  // display: grid;\n  // grid-template-columns: 300px;\n  // grid-gap: 20px;\n  display: block;\n}\n.form-item-container {\n  width: auto;\n  display: block;\n  // grid-gap: 10px;\n}\n\np.info {\n  margin-bottom: 0 !important;\n}\n</style>"]},"metadata":{},"sourceType":"module"}